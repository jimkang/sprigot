!function e(t,n,r){function s(o,i){if(!n[o]){if(!t[o]){var l="function"==typeof require&&require;if(!i&&l)return l(o,!0);if(a)return a(o,!0);var u=new Error("Cannot find module '"+o+"'");throw u.code="MODULE_NOT_FOUND",u}var c=n[o]={exports:{}};t[o][0].call(c.exports,function(e){var n=t[o][1][e];return s(n?n:e)},c,c.exports,e,t,n,r)}return n[o].exports}for(var a="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(e,t,n){function createAPIEnvoy(e){var t={serverURL:e,queuesForIntervals:{}};return t.request=function request(e,t){var n=new XMLHttpRequest;n.open("POST",this.serverURL),n.setRequestHeader("Content-Type","application/json"),n.setRequestHeader("accept","application/json"),n.onload=function gotSprig(){if(200===this.status){var e=JSON.parse(this.responseText);t(null,e)}else t(this.status,null)},n.send(JSON.stringify(e))},t.addRequestToQueue=function queueForBatchedRequest(e,t,n){var r=queuesForIntervals.toString(),a=null;r in this.queuesForIntervals?a=this.queuesForIntervals[r]:(a=[],this.queuesForIntervals[r]=a),a.push({jsonBody:t,done:n})},t}t.exports=createAPIEnvoy},{}],2:[function(e,t,n){function createCamera(e){var t={locked:!1,rootSelection:null,boardSelection:null,zoomBehavior:null,parsedPreLockTransform:null,scaleExtent:e,setUpZoomOnBoard:function(e,n){var a=this.getActualWidth(e.node()),o=this.getActualHeight(e.node()),i=r.scale.linear().domain([0,a]).range([0,a]),s=r.scale.linear().domain([0,o]).range([o,0]);t.zoomBehavior=r.behavior.zoom().x(i).y(s).scaleExtent(this.scaleExtent).on("zoom",t.syncZoomEventToTransform),t.boardSelection=e,t.boardSelection.call(t.zoomBehavior),t.rootSelection=n},syncZoomEventToTransform:function(){t.locked||t.rootSelection.attr("transform","translate("+r.event.translate+") scale("+r.event.scale+")")},resetZoom:function(){t.locked||rootSelection.attr("transform","translate(0, 0) scale(1)")},lockZoomToDefault:function(){t.resetZoom(),t.locked=!0},lockZoom:function(){t.locked=!0},unlockZoom:function(){t.locked=!1,t.parsedPreLockTransform&&(t.tweenToNewZoom(t.parsedPreLockTransform.scale,t.parsedPreLockTransform.translate,300),t.parsedPreLockTransform=null)},lockZoomToDefaultCenterPanAtDataCoords:function(e){t.parsedPreLockTransform=t.parseScaleAndTranslateFromTransformString(t.rootSelection.attr("transform")),t.panToCenterOnRect(e),t.lockZoom()},panToCenterOnRect:function(e,n,r){n||(n=300);var a=this.getActualWidth(this.boardSelection.node()),o=this.getActualHeight(this.boardSelection.node()),i=1,s=t.rootSelection.attr("transform");if(s){var l=t.parseScaleAndTranslateFromTransformString(s);i=l.scale}t.tweenToNewZoom(i,[-e.x-e.width/2+a/2,-e.y-e.height/2+o/2],n,r)},tweenToNewZoom:function(e,n,a,o){var i=t.rootSelection.attr("transform"),s=r.transition().duration(a).tween("zoom",function(){var a=1,o=[0,0];if(i){var s=t.parseScaleAndTranslateFromTransformString(i);a=s.scale,o=s.translate}var l=r.interpolate(a,e);return interpolateTranslation=r.interpolate(o,n),function(e){var n=l(e);t.zoomBehavior.scale(n);var r=interpolateTranslation(e);t.zoomBehavior.translate(r),t.rootSelection.attr("transform","translate("+r[0]+", "+r[1]+") scale("+n+")")}});o&&s.each("end",o)},parseScaleAndTranslateFromTransformString:function(e){var t={scale:1,translate:[0,0]};if(e&&e.length>0){var n=e.split("scale(")[1];n&&(t.scale=parseFloat(n.substr(0,n.length-1)));var r=e.split(") ")[0].split(",");t.translate=[parseFloat(r[0].substr(10)),parseFloat(r[1])],t.translate[1]||console.log("Got NaN out of",r)}return t},getActualHeight:function getActualHeight(e){var t=e.clientHeight;return 1>t&&(t=e.parentNode.clientHeight),t},getActualWidth:function getActualWidth(e){var t=e.clientWidth;return 1>t&&(t=e.parentNode.clientWidth),t},translateYFromSel:function translateYFromSel(e){return e.attr("transform").split(",")[1].split(".")[0]},translateXFromSel:function translateXFromSel(e){return e.attr("transform").split(",")[0].split(".")[0].split("(")[1]},panToElement:function panToElement(e,n){var r=t.zoomBehavior.scale(),a=parseInt(t.translateYFromSel(e))*r,o=parseInt(t.translateXFromSel(e))*r;t.panToCenterOnRect({x:o,y:a,width:1,height:1},750,n)}};return t}var r=e("./lib/d3-small");t.exports=createCamera},{"./lib/d3-small":14}],3:[function(e,t,n){function createCollisionFinder(e){var t={svgEl:e,hitRectSVG:e.createSVGRect(),hitPointSVG:e.createSVGPoint()};return t.hitRectSVG.width=100,t.hitRectSVG.height=100,t.elementsAtPoint=function elementsAtPoint(e){return this.hitRectSVG.x=e[0],this.hitRectSVG.y=e[1],this.svgEl.getIntersectionList(this.hitRectSVG,null)},t.elementsHittingEl=function elementsHittingEl(e){var t=e.getCTM(),n=e.getBBox(),r=this.svgEl.createSVGPoint();this.hitPointSVG.x=n.x,this.hitPointSVG.y=n.y,r.x=n.x+n.width,r.y=n.y+n.height;var a=this.hitPointSVG.matrixTransform(t);n.x=a.x,n.y=a.y;var o=r.matrixTransform(t);return n.width=o.x-a.x,n.height=o.y-a.y,this.svgEl.getIntersectionList(n,null)},t}t.exports=createCollisionFinder},{}],4:[function(e,t,n){function createControlRenderer(e){function createElement(e){return document.createElement(e.elementType)}function render(e){var r=t.selectAll(n).data(e,a());r.enter().append(n).append(createElement).classed(i,!0).attr("id",l).on("click",respondToClick).on("blur",respondToFocusLoss),r.exit().classed("fade-out",!0).transition().delay(300).remove();var o=r.selectAll(n+" > *");o.each(updateAttributes),o.text(s)}function updateAttributes(e){if(e.attributes){var t=r.select(this);for(var n in e.attributes)t.attr(n,e.attributes[n])}}function respondToClick(e){e.onClick&&e.onClick()}function respondToFocusLoss(e){e.onFocusLoss&&e.onFocusLoss()}var t,n,i;if(e&&(t=e.root,n=e.baseElementType,i=e.baseClass),!t)throw new Error("No root passed to renderAdminPanel.");n||(n="div"),i||(i="generic-control");var s=a("text"),l=a();return o(render)}{var r=e("./lib/d3-small"),a=e("accessor"),o=e("export-methods");e("lodash")}t.exports=createControlRenderer},{"./lib/d3-small":14,accessor:17,"export-methods":18,lodash:20}],5:[function(e,t,n){var r=e("lodash");D3SprigBridge={validSprigPropertyList:["id","doc","title","body","emphasize","created","modified","tags","formats"]},D3SprigBridge.serializeTreedNode=function serializeTreedNode(e){var t=r.pick(e,this.validSprigPropertyList),n=e.children;return e.children||(n=e._children),n&&(t.children=r.pluck(n,"id")),t},D3SprigBridge.sanitizeTreeForD3=function sanitizeTreeForD3(e){if("object"==typeof e.children){for(var t=[],n=[],r=0;r<e.children.length;++r){var a=e.children[r];"object"==typeof a?n.push(a):t.push(a)}t.length>0&&(delete e.children,e.childRefs=t),n.length>0&&(e.children=n,e.children.forEach(sanitizeTreeForD3))}return e},D3SprigBridge.mapPathToSprigId=function mapPathToSprigId(e,t,n){function matchesTarget(t){return t.id===e}return this.mapPathInD3Tree(matchesTarget,t,n)},D3SprigBridge.mapPathInD3Tree=function mapPathInD3Tree(e,t,n){if(e(t))return[t];for(var r=[],a={},o=null,i=0,s=null,l=[t];n>=i;){s=[];for(var u=0;u<l.length;++u){var c=l[u];if(e(c)){o=c;break}if(n>=i+1&&c){var d=[];"object"==typeof c.children&&c.children?d=c.children:"object"==typeof c._children&&c._children&&(d=c._children),d.forEach(function mapParent(e){a[e.id]=c}),s=s.concat(d)}}if(o)break;i++,l=s}if(o)for(var c=o;c;)r.unshift(c),c=c.id in a?a[c.id]:null;return r},D3SprigBridge.flattenTreeBreadthFirst=function flattenTreeBreadthFirst(e,t){t||(t=1e3);for(var n=[],r=0,a=null,o=[e];t>=r&&o.length>0;){a=[];for(var i=0;i<o.length;++i){var s=o[i];if(t>=r+1&&s){var l=[];"object"==typeof s.children&&s.children?l=s.children:"object"==typeof s._children&&s._children&&(l=s._children),a=a.concat(l)}"object"==typeof s&&n.push(this.serializeTreedNode(s))}r++,o=a}return n},D3SprigBridge.flattenTreeDepthFirst=function flattenTreeDepthFirst(e){var t=[this.serializeTreedNode(e)],n=[];for(e.children&&n.push(e.children);n.length>0;){var r=n[0];if(r.length>0){var a=r.shift();a.children&&a.children.length>0&&n.unshift(a.children),t.push(this.serializeTreedNode(a))}else n.shift()}return t},t.exports=D3SprigBridge},{lodash:20}],6:[function(e,t,n){function setUpController(e,t){var n=e.format?e.format:"sprigot";r&&r.controllerType===n?(r.opts=e,setTimeout(t,0)):(r="bloge"===e.format?i(e):"newdoc"===e.format?o(e):s(e),r.init(t))}function direct(e){function setUpControllerWithDoc(e,r){e?console.log("Error",e):r?(t.format||(t.format=r.format),t.doc||(t.doc=r),n.length>1&&(t.initialTargetSprigId=n[2]),t.loadDone=loadDone,setUpController(t,callLoad)):console.log("Could not find doc",a)}var t=dictFromQueryString(queryStringFromHash(e)),n=e.split("/");n.length>0&&"new"===n[1]?(t.format="newdoc",t.loadDone=loadDone,setUpController(t,callLoad)):(a=getRootIdFromPathSegments(n),c(a)?u.getDoc(a,setUpControllerWithDoc):setUpController({format:"sprigot",rootId:a,initialTargetSprigId:n[2],loadDone:loadDone}))}function getRootIdFromPathSegments(e){return e.length<2||!e[1]?l.defaultDoc:e[1]}function loadDone(e){e&&console.log("Error while loading:",e)}function callLoad(){r.load()}function respondToHashChange(){direct(location.hash)}function init(){direct(location.hash),window.onhashchange=respondToHashChange}function queryStringFromHash(e){var t=null,n=e.split("?");return n.length>1&&(t=n[1]),t}function dictFromQueryString(e){var t={};if(e&&"string"==typeof e)for(var n=e.split("&"),r=0;r<n.length;++r){var a=n[r],o=a.split("=");2===o.length&&(t[o[0]]=o[1])}return t}var r,a,o=e("./newdoc"),i=e("./spriglog"),s=e("./sprigot"),l=e("./sprigotclient_settings"),u=e("./legacy-store"),c=e("./is-legacy");t.exports={init:init,direct:direct}},{"./is-legacy":11,"./legacy-store":13,"./newdoc":16,"./spriglog":26,"./sprigot":27,"./sprigotclient_settings":29}],7:[function(e,t,n){function getStoreForDoc(e){return r(e)?a:o()}var r=e("./is-legacy"),a=e("./legacy-store"),o=e("./store");t.exports=getStoreForDoc},{"./is-legacy":11,"./legacy-store":13,"./store":30}],8:[function(e,t,n){function createGraph(){var e={camera:null,treeRenderer:null,treeNav:null,textStuff:null,historian:null,sprigot:null,pane:null,board:null,svgRoot:null,focusEl:null,focusNode:null,nodeRoot:null,collisionFinder:null,margin:{top:20,right:10,bottom:20,left:10}};return e.init=function init(e,t,n,o,i,s){function expandGraphPane(){this.paneShifter.syncToState("fully-expanded")}this.camera=t,this.treeRenderer=n,this.treeNav=a(),this.textStuff=o,this.historian=i,this.sprigot=s,this.pane=e.append("div").attr("id","graphPane").classed("pane",!0),this.board=this.pane.append("svg").attr({id:"svgBoard"}),this.board.append("g").attr("id","background").append("rect").attr({width:"100%",height:"100%",fill:"rgba(0, 0, 16, 0.2)"}),this.svgRoot=this.board.append("g").attr({id:"graphRoot",transform:"translate("+this.margin.left+","+this.margin.top+")"}),this.camera.setUpZoomOnBoard(this.board,this.svgRoot),this.setGraphScale();var l=this.pane.append("div").attr("id","zoom-note").classed("info-note",!0),u=h();return l.text(u?"You can pinch to zoom in and out of the graph. Drag to pan.":"You can use the mouse wheel to zoom in and out of the graph. Drag to pan."),this.collisionFinder=r(this.board.node()),this.paneShifter=d({state:"half-expanded",pane:this.pane,expandDirection:1}),this.paneShiftControl=c({parent:this.pane,onClick:this.paneShifter.toggle,expandDirection:1,onDarkBackground:!0}),this.paneShiftControl.render(),u&&setTimeout(expandGraphPane.bind(this),100),this},e.setUpFilters=function setUpFilters(){var e=this.board.append("defs").append("filter").attr({id:"text-glow",x:"-20%",y:"-20%",width:"140%",height:"140%"});e.append("feGaussianBlur").attr({"in":"SourceAlpha",stdDeviation:4,result:"blurOut"});var t=e.append("feComponentTransfer").attr({"in":"blurOut",result:"increaseOpacityOut"});t.append("feFuncA").attr({type:"gamma",exponent:.7,amplitude:.8});var n=e.append("feMerge");n.append("feMergeNode").attr("in","increaseOpacityOut"),n.append("feMergeNode").attr("in","SourceGraphic")},e.loadNodeTreeToGraph=function loadNodeTreeToGraph(e,t,n){this.nodeRoot=e,this.treeRenderer.init(this.nodeRoot,this),this.treeNav.init(this.nodeRoot,this.camera,o,this,this.textStuff);var r=this.board.node().clientHeight-this.margin.top-this.margin.bottom;this.nodeRoot.x0=r/2,this.nodeRoot.y0=0,this.treeNav.collapseRecursively(this.nodeRoot);var a=this.nodeRoot;this.treeRenderer.update(this.nodeRoot);var s=!0;if(t){var l=i.mapPathInD3Tree(t,this.nodeRoot,100);l.length>0&&(this.treeNav.followPathToSprig(l),a=l[l.length-1],s=!1)}s&&setTimeout(function initialPan(){this.panToRoot(),this.focusNode&&this.historian.syncURLToSprigId(this.focusNode.id)}.bind(this),900),setTimeout(function initialTextShow(){this.noteNodeWasVisited(a),this.textStuff.initialShow(a),n()}.bind(this),800)},e.panToRoot=function panToRoot(){var e=s.select("#"+this.nodeRoot.id);this.setFocusEl(e.node()),this.camera.panToElement(e)},e.setGraphScale=function setGraphScale(){var e=this.camera.getActualHeight(this.board.node());230>=e&&(this.camera.rootSelection.attr("transform","translate(0, 0) scale(0.75)"),this.camera.zoomBehavior.scale(.5))},e.setFocusEl=function setFocusEl(e){this.focusEl=e,this.focusNode=s.select(this.focusEl).datum()},e.focusOnTreeNode=function focusOnTreeNode(e,t,n){this.setFocusEl(t);var r=this.noteNodeWasVisited(e);r||this.noteNodeWasVisited(e),this.historian.syncURLToSprigId(e.id),this.treeRenderer.update(this.nodeRoot),this.camera.panToElement(s.select(this.focusEl),n)},e.focusOnSprig=function focusOnSprig(e,t,n){t||(t=500);var r=s.select("#"+e);setTimeout(function doFocus(){this.focusOnTreeNode(r.datum(),r.node(),n)}.bind(this),t)},e.nodeHasFocus=function nodeHasFocus(e){return e===this.focusNode},e.noteNodeWasVisited=function noteNodeWasVisited(e){var t="visited_"+e.id;localStorage[t]=!0},e.nodeWasVisited=function nodeWasVisited(e){var t="visited_"+e.id;return t in localStorage},e.nodeIsUnvisited=function nodeIsUnvisited(e){return!this.nodeWasVisited(e)},e.documentIsEditable=function documentIsEditable(){return this.textStuff.editAvailable},e.nodeWasDragged=function nodeWasDragged(e,t){function elOtherHasTreeNodeData(t){return"object"==typeof t.__data__&&"string"==typeof t.__data__.id&&t.__data__.id!==e.id}if(this.documentIsEditable()){var n=this.collisionFinder.elementsHittingEl(t);console.log("collidingEls",n);var r=l.find(n,elOtherHasTreeNodeData);r&&(this.sprigot.metaPressed?this.swapNodeTreePositions(e,r.__data__):this.moveNodeToNewParent(e,r.__data__))}},e.swapNodeWithSibling=function swapNodeWithSibling(e,t){if("object"==typeof e.parent&&"object"==typeof e.parent.children){var n=l.indexOf(e.parent.children,e),r=n+t;if(r>-1&&r<e.parent.children.length){var a=e.parent.children[r];e.parent.children[n]=a,e.parent.children[r]=e;var o=e.parent.doc;u(o).saveSprigFromTreeNode(e.parent,e.parent.doc)}}},e.swapNodeTreePositions=function swapNodeTreePositions(e,t){if("object"==typeof e.parent&&"object"==typeof t.parent){"object"!=typeof e.parent.children&&(e.parent.children=[]),e.parent.children[e.parent.children.indexOf(e)]=t,"object"!=typeof t.parent.children&&(t.parent.children=[]),t.parent.children[t.parent.children.indexOf(t)]=e,this.treeRenderer.update(this.nodeRoot);var n=e.parent.doc;u(n).saveSprigFromTreeNode(e.parent,e.parent.doc),u(n).saveSprigFromTreeNode(t.parent,t.parent.doc)}},e.moveNodeToNewParent=function moveNodeToNewParent(e,t){if(e.parent.id!==t.id){if("object"==typeof e.parent){var n=e.parent.children;n||(n=e.parent._children),"object"==typeof n&&n.splice(n.indexOf(e),1)}var r=t.children;r||(r=t._children),r&&"object"==typeof r||(t.children=[],r=t.children),r.push(e);var a=e.parent;e.parent=t,this.treeRenderer.update(this.nodeRoot);var o=t.doc;u(o).saveSprigFromTreeNode(t,t.doc),u(o).saveSprigFromTreeNode(a,a.doc)}},e}var r=e("./collisionfinder"),a=e("./treenav"),o=e("./treerenderer"),i=e("./d3sprigbridge"),s=e("./lib/d3-small"),l=e("lodash"),u=e("./get-store"),c=e("./pane-shift-control"),d=e("./pane-shifter"),h=e("./is-mobile");t.exports=createGraph},{"./collisionfinder":3,"./d3sprigbridge":5,"./get-store":7,"./is-mobile":12,"./lib/d3-small":14,"./pane-shift-control":23,"./pane-shifter":24,"./treenav":32,"./treerenderer":33,lodash:20}],9:[function(e,t,n){var r=e("./sprigotclient_settings"),a={docNav:null,docId:null};a.init=function init(e,t){this.docNav=e,this.docId=t,window.onpopstate=this.statePopped.bind(this)},a.statePopped=function statePopped(e){e.state&&(this.docId=e.state.docId,this.docNav.goToSprigId(e.state.sprigId,100))},a.syncURLToSprigId=function syncURLToSprigId(e){if("object"!=typeof window.history.state||!window.history.state||"string"!=typeof window.history.state.docId||"string"!=typeof window.history.state.sprigId||window.history.state.docId!==this.docId||window.history.state.sprigId!==e){var t=this.docId+"/";r.defaultDoc&&this.docId===r.defaultDoc&&(t="");var n=location.protocol+"//"+location.host+location.pathname+"#/"+t+e,a=location.hash.split("?");a.length>1&&(n+="?"+a[1]),window.history.pushState({docId:this.docId,sprigId:e},null,n)}},t.exports=a},{"./sprigotclient_settings":29}],10:[function(e,t,n){var r=e("./direct");console.log("hey guy"),r.init()},{"./direct":6}],11:[function(e,t,n){function docIsLegacy(e){return!0}t.exports=docIsLegacy},{}],12:[function(e,t,n){function isMobile(){var e="only screen and (max-device-height: 568px)";return window.matchMedia(e).matches}t.exports=isMobile},{}],13:[function(e,t,n){function saveSprigFromTreeNode(e,t){function logResults(e,t){return e?void console.log("Error during saveSprigFromTreeNode:",e):void console.log(t)}var n=null;if(e&&(n=o.serializeTreedNode(e)),n){var r=a.randomId(4),s={};n.doc=t,s[r]={op:"saveSprig",params:n},i.request(s,logResults)}}function saveChildAndParentSprig(e,t){function logResults(e,t){return e?void console.log("Error while saving sprigs:",e):(console.log("Child sprig save status:",t.saveChildSprigOp.status),void console.log("Parent sprig save status:",t.saveParentSprigOp.status))}var n={};n.saveChildSprigOp={op:"saveSprig",params:e},n.saveParentSprigOp={op:"saveSprig",params:t},i.request(n,logResults)}function deleteChildAndSaveParentSprig(e,t){function logResults(e,t){return e?void console.log("Error while saving sprigs:",e):(console.log("Sprig deletion status:",t.deleteChildSprigOp.status),void console.log("Parent sprig save status:",t.saveParentSprigOp.status))}var n={};n.deleteChildSprigOp={op:"deleteSprig",params:e},n.saveParentSprigOp={op:"saveSprig",params:t},i.request(n,logResults)}function getDoc(e,t){function logResults(e,n){return e?void(t&&t(e,null)):void("getDocReq"in n&&"got"===n.getDocReq.status?t&&t(null,n.getDocReq.result):t&&t(null,null))}var n={op:"getDoc",params:{id:e,childDepth:0}};i.request({getDocReq:n},logResults)}function getSprigTree(e,t,n){function logResults(e,t){return e?void(n&&n(e,null)):void("getDocReq"in t&&"got"===t.getDocReq.status?n&&n(null,t.getDocReq.result.sprigTree):n&&n(null,null))}var r={op:"getDoc",params:{id:e,childDepth:40}};t&&(r.params.filterByFormat=t),i.request({getDocReq:r},logResults)}function getSprigList(e,t,n){function logResults(e,t){return e?void(n&&n(e,null)):void("getDocReq"in t&&"got"===t.getDocReq.status?n&&n(null,t.getDocReq.result.sprigList):n&&n(null,null))}var r={op:"getDoc",params:{id:e,flatten:!0}};t&&(r.params.filterByFormat=t),i.request({getDocReq:r},logResults)}function createNewDoc(e,t,n){var r={},o="docCreateReq"+a.randomId(4),s="rootSprigSaveReq"+a.randomId(4);r[o]={op:"saveDoc",params:e},r[s]={op:"saveSprig",params:t},i.request(r,n)}var r=e("./apienvoy"),a=e("idmaker"),o=e("./d3sprigbridge"),i=r("http://192.241.250.38:3003");t.exports={saveSprigFromTreeNode:saveSprigFromTreeNode,saveChildAndParentSprig:saveChildAndParentSprig,deleteChildAndSaveParentSprig:deleteChildAndSaveParentSprig,getDoc:getDoc,getSprigTree:getSprigTree,getSprigList:getSprigList,createNewDoc:createNewDoc}},{"./apienvoy":1,"./d3sprigbridge":5,idmaker:19}],14:[function(e,t,n){!function(){function d3_documentElement(e){return e&&(e.ownerDocument||e.document||e).documentElement}function d3_window(e){return e&&(e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView)}function d3_vendorSymbol(e,t){if(t in e)return t;t=t.charAt(0).toUpperCase()+t.slice(1);for(var n=0,r=f.length;r>n;++n){var a=f[n]+t;if(a in e)return a}}function d3_selection(e){return h(e,m),e}function d3_selection_selector(e){return"function"==typeof e?e:function(){return p(e,this)}}function d3_selection_selectorAll(e){return"function"==typeof e?e:function(){return g(e,this)}}function d3_selection_attr(t,n){function attrNull(){this.removeAttribute(t)}function attrNullNS(){this.removeAttributeNS(t.space,t.local)}function attrConstant(){this.setAttribute(t,n)}function attrConstantNS(){this.setAttributeNS(t.space,t.local,n)}function attrFunction(){var e=n.apply(this,arguments);null==e?this.removeAttribute(t):this.setAttribute(t,e)}function attrFunctionNS(){var e=n.apply(this,arguments);null==e?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,e)}return t=e.ns.qualify(t),null==n?t.local?attrNullNS:attrNull:"function"==typeof n?t.local?attrFunctionNS:attrFunction:t.local?attrConstantNS:attrConstant}function d3_collapse(e){return e.trim().replace(/\s+/g," ")}function d3_selection_classedRe(t){return new RegExp("(?:^|\\s+)"+e.requote(t)+"(?:\\s+|$)","g")}function d3_selection_classes(e){return(e+"").trim().split(/^|\s+/)}function d3_selection_classed(e,t){function classedConstant(){for(var r=-1;++r<n;)e[r](this,t)}function classedFunction(){for(var r=-1,a=t.apply(this,arguments);++r<n;)e[r](this,a)}e=d3_selection_classes(e).map(d3_selection_classedName);var n=e.length;return"function"==typeof t?classedFunction:classedConstant}function d3_selection_classedName(e){var t=d3_selection_classedRe(e);return function(n,r){if(a=n.classList)return r?a.add(e):a.remove(e);var a=n.getAttribute("class")||"";r?(t.lastIndex=0,t.test(a)||n.setAttribute("class",d3_collapse(a+" "+e))):n.setAttribute("class",d3_collapse(a.replace(t," ")))}}function d3_selection_style(e,t,n){function styleNull(){this.style.removeProperty(e)}function styleConstant(){this.style.setProperty(e,t,n)}function styleFunction(){var r=t.apply(this,arguments);null==r?this.style.removeProperty(e):this.style.setProperty(e,r,n)}return null==t?styleNull:"function"==typeof t?styleFunction:styleConstant}function d3_selection_property(e,t){function propertyNull(){delete this[e]}function propertyConstant(){this[e]=t}function propertyFunction(){var n=t.apply(this,arguments);null==n?delete this[e]:this[e]=n}return null==t?propertyNull:"function"==typeof t?propertyFunction:propertyConstant}function d3_selection_creator(t){function create(){var e=this.ownerDocument,n=this.namespaceURI;return n?e.createElementNS(n,t):e.createElement(t)}function createNS(){return this.ownerDocument.createElementNS(t.space,t.local)}return"function"==typeof t?t:(t=e.ns.qualify(t)).local?createNS:create}function d3_selectionRemove(){var e=this.parentNode;e&&e.removeChild(this)}function d3_class(e,t){for(var n in t)Object.defineProperty(e.prototype,n,{value:t[n],enumerable:!1})}function d3_Map(){this._=Object.create(null)}function d3_map_escape(e){return(e+="")===b||e[0]===x?x+e:e}function d3_map_unescape(e){return(e+="")[0]===x?e.slice(1):e}function d3_map_has(e){return d3_map_escape(e)in this._}function d3_map_remove(e){return(e=d3_map_escape(e))in this._&&delete this._[e]}function d3_map_keys(){var e=[];for(var t in this._)e.push(d3_map_unescape(t));return e}function d3_map_size(){var e=0;for(var t in this._)++e;return e}function d3_map_empty(){for(var e in this._)return!1;return!0}function d3_Set(){this._=Object.create(null)}function d3_selection_dataNode(e){return{__data__:e}}function d3_selection_filter(e){return function(){return _(this,e)}}function d3_ascending(e,t){return t>e?-1:e>t?1:e>=t?0:0/0}function d3_selection_sortComparator(e){return arguments.length||(e=d3_ascending),function(t,n){return t&&n?e(t.__data__,n.__data__):!t-!n}}function d3_noop(){}function d3_dispatch(){}function d3_dispatch_event(e){function event(){for(var n,r=t,a=-1,o=r.length;++a<o;)(n=r[a].on)&&n.apply(this,arguments);return e}var t=[],n=new d3_Map;return event.on=function(r,a){var o,i=n.get(r);return arguments.length<2?i&&i.on:(i&&(i.on=null,t=t.slice(0,o=t.indexOf(i)).concat(t.slice(o+1)),n.remove(r)),a&&t.push(n.set(r,{on:a})),e)},event}function d3_eventPreventDefault(){e.event.preventDefault()}function d3_eventSource(){for(var t,n=e.event;t=n.sourceEvent;)n=t;return n}function d3_eventDispatch(t){for(var n=new d3_dispatch,r=0,a=arguments.length;++r<a;)n[arguments[r]]=d3_dispatch_event(n);return n.of=function(r,a){return function(o){try{var i=o.sourceEvent=e.event;o.target=t,e.event=o,n[o.type].apply(r,a)}finally{e.event=i}}},n}function d3_selection_on(t,n,a){function onRemove(){var e=this[o];e&&(this.removeEventListener(t,e,e.$),delete this[o])}function onAdd(){var e=s(n,r(arguments));onRemove.call(this),this.addEventListener(t,this[o]=e,e.$=a),e._=n}function removeAll(){var n,r=new RegExp("^__on([^.]+)"+e.requote(t)+"$");for(var a in this)if(n=a.match(r)){var o=this[a];this.removeEventListener(n[1],o,o.$),delete this[a]}}var o="__on"+t,i=t.indexOf("."),s=d3_selection_onListener;i>0&&(t=t.slice(0,i));var l=w.get(t);return l&&(t=l,s=d3_selection_onFilter),i?n?onAdd:onRemove:n?d3_noop:removeAll}function d3_selection_onListener(t,n){return function(r){var a=e.event;e.event=r,n[0]=this.__data__;try{t.apply(this,n)}finally{e.event=a}}}function d3_selection_onFilter(e,t){var n=d3_selection_onListener(e,t);return function(e){var t=this,r=e.relatedTarget;r&&(r===t||8&r.compareDocumentPosition(t))||n.call(t,e)}}function d3_selection_each(e,t){for(var n=0,r=e.length;r>n;n++)for(var a,o=e[n],i=0,s=o.length;s>i;i++)(a=o[i])&&t(a,i,n);return e}function d3_selection_enter(e){return h(e,T),e}function d3_selection_enterInsertBefore(e){var t,n;return function(r,a,o){var i,s=e[o].update,l=s.length;for(o!=n&&(n=o,t=0),a>=t&&(t=a+1);!(i=s[t])&&++t<l;);return i}}function d3_true(){return!0}function d3_timer_step(){var e=d3_timer_mark(),t=d3_timer_sweep()-e;t>24?(isFinite(t)&&(clearTimeout(N),N=setTimeout(d3_timer_step,t)),k=0):(k=1,F(d3_timer_step))}function d3_timer_mark(){var e=Date.now();for(I=S;I;)e>=I.t&&(I.f=I.c(e-I.t)),I=I.n;return e}function d3_timer_sweep(){for(var e,t=S,n=1/0;t;)t.f?t=e?e.n=t.n:S=t.n:(t.t<n&&(n=t.t),t=(e=t).n);return C=e,n}function d3_selection_interruptNS(e){return function(){var t,n;(t=this[e])&&(n=t[t.active])&&(--t.count?delete t[t.active]:delete this[e],t.active+=.5,n.event&&n.event.interrupt.call(this,this.__data__,n.index))}}function d3_transition(e,t,n){return h(e,R),e.namespace=t,e.id=n,e}function d3_color(){}function d3_hsl(e,t,n){return this instanceof d3_hsl?(this.h=+e,this.s=+t,void(this.l=+n)):arguments.length<2?e instanceof d3_hsl?new d3_hsl(e.h,e.s,e.l):d3_rgb_parse(""+e,d3_rgb_hsl,d3_hsl):new d3_hsl(e,t,n)}function d3_hsl_rgb(e,t,n){function v(e){return e>360?e-=360:0>e&&(e+=360),60>e?r+(a-r)*e/60:180>e?a:240>e?r+(a-r)*(240-e)/60:r}function vv(e){return Math.round(255*v(e))}var r,a;return e=isNaN(e)?0:(e%=360)<0?e+360:e,t=isNaN(t)?0:0>t?0:t>1?1:t,n=0>n?0:n>1?1:n,a=.5>=n?n*(1+t):n+t-n*t,r=2*n-a,new d3_rgb(vv(e+120),vv(e),vv(e-120))}function d3_sinh(e){return((e=Math.exp(e))-1/e)/2}function d3_cosh(e){return((e=Math.exp(e))+1/e)/2}function d3_tanh(e){return((e=Math.exp(2*e))-1)/(e+1)}function d3_hcl(t,n,r){return this instanceof d3_hcl?(this.h=+t,this.c=+n,void(this.l=+r)):arguments.length<2?t instanceof d3_hcl?new d3_hcl(t.h,t.c,t.l):t instanceof d3_lab?d3_lab_hcl(t.l,t.a,t.b):d3_lab_hcl((t=d3_rgb_lab((t=e.rgb(t)).r,t.g,t.b)).l,t.a,t.b):new d3_hcl(t,n,r)}function d3_hcl_lab(e,t,n){return isNaN(e)&&(e=0),isNaN(t)&&(t=0),new d3_lab(n,Math.cos(e*=j)*t,Math.sin(e)*t)}function d3_lab(e,t,n){return this instanceof d3_lab?(this.l=+e,this.a=+t,void(this.b=+n)):arguments.length<2?e instanceof d3_lab?new d3_lab(e.l,e.a,e.b):e instanceof d3_hcl?d3_hcl_lab(e.h,e.c,e.l):d3_rgb_lab((e=d3_rgb(e)).r,e.g,e.b):new d3_lab(e,t,n)}function d3_lab_rgb(e,t,n){var r=(e+16)/116,a=r+t/500,o=r-n/200;return a=d3_lab_xyz(a)*B,r=d3_lab_xyz(r)*K,o=d3_lab_xyz(o)*H,new d3_rgb(d3_xyz_rgb(3.2404542*a-1.5371385*r-.4985314*o),d3_xyz_rgb(-.969266*a+1.8760108*r+.041556*o),d3_xyz_rgb(.0556434*a-.2040259*r+1.0572252*o))}function d3_lab_hcl(e,t,n){return e>0?new d3_hcl(Math.atan2(n,t)*W,Math.sqrt(t*t+n*n),e):new d3_hcl(0/0,0/0,e)}function d3_lab_xyz(e){return e>.206893034?e*e*e:(e-4/29)/7.787037}function d3_xyz_lab(e){return e>.008856?Math.pow(e,1/3):7.787037*e+4/29}function d3_xyz_rgb(e){return Math.round(255*(.00304>=e?12.92*e:1.055*Math.pow(e,1/2.4)-.055))}function d3_rgb(e,t,n){return this instanceof d3_rgb?(this.r=~~e,this.g=~~t,void(this.b=~~n)):arguments.length<2?e instanceof d3_rgb?new d3_rgb(e.r,e.g,e.b):d3_rgb_parse(""+e,d3_rgb,d3_hsl_rgb):new d3_rgb(e,t,n)}function d3_rgbNumber(e){return new d3_rgb(e>>16,e>>8&255,255&e)}function d3_rgb_hex(e){return 16>e?"0"+Math.max(0,e).toString(16):Math.min(255,e).toString(16)}function d3_rgb_parse(e,t,n){var r,a,o,i=0,s=0,l=0;if(r=/([a-z]+)\((.*)\)/i.exec(e))switch(a=r[2].split(","),r[1]){case"hsl":return n(parseFloat(a[0]),parseFloat(a[1])/100,parseFloat(a[2])/100);case"rgb":return t(d3_rgb_parseNumber(a[0]),d3_rgb_parseNumber(a[1]),d3_rgb_parseNumber(a[2]))}return(o=Z.get(e.toLowerCase()))?t(o.r,o.g,o.b):(null==e||"#"!==e.charAt(0)||isNaN(o=parseInt(e.slice(1),16))||(4===e.length?(i=(3840&o)>>4,i=i>>4|i,s=240&o,s=s>>4|s,l=15&o,l=l<<4|l):7===e.length&&(i=(16711680&o)>>16,s=(65280&o)>>8,l=255&o)),t(i,s,l))}function d3_rgb_hsl(e,t,n){var r,a,o=Math.min(e/=255,t/=255,n/=255),i=Math.max(e,t,n),s=i-o,l=(i+o)/2;return s?(a=.5>l?s/(i+o):s/(2-i-o),r=e==i?(t-n)/s+(n>t?6:0):t==i?(n-e)/s+2:(e-t)/s+4,r*=60):(r=0/0,a=l>0&&1>l?0:r),new d3_hsl(r,a,l)}function d3_rgb_lab(e,t,n){e=d3_rgb_xyz(e),t=d3_rgb_xyz(t),n=d3_rgb_xyz(n);var r=d3_xyz_lab((.4124564*e+.3575761*t+.1804375*n)/B),a=d3_xyz_lab((.2126729*e+.7151522*t+.072175*n)/K),o=d3_xyz_lab((.0193339*e+.119192*t+.9503041*n)/H);return d3_lab(116*a-16,500*(r-a),200*(a-o))}function d3_rgb_xyz(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function d3_rgb_parseNumber(e){var t=parseFloat(e);return"%"===e.charAt(e.length-1)?Math.round(2.55*t):t}function d3_interpolateRgb(t,n){t=e.rgb(t),n=e.rgb(n);var r=t.r,a=t.g,o=t.b,i=n.r-r,s=n.g-a,l=n.b-o;return function(e){return"#"+d3_rgb_hex(Math.round(r+i*e))+d3_rgb_hex(Math.round(a+s*e))+d3_rgb_hex(Math.round(o+l*e))}}function d3_interpolateObject(e,t){var n,r={},a={};for(n in e)n in t?r[n]=d3_interpolate(e[n],t[n]):a[n]=e[n];for(n in t)n in e||(a[n]=t[n]);return function(e){for(n in r)a[n]=r[n](e);return a}}function d3_interpolateArray(e,t){var n,r=[],a=[],o=e.length,i=t.length,s=Math.min(e.length,t.length);for(n=0;s>n;++n)r.push(d3_interpolate(e[n],t[n]));for(;o>n;++n)a[n]=e[n];for(;i>n;++n)a[n]=t[n];return function(e){for(n=0;s>n;++n)a[n]=r[n](e);return a}}function d3_interpolateNumber(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function d3_interpolateString(e,t){var n,r,a,o=G.lastIndex=$.lastIndex=0,i=-1,s=[],l=[];for(e+="",t+="";(n=G.exec(e))&&(r=$.exec(t));)(a=r.index)>o&&(a=t.slice(o,a),s[i]?s[i]+=a:s[++i]=a),(n=n[0])===(r=r[0])?s[i]?s[i]+=r:s[++i]=r:(s[++i]=null,l.push({i:i,x:d3_interpolateNumber(n,r)})),o=$.lastIndex;return o<t.length&&(a=t.slice(o),s[i]?s[i]+=a:s[++i]=a),s.length<2?l[0]?(t=l[0].x,function(e){return t(e)+""}):function(){return t}:(t=l.length,function(e){for(var n,r=0;t>r;++r)s[(n=l[r]).i]=n.x(e);return s.join("")})}function d3_interpolate(t,n){for(var r,a=e.interpolators.length;--a>=0&&!(r=e.interpolators[a](t,n)););return r}function d3_transform(e){var t=[e.a,e.b],n=[e.c,e.d],r=d3_transformNormalize(t),a=d3_transformDot(t,n),o=d3_transformNormalize(d3_transformCombine(n,t,-a))||0;t[0]*n[1]<n[0]*t[1]&&(t[0]*=-1,t[1]*=-1,r*=-1,a*=-1),this.rotate=(r?Math.atan2(t[1],t[0]):Math.atan2(-n[0],n[1]))*W,this.translate=[e.e,e.f],this.scale=[r,o],this.skew=o?Math.atan2(a,o)*W:0}function d3_transformDot(e,t){return e[0]*t[0]+e[1]*t[1];

}function d3_transformNormalize(e){var t=Math.sqrt(d3_transformDot(e,e));return t&&(e[0]/=t,e[1]/=t),t}function d3_transformCombine(e,t,n){return e[0]+=n*t[0],e[1]+=n*t[1],e}function d3_interpolateTransform(t,n){var r,a=[],o=[],i=e.transform(t),s=e.transform(n),l=i.translate,u=s.translate,c=i.rotate,d=s.rotate,h=i.skew,f=s.skew,p=i.scale,g=s.scale;return l[0]!=u[0]||l[1]!=u[1]?(a.push("translate(",null,",",null,")"),o.push({i:1,x:d3_interpolateNumber(l[0],u[0])},{i:3,x:d3_interpolateNumber(l[1],u[1])})):a.push(u[0]||u[1]?"translate("+u+")":""),c!=d?(c-d>180?d+=360:d-c>180&&(c+=360),o.push({i:a.push(a.pop()+"rotate(",null,")")-2,x:d3_interpolateNumber(c,d)})):d&&a.push(a.pop()+"rotate("+d+")"),h!=f?o.push({i:a.push(a.pop()+"skewX(",null,")")-2,x:d3_interpolateNumber(h,f)}):f&&a.push(a.pop()+"skewX("+f+")"),p[0]!=g[0]||p[1]!=g[1]?(r=a.push(a.pop()+"scale(",null,",",null,")"),o.push({i:r-4,x:d3_interpolateNumber(p[0],g[0])},{i:r-2,x:d3_interpolateNumber(p[1],g[1])})):(1!=g[0]||1!=g[1])&&a.push(a.pop()+"scale("+g+")"),r=o.length,function(e){for(var t,n=-1;++n<r;)a[(t=o[n]).i]=t.x(e);return a.join("")}}function d3_transition_tween(e,t,n,r){var a=e.id,o=e.namespace;return d3_selection_each(e,"function"==typeof n?function(e,i,s){e[o][a].tween.set(t,r(n.call(e,e.__data__,i,s)))}:(n=r(n),function(e){e[o][a].tween.set(t,n)}))}function d3_transition_text(e){return null==e&&(e=""),function(){this.textContent=e}}function d3_identity(e){return e}function d3_ease_clamp(e){return function(t){return 0>=t?0:t>=1?1:e(t)}}function d3_ease_reverse(e){return function(t){return 1-e(1-t)}}function d3_ease_reflect(e){return function(t){return.5*(.5>t?e(2*t):2-e(2-2*t))}}function d3_ease_quad(e){return e*e}function d3_ease_cubic(e){return e*e*e}function d3_ease_cubicInOut(e){if(0>=e)return 0;if(e>=1)return 1;var t=e*e,n=t*e;return 4*(.5>e?n:3*(e-t)+n-.75)}function d3_ease_poly(e){return function(t){return Math.pow(t,e)}}function d3_ease_sin(e){return 1-Math.cos(e*z)}function d3_ease_exp(e){return Math.pow(2,10*(e-1))}function d3_ease_circle(e){return 1-Math.sqrt(1-e*e)}function d3_ease_elastic(e,t){var n;return arguments.length<2&&(t=.45),arguments.length?n=t/L*Math.asin(1/e):(e=1,n=t/4),function(r){return 1+e*Math.pow(2,-10*r)*Math.sin((r-n)*L/t)}}function d3_ease_back(e){return e||(e=1.70158),function(t){return t*t*((e+1)*t-e)}}function d3_ease_bounce(e){return 1/2.75>e?7.5625*e*e:2/2.75>e?7.5625*(e-=1.5/2.75)*e+.75:2.5/2.75>e?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375}function d3_transitionNamespace(e){return null==e?"__transition__":"__transition_"+e+"__"}function d3_transitionNode(t,n,r,a,o){var i=t[r]||(t[r]={active:0,count:0}),s=i[a];if(!s){var l=o.time;s=i[a]={tween:new d3_Map,time:l,delay:o.delay,duration:o.duration,ease:o.ease,index:n},o=null,++i.count,e.timer(function(o){function start(r){if(i.active>a)return stop();var o=i[i.active];o&&(--i.count,delete i[i.active],o.event&&o.event.interrupt.call(t,t.__data__,o.index)),i.active=a,s.event&&s.event.start.call(t,t.__data__,n),s.tween.forEach(function(e,r){(r=r.call(t,t.__data__,n))&&f.push(r)}),c=s.ease,u=s.duration,e.timer(function(){return h.c=tick(r||1)?d3_true:tick,1},0,l)}function tick(e){if(i.active!==a)return 1;for(var r=e/u,o=c(r),l=f.length;l>0;)f[--l].call(t,o);return r>=1?(s.event&&s.event.end.call(t,t.__data__,n),stop()):void 0}function stop(){return--i.count?delete i[a]:delete t[r],1}var u,c,d=s.delay,h=I,f=[];return h.t=d+l,o>=d?start(o-d):void(h.c=start)},0,l)}}function d3_mousePoint(t,n){n.changedTouches&&(n=n.changedTouches[0]);var r=t.ownerSVGElement||t;if(r.createSVGPoint){var a=r.createSVGPoint();if(0>te){var o=d3_window(t);if(o.scrollX||o.scrollY){r=e.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important");var i=r[0][0].getScreenCTM();te=!(i.f||i.e),r.remove()}}return te?(a.x=n.pageX,a.y=n.pageY):(a.x=n.clientX,a.y=n.clientY),a=a.matrixTransform(t.getScreenCTM().inverse()),[a.x,a.y]}var s=t.getBoundingClientRect();return[n.clientX-s.left-t.clientLeft,n.clientY-s.top-t.clientTop]}function d3_range_integerScale(e){for(var t=1;e*t%1;)t*=10;return t}function d3_rebind(e,t,n){return function(){var r=n.apply(t,arguments);return r===t?e:r}}function d3_interpolateRound(e,t){return t-=e,function(n){return Math.round(e+t*n)}}function d3_uninterpolateNumber(e,t){return t=(t-=e=+e)||1/t,function(n){return(n-e)/t}}function d3_uninterpolateClamp(e,t){return t=(t-=e=+e)||1/t,function(n){return Math.max(0,Math.min(1,(n-e)/t))}}function d3_format_precision(e,t){return t-(e?Math.ceil(Math.log(e)/Math.LN10):1)}function d3_formatPrefix(e,t){var n=Math.pow(10,3*ne(8-t));return{scale:t>8?function(e){return e/n}:function(e){return e*n},symbol:e}}function d3_locale_numberFormat(t){var n=t.decimal,r=t.thousands,a=t.grouping,o=t.currency,i=a&&r?function(e,t){for(var n=e.length,o=[],i=0,s=a[0],l=0;n>0&&s>0&&(l+s+1>t&&(s=Math.max(1,t-l)),o.push(e.substring(n-=s,n+s)),!((l+=s+1)>t));)s=a[i=(i+1)%a.length];return o.reverse().join(r)}:d3_identity;return function(t){var r=ae.exec(t),a=r[1]||" ",s=r[2]||">",l=r[3]||"-",u=r[4]||"",c=r[5],d=+r[6],h=r[7],f=r[8],p=r[9],g=1,_="",m="",v=!1,y=!0;switch(f&&(f=+f.substring(1)),(c||"0"===a&&"="===s)&&(c=a="0",s="="),p){case"n":h=!0,p="g";break;case"%":g=100,m="%",p="f";break;case"p":g=100,m="%",p="r";break;case"b":case"o":case"x":case"X":"#"===u&&(_="0"+p.toLowerCase());case"c":y=!1;case"d":v=!0,f=0;break;case"s":g=-1,p="r"}"$"===u&&(_=o[0],m=o[1]),"r"!=p||f||(p="g"),null!=f&&("g"==p?f=Math.max(1,Math.min(21,f)):("e"==p||"f"==p)&&(f=Math.max(0,Math.min(20,f)))),p=oe.get(p)||d3_format_typeDefault;var b=c&&h;return function(t){var r=m;if(v&&t%1)return"";var o=0>t||0===t&&0>1/t?(t=-t,"-"):"-"===l?"":l;if(0>g){var u=e.formatPrefix(t,f);t=u.scale(t),r=u.symbol+m}else t*=g;t=p(t,f);var x,w,T=t.lastIndexOf(".");if(0>T){var S=y?t.lastIndexOf("e"):-1;0>S?(x=t,w=""):(x=t.substring(0,S),w=t.substring(S))}else x=t.substring(0,T),w=n+t.substring(T+1);!c&&h&&(x=i(x,1/0));var C=_.length+x.length+w.length+(b?0:o.length),k=d>C?new Array(C=d-C+1).join(a):"";return b&&(x=i(k+x,k.length?d-w.length:1/0)),o+=_,t=x+w,("<"===s?o+t+k:">"===s?k+o+t:"^"===s?k.substring(0,C>>=1)+o+t+k.substring(C):o+(b?t:k+t))+r}}}function d3_format_typeDefault(e){return e+""}function d3_date_utc(){this._=new Date(arguments.length>1?Date.UTC.apply(this,arguments):arguments[0])}function d3_time_interval(e,t,n){function round(t){var n=e(t),r=offset(n,1);return r-t>t-n?n:r}function ceil(n){return t(n=e(new se(n-1)),1),n}function offset(e,n){return t(e=new se(+e),n),e}function range(e,r,a){var o=ceil(e),i=[];if(a>1)for(;r>o;)n(o)%a||i.push(new Date(+o)),t(o,1);else for(;r>o;)i.push(new Date(+o)),t(o,1);return i}function range_utc(e,t,n){try{se=d3_date_utc;var r=new d3_date_utc;return r._=e,range(r,t,n)}finally{se=Date}}e.floor=e,e.round=round,e.ceil=ceil,e.offset=offset,e.range=range;var r=e.utc=d3_time_interval_utc(e);return r.floor=r,r.round=d3_time_interval_utc(round),r.ceil=d3_time_interval_utc(ceil),r.offset=d3_time_interval_utc(offset),r.range=range_utc,e}function d3_time_interval_utc(e){return function(t,n){try{se=d3_date_utc;var r=new d3_date_utc;return r._=t,e(r,n)._}finally{se=Date}}}function d3_locale_timeFormat(t){function d3_time_format(e){function format(n){for(var r,a,o,i=[],s=-1,l=0;++s<t;)37===e.charCodeAt(s)&&(i.push(e.slice(l,s)),null!=(a=ue[r=e.charAt(++s)])&&(r=e.charAt(++s)),(o=y[r])&&(r=o(n,null==a?"e"===r?" ":"0":a)),i.push(r),l=s+1);return i.push(e.slice(l,s)),i.join("")}var t=e.length;return format.parse=function(t){var n={y:1900,m:0,d:1,H:0,M:0,S:0,L:0,Z:null},r=d3_time_parse(n,e,t,0);if(r!=t.length)return null;"p"in n&&(n.H=n.H%12+12*n.p);var a=null!=n.Z&&se!==d3_date_utc,o=new(a?d3_date_utc:se);return"j"in n?o.setFullYear(n.y,0,n.j):"w"in n&&("W"in n||"U"in n)?(o.setFullYear(n.y,0,1),o.setFullYear(n.y,0,"W"in n?(n.w+6)%7+7*n.W-(o.getDay()+5)%7:n.w+7*n.U-(o.getDay()+6)%7)):o.setFullYear(n.y,n.m,n.d),o.setHours(n.H+(n.Z/100|0),n.M+n.Z%100,n.S,n.L),a?o._:o},format.toString=function(){return e},format}function d3_time_parse(e,t,n,r){for(var a,o,i,s=0,l=t.length,u=n.length;l>s;){if(r>=u)return-1;if(a=t.charCodeAt(s++),37===a){if(i=t.charAt(s++),o=b[i in ue?t.charAt(s++):i],!o||(r=o(e,n,r))<0)return-1}else if(a!=n.charCodeAt(r++))return-1}return r}function d3_time_parseWeekdayAbbrev(e,t,n){f.lastIndex=0;var r=f.exec(t.slice(n));return r?(e.w=p.get(r[0].toLowerCase()),n+r[0].length):-1}function d3_time_parseWeekday(e,t,n){d.lastIndex=0;var r=d.exec(t.slice(n));return r?(e.w=h.get(r[0].toLowerCase()),n+r[0].length):-1}function d3_time_parseMonthAbbrev(e,t,n){m.lastIndex=0;var r=m.exec(t.slice(n));return r?(e.m=v.get(r[0].toLowerCase()),n+r[0].length):-1}function d3_time_parseMonth(e,t,n){g.lastIndex=0;var r=g.exec(t.slice(n));return r?(e.m=_.get(r[0].toLowerCase()),n+r[0].length):-1}function d3_time_parseLocaleFull(e,t,n){return d3_time_parse(e,y.c.toString(),t,n)}function d3_time_parseLocaleDate(e,t,n){return d3_time_parse(e,y.x.toString(),t,n)}function d3_time_parseLocaleTime(e,t,n){return d3_time_parse(e,y.X.toString(),t,n)}function d3_time_parseAmPm(e,t,n){var r=c.get(t.slice(n,n+=2).toLowerCase());return null==r?-1:(e.p=r,n)}var n=t.dateTime,r=t.date,a=t.time,o=t.periods,i=t.days,s=t.shortDays,l=t.months,u=t.shortMonths;d3_time_format.utc=function(e){function format(e){try{se=d3_date_utc;var n=new se;return n._=e,t(n)}finally{se=Date}}var t=d3_time_format(e);return format.parse=function(e){try{se=d3_date_utc;var n=t.parse(e);return n&&n._}finally{se=Date}},format.toString=t.toString,format},d3_time_format.multi=d3_time_format.utc.multi=d3_time_formatMulti;var c=e.map(),d=d3_time_formatRe(i),h=d3_time_formatLookup(i),f=d3_time_formatRe(s),p=d3_time_formatLookup(s),g=d3_time_formatRe(l),_=d3_time_formatLookup(l),m=d3_time_formatRe(u),v=d3_time_formatLookup(u);o.forEach(function(e,t){c.set(e.toLowerCase(),t)});var y={a:function(e){return s[e.getDay()]},A:function(e){return i[e.getDay()]},b:function(e){return u[e.getMonth()]},B:function(e){return l[e.getMonth()]},c:d3_time_format(n),d:function(e,t){return d3_time_formatPad(e.getDate(),t,2)},e:function(e,t){return d3_time_formatPad(e.getDate(),t,2)},H:function(e,t){return d3_time_formatPad(e.getHours(),t,2)},I:function(e,t){return d3_time_formatPad(e.getHours()%12||12,t,2)},j:function(e,t){return d3_time_formatPad(1+ie.dayOfYear(e),t,3)},L:function(e,t){return d3_time_formatPad(e.getMilliseconds(),t,3)},m:function(e,t){return d3_time_formatPad(e.getMonth()+1,t,2)},M:function(e,t){return d3_time_formatPad(e.getMinutes(),t,2)},p:function(e){return o[+(e.getHours()>=12)]},S:function(e,t){return d3_time_formatPad(e.getSeconds(),t,2)},U:function(e,t){return d3_time_formatPad(ie.sundayOfYear(e),t,2)},w:function(e){return e.getDay()},W:function(e,t){return d3_time_formatPad(ie.mondayOfYear(e),t,2)},x:d3_time_format(r),X:d3_time_format(a),y:function(e,t){return d3_time_formatPad(e.getFullYear()%100,t,2)},Y:function(e,t){return d3_time_formatPad(e.getFullYear()%1e4,t,4)},Z:d3_time_zone,"%":function(){return"%"}},b={a:d3_time_parseWeekdayAbbrev,A:d3_time_parseWeekday,b:d3_time_parseMonthAbbrev,B:d3_time_parseMonth,c:d3_time_parseLocaleFull,d:d3_time_parseDay,e:d3_time_parseDay,H:d3_time_parseHour24,I:d3_time_parseHour24,j:d3_time_parseDayOfYear,L:d3_time_parseMilliseconds,m:d3_time_parseMonthNumber,M:d3_time_parseMinutes,p:d3_time_parseAmPm,S:d3_time_parseSeconds,U:d3_time_parseWeekNumberSunday,w:d3_time_parseWeekdayNumber,W:d3_time_parseWeekNumberMonday,x:d3_time_parseLocaleDate,X:d3_time_parseLocaleTime,y:d3_time_parseYear,Y:d3_time_parseFullYear,Z:d3_time_parseZone,"%":d3_time_parseLiteralPercent};return d3_time_format}function d3_time_formatPad(e,t,n){var r=0>e?"-":"",a=(r?-e:e)+"",o=a.length;return r+(n>o?new Array(n-o+1).join(t)+a:a)}function d3_time_formatRe(t){return new RegExp("^(?:"+t.map(e.requote).join("|")+")","i")}function d3_time_formatLookup(e){for(var t=new d3_Map,n=-1,r=e.length;++n<r;)t.set(e[n].toLowerCase(),n);return t}function d3_time_parseWeekdayNumber(e,t,n){ce.lastIndex=0;var r=ce.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function d3_time_parseWeekNumberSunday(e,t,n){ce.lastIndex=0;var r=ce.exec(t.slice(n));return r?(e.U=+r[0],n+r[0].length):-1}function d3_time_parseWeekNumberMonday(e,t,n){ce.lastIndex=0;var r=ce.exec(t.slice(n));return r?(e.W=+r[0],n+r[0].length):-1}function d3_time_parseFullYear(e,t,n){ce.lastIndex=0;var r=ce.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function d3_time_parseYear(e,t,n){ce.lastIndex=0;var r=ce.exec(t.slice(n,n+2));return r?(e.y=d3_time_expandYear(+r[0]),n+r[0].length):-1}function d3_time_parseZone(e,t,n){return/^[+-]\d{4}$/.test(t=t.slice(n,n+5))?(e.Z=-t,n+5):-1}function d3_time_expandYear(e){return e+(e>68?1900:2e3)}function d3_time_parseMonthNumber(e,t,n){ce.lastIndex=0;var r=ce.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function d3_time_parseDay(e,t,n){ce.lastIndex=0;var r=ce.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function d3_time_parseDayOfYear(e,t,n){ce.lastIndex=0;var r=ce.exec(t.slice(n,n+3));return r?(e.j=+r[0],n+r[0].length):-1}function d3_time_parseHour24(e,t,n){ce.lastIndex=0;var r=ce.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function d3_time_parseMinutes(e,t,n){ce.lastIndex=0;var r=ce.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function d3_time_parseSeconds(e,t,n){ce.lastIndex=0;var r=ce.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function d3_time_parseMilliseconds(e,t,n){ce.lastIndex=0;var r=ce.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function d3_time_zone(e){var t=e.getTimezoneOffset(),n=t>0?"-":"+",r=ne(t)/60|0,a=ne(t)%60;return n+d3_time_formatPad(r,"0",2)+d3_time_formatPad(a,"0",2)}function d3_time_parseLiteralPercent(e,t,n){de.lastIndex=0;var r=de.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function d3_time_formatMulti(e){for(var t=e.length,n=-1;++n<t;)e[n][0]=this(e[n][0]);return function(t){for(var n=0,r=e[n];!r[1](t);)r=e[++n];return r[0](t)}}function d3_scale_bilinear(e,t,n,r){var a=n(e[0],e[1]),o=r(t[0],t[1]);return function(e){return o(a(e))}}function d3_scale_nice(e,t){var n,r=0,a=e.length-1,o=e[r],i=e[a];return o>i&&(n=r,r=a,a=n,n=o,o=i,i=n),e[r]=t.floor(o),e[a]=t.ceil(i),e}function d3_scale_niceStep(e){return e?{floor:function(t){return Math.floor(t/e)*e},ceil:function(t){return Math.ceil(t/e)*e}}:fe}function d3_bisector(e){return{left:function(t,n,r,a){for(arguments.length<3&&(r=0),arguments.length<4&&(a=t.length);a>r;){var o=r+a>>>1;e(t[o],n)<0?r=o+1:a=o}return r},right:function(t,n,r,a){for(arguments.length<3&&(r=0),arguments.length<4&&(a=t.length);a>r;){var o=r+a>>>1;e(t[o],n)>0?a=o:r=o+1}return r}}}function d3_scale_polylinear(t,n,r,a){var o=[],i=[],s=0,l=Math.min(t.length,n.length)-1;for(t[l]<t[0]&&(t=t.slice().reverse(),n=n.slice().reverse());++s<=l;)o.push(r(t[s-1],t[s])),i.push(a(n[s-1],n[s]));return function(n){var r=e.bisect(t,n,1,l)-1;return i[r](o[r](n))}}function d3_scaleExtent(e){var t=e[0],n=e[e.length-1];return n>t?[t,n]:[n,t]}function d3_scale_linear(e,t,n,r){function rescale(){var i=Math.min(e.length,t.length)>2?d3_scale_polylinear:d3_scale_bilinear,s=r?d3_uninterpolateClamp:d3_uninterpolateNumber;return a=i(e,t,s,n),o=i(t,e,s,d3_interpolate),scale}function scale(e){return a(e)}var a,o;return scale.invert=function(e){return o(e)},scale.domain=function(t){return arguments.length?(e=t.map(Number),rescale()):e},scale.range=function(e){return arguments.length?(t=e,rescale()):t},scale.rangeRound=function(e){return scale.range(e).interpolate(d3_interpolateRound)},scale.clamp=function(e){return arguments.length?(r=e,rescale()):r},scale.interpolate=function(e){return arguments.length?(n=e,rescale()):n},scale.ticks=function(t){return d3_scale_linearTicks(e,t)},scale.tickFormat=function(t,n){return d3_scale_linearTickFormat(e,t,n)},scale.nice=function(t){return d3_scale_linearNice(e,t),rescale()},scale.copy=function(){return d3_scale_linear(e,t,n,r)},rescale()}function d3_scale_linearNice(e,t){return d3_scale_nice(e,d3_scale_niceStep(d3_scale_linearTickRange(e,t)[2]))}function d3_scale_linearTickRange(e,t){null==t&&(t=10);var n=d3_scaleExtent(e),r=n[1]-n[0],a=Math.pow(10,Math.floor(Math.log(r/t)/Math.LN10)),o=t/r*a;return.15>=o?a*=10:.35>=o?a*=5:.75>=o&&(a*=2),n[0]=Math.ceil(n[0]/a)*a,n[1]=Math.floor(n[1]/a)*a+.5*a,n[2]=a,n}function d3_scale_linearTicks(t,n){return e.range.apply(e,d3_scale_linearTickRange(t,n))}function d3_scale_linearTickFormat(t,n,r){var a=d3_scale_linearTickRange(t,n);if(r){var o=ae.exec(r);if(o.shift(),"s"===o[8]){var i=e.formatPrefix(Math.max(ne(a[0]),ne(a[1])));return o[7]||(o[7]="."+d3_scale_linearPrecision(i.scale(a[2]))),o[8]="f",r=e.format(o.join("")),function(e){return r(i.scale(e))+i.symbol}}o[7]||(o[7]="."+d3_scale_linearFormatPrecision(o[8],a)),r=o.join("")}else r=",."+d3_scale_linearPrecision(a[2])+"f";return e.format(r)}function d3_scale_linearPrecision(e){return-Math.floor(Math.log(e)/Math.LN10+.01)}function d3_scale_linearFormatPrecision(e,t){var n=d3_scale_linearPrecision(t[2]);return e in _e?Math.abs(n-d3_scale_linearPrecision(Math.max(ne(t[0]),ne(t[1]))))+ +("e"!==e):n-2*("%"===e)}function d3_event_dragSuppress(t){var n=".dragsuppress-"+ ++me,r="click"+n,a=e.select(d3_window(t)).on("touchmove"+n,d3_eventPreventDefault).on("dragstart"+n,d3_eventPreventDefault).on("selectstart"+n,d3_eventPreventDefault);if(null==ge&&(ge="onselectstart"in t?!1:d3_vendorSymbol(t.style,"userSelect")),ge){var o=d3_documentElement(t).style,i=o[ge];o[ge]="none"}return function(e){if(a.on(n,null),ge&&(o[ge]=i),e){var t=function(){a.on(r,null)};a.on(r,function(){d3_eventPreventDefault(),t()},!0),setTimeout(t,0)}}}function d3_behavior_dragTouchId(){return e.event.changedTouches[0].identifier}function d3_layout_hierarchyRebind(t,n){return e.rebind(t,n,"sort","children","value"),t.nodes=t,t.links=d3_layout_hierarchyLinks,t}function d3_layout_hierarchyVisitBefore(e,t){for(var n=[e];null!=(e=n.pop());)if(t(e),(a=e.children)&&(r=a.length))for(var r,a;--r>=0;)n.push(a[r])}function d3_layout_hierarchyVisitAfter(e,t){for(var n=[e],r=[];null!=(e=n.pop());)if(r.push(e),(o=e.children)&&(a=o.length))for(var a,o,i=-1;++i<a;)n.push(o[i]);for(;null!=(e=r.pop());)t(e)}function d3_layout_hierarchyChildren(e){return e.children}function d3_layout_hierarchyValue(e){return e.value}function d3_layout_hierarchySort(e,t){return t.value-e.value}function d3_layout_hierarchyLinks(t){return e.merge(t.map(function(e){return(e.children||[]).map(function(t){return{source:e,target:t}})}))}function d3_layout_treeSeparation(e,t){return e.parent==t.parent?1:2}function d3_layout_treeLeft(e){var t=e.children;return t.length?t[0]:e.t}function d3_layout_treeRight(e){var t,n=e.children;return(t=n.length)?n[t-1]:e.t}function d3_layout_treeMove(e,t,n){var r=n/(t.i-e.i);t.c-=r,t.s+=n,e.c+=r,t.z+=n,t.m+=n}function d3_layout_treeShift(e){for(var t,n=0,r=0,a=e.children,o=a.length;--o>=0;)t=a[o],t.z+=n,t.m+=n,n+=t.s+(r+=t.c)}function d3_layout_treeAncestor(e,t,n){return e.a.parent===t.parent?e.a:n}function d3_functor(e){return"function"==typeof e?e:function(){return e}}function d3_source(e){return e.source}function d3_target(e){return e.target}function d3_svg_diagonalProjection(e){return[e.x,e.y]}var e={version:"3.5.5"},n=[].slice,r=function(e){return n.call(e)},a=this.document;if(a)try{r(a.documentElement.childNodes)[0].nodeType}catch(o){r=function(e){for(var t=e.length,n=new Array(t);t--;)n[t]=e[t];return n}}if(Date.now||(Date.now=function(){return+new Date}),a)try{a.createElement("DIV").style.setProperty("opacity",0,"")}catch(i){var s=this.Element.prototype,l=s.setAttribute,u=s.setAttributeNS,c=this.CSSStyleDeclaration.prototype,d=c.setProperty;s.setAttribute=function(e,t){l.call(this,e,t+"")},s.setAttributeNS=function(e,t,n){u.call(this,e,t,n+"")},c.setProperty=function(e,t,n){d.call(this,e,t+"",n)}}var h={}.__proto__?function(e,t){e.__proto__=t}:function(e,t){for(var n in t)e[n]=t[n]},f=["webkit","ms","moz","Moz","o","O"],p=function(e,t){return t.querySelector(e)},g=function(e,t){return t.querySelectorAll(e)},_=function(e,t){var n=e.matches||e[d3_vendorSymbol(e,"matchesSelector")];return(_=function(e,t){return n.call(e,t)})(e,t)};"function"==typeof Sizzle&&(p=function(e,t){return Sizzle(e,t)[0]||null},g=Sizzle,_=Sizzle.matchesSelector),e.selection=function(){return e.select(a.documentElement)};var m=e.selection.prototype=[];m.select=function(e){var t,n,r,a,o=[];e=d3_selection_selector(e);for(var i=-1,s=this.length;++i<s;){o.push(t=[]),t.parentNode=(r=this[i]).parentNode;for(var l=-1,u=r.length;++l<u;)(a=r[l])?(t.push(n=e.call(a,a.__data__,l,i)),n&&"__data__"in a&&(n.__data__=a.__data__)):t.push(null)}return d3_selection(o)},m.selectAll=function(e){var t,n,a=[];e=d3_selection_selectorAll(e);for(var o=-1,i=this.length;++o<i;)for(var s=this[o],l=-1,u=s.length;++l<u;)(n=s[l])&&(a.push(t=r(e.call(n,n.__data__,l,o))),t.parentNode=n);return d3_selection(a)};var v={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};e.ns={prefix:v,qualify:function(e){var t=e.indexOf(":"),n=e;return t>=0&&(n=e.slice(0,t),e=e.slice(t+1)),v.hasOwnProperty(n)?{space:v[n],local:e}:e}},m.attr=function(t,n){if(arguments.length<2){if("string"==typeof t){var r=this.node();return t=e.ns.qualify(t),t.local?r.getAttributeNS(t.space,t.local):r.getAttribute(t)}for(n in t)this.each(d3_selection_attr(n,t[n]));return this}return this.each(d3_selection_attr(t,n))},e.requote=function(e){return e.replace(y,"\\$&")};var y=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g;m.classed=function(e,t){if(arguments.length<2){if("string"==typeof e){var n=this.node(),r=(e=d3_selection_classes(e)).length,a=-1;if(t=n.classList){for(;++a<r;)if(!t.contains(e[a]))return!1}else for(t=n.getAttribute("class");++a<r;)if(!d3_selection_classedRe(e[a]).test(t))return!1;return!0}for(t in e)this.each(d3_selection_classed(t,e[t]));return this}return this.each(d3_selection_classed(e,t))},m.style=function(e,t,n){var r=arguments.length;if(3>r){if("string"!=typeof e){2>r&&(t="");for(n in e)this.each(d3_selection_style(n,e[n],t));return this}if(2>r){var a=this.node();return d3_window(a).getComputedStyle(a,null).getPropertyValue(e)}n=""}return this.each(d3_selection_style(e,t,n))},m.property=function(e,t){if(arguments.length<2){if("string"==typeof e)return this.node()[e];for(t in e)this.each(d3_selection_property(t,e[t]));return this}return this.each(d3_selection_property(e,t))},m.text=function(e){return arguments.length?this.each("function"==typeof e?function(){var t=e.apply(this,arguments);this.textContent=null==t?"":t}:null==e?function(){this.textContent=""}:function(){this.textContent=e}):this.node().textContent},m.html=function(e){return arguments.length?this.each("function"==typeof e?function(){var t=e.apply(this,arguments);this.innerHTML=null==t?"":t}:null==e?function(){this.innerHTML=""}:function(){this.innerHTML=e}):this.node().innerHTML},m.append=function(e){return e=d3_selection_creator(e),this.select(function(){return this.appendChild(e.apply(this,arguments))})},m.insert=function(e,t){return e=d3_selection_creator(e),t=d3_selection_selector(t),this.select(function(){return this.insertBefore(e.apply(this,arguments),t.apply(this,arguments)||null)})},m.remove=function(){return this.each(d3_selectionRemove)},e.map=function(e,t){var n=new d3_Map;if(e instanceof d3_Map)e.forEach(function(e,t){n.set(e,t)});else if(Array.isArray(e)){var r,a=-1,o=e.length;if(1===arguments.length)for(;++a<o;)n.set(a,e[a]);else for(;++a<o;)n.set(t.call(e,r=e[a],a),r)}else for(var i in e)n.set(i,e[i]);return n};var b="__proto__",x="\x00";d3_class(d3_Map,{has:d3_map_has,get:function(e){return this._[d3_map_escape(e)]},set:function(e,t){return this._[d3_map_escape(e)]=t},remove:d3_map_remove,keys:d3_map_keys,values:function(){var e=[];for(var t in this._)e.push(this._[t]);return e},entries:function(){var e=[];for(var t in this._)e.push({key:d3_map_unescape(t),value:this._[t]});return e},size:d3_map_size,empty:d3_map_empty,forEach:function(e){for(var t in this._)e.call(this,d3_map_unescape(t),this._[t])}}),e.set=function(e){var t=new d3_Set;if(e)for(var n=0,r=e.length;r>n;++n)t.add(e[n]);return t},d3_class(d3_Set,{has:d3_map_has,add:function(e){return this._[d3_map_escape(e+="")]=!0,e},remove:d3_map_remove,values:d3_map_keys,size:d3_map_size,empty:d3_map_empty,forEach:function(e){for(var t in this._)e.call(this,d3_map_unescape(t))}}),m.data=function(e,t){function bind(e,n){var r,a,o,u=e.length,c=n.length,d=Math.min(u,c),h=new Array(c),f=new Array(c),p=new Array(u);if(t){var g,_=new d3_Map,m=new Array(u);for(r=-1;++r<u;)_.has(g=t.call(a=e[r],a.__data__,r))?p[r]=a:_.set(g,a),m[r]=g;for(r=-1;++r<c;)(a=_.get(g=t.call(n,o=n[r],r)))?a!==!0&&(h[r]=a,a.__data__=o):f[r]=d3_selection_dataNode(o),_.set(g,!0);for(r=-1;++r<u;)_.get(m[r])!==!0&&(p[r]=e[r])}else{for(r=-1;++r<d;)a=e[r],o=n[r],a?(a.__data__=o,h[r]=a):f[r]=d3_selection_dataNode(o);for(;c>r;++r)f[r]=d3_selection_dataNode(n[r]);for(;u>r;++r)p[r]=e[r]}f.update=h,f.parentNode=h.parentNode=p.parentNode=e.parentNode,i.push(f),s.push(h),l.push(p)}var n,r,a=-1,o=this.length;if(!arguments.length){for(e=new Array(o=(n=this[0]).length);++a<o;)(r=n[a])&&(e[a]=r.__data__);return e}var i=d3_selection_enter([]),s=d3_selection([]),l=d3_selection([]);if("function"==typeof e)for(;++a<o;)bind(n=this[a],e.call(n,n.parentNode.__data__,a));else for(;++a<o;)bind(n=this[a],e);return s.enter=function(){return i},s.exit=function(){return l},s},m.datum=function(e){return arguments.length?this.property("__data__",e):this.property("__data__")},m.filter=function(e){var t,n,r,a=[];"function"!=typeof e&&(e=d3_selection_filter(e));for(var o=0,i=this.length;i>o;o++){a.push(t=[]),t.parentNode=(n=this[o]).parentNode;for(var s=0,l=n.length;l>s;s++)(r=n[s])&&e.call(r,r.__data__,s,o)&&t.push(r)}return d3_selection(a)},m.order=function(){for(var e=-1,t=this.length;++e<t;)for(var n,r=this[e],a=r.length-1,o=r[a];--a>=0;)(n=r[a])&&(o&&o!==n.nextSibling&&o.parentNode.insertBefore(n,o),o=n);return this},e.ascending=d3_ascending,m.sort=function(e){e=d3_selection_sortComparator.apply(this,arguments);for(var t=-1,n=this.length;++t<n;)this[t].sort(e);return this.order()},e.dispatch=function(){for(var e=new d3_dispatch,t=-1,n=arguments.length;++t<n;)e[arguments[t]]=d3_dispatch_event(e);return e},d3_dispatch.prototype.on=function(e,t){var n=e.indexOf("."),r="";if(n>=0&&(r=e.slice(n+1),e=e.slice(0,n)),e)return arguments.length<2?this[e].on(r):this[e].on(r,t);if(2===arguments.length){if(null==t)for(e in this)this.hasOwnProperty(e)&&this[e].on(r,null);return this}},e.event=null,m.on=function(e,t,n){var r=arguments.length;if(3>r){if("string"!=typeof e){2>r&&(t=!1);for(n in e)this.each(d3_selection_on(n,e[n],t));return this}if(2>r)return(r=this.node()["__on"+e])&&r._;n=!1}return this.each(d3_selection_on(e,t,n))};var w=e.map({mouseenter:"mouseover",mouseleave:"mouseout"});a&&w.forEach(function(e){"on"+e in a&&w.remove(e)}),m.each=function(e){return d3_selection_each(this,function(t,n,r){e.call(t,t.__data__,n,r)})},m.call=function(e){var t=r(arguments);return e.apply(t[0]=this,t),this},m.empty=function(){return!this.node()},m.node=function(){for(var e=0,t=this.length;t>e;e++)for(var n=this[e],r=0,a=n.length;a>r;r++){var o=n[r];if(o)return o}return null},m.size=function(){var e=0;return d3_selection_each(this,function(){++e}),e};var T=[];e.selection.enter=d3_selection_enter,e.selection.enter.prototype=T,T.append=m.append,T.empty=m.empty,T.node=m.node,T.call=m.call,T.size=m.size,T.select=function(e){for(var t,n,r,a,o,i=[],s=-1,l=this.length;++s<l;){r=(a=this[s]).update,i.push(t=[]),t.parentNode=a.parentNode;for(var u=-1,c=a.length;++u<c;)(o=a[u])?(t.push(r[u]=n=e.call(a.parentNode,o.__data__,u,s)),n.__data__=o.__data__):t.push(null)}return d3_selection(i)},T.insert=function(e,t){return arguments.length<2&&(t=d3_selection_enterInsertBefore(this)),m.insert.call(this,e,t)},e.select=function(e){var t;return"string"==typeof e?(t=[p(e,a)],t.parentNode=a.documentElement):(t=[e],t.parentNode=d3_documentElement(e)),d3_selection([t])},e.selectAll=function(e){var t;return"string"==typeof e?(t=r(g(e,a)),t.parentNode=a.documentElement):(t=e,t.parentNode=null),d3_selection([t])};var S,C,k,N,I,F=this[d3_vendorSymbol(this,"requestAnimationFrame")]||function(e){setTimeout(e,17)};e.timer=function(e,t,n){var r=arguments.length;2>r&&(t=0),3>r&&(n=Date.now());var a=n+t,o={c:e,t:a,f:!1,n:null};C?C.n=o:S=o,C=o,k||(N=clearTimeout(N),k=1,F(d3_timer_step))},e.timer.flush=function(){d3_timer_mark(),d3_timer_sweep()},m.transition=function(e){for(var t,n,r=A||++M,a=d3_transitionNamespace(e),o=[],i=D||{time:Date.now(),ease:d3_ease_cubicInOut,delay:0,duration:250},s=-1,l=this.length;++s<l;){o.push(t=[]);for(var u=this[s],c=-1,d=u.length;++c<d;)(n=u[c])&&d3_transitionNode(n,c,a,r,i),t.push(n)}return d3_transition(o,a,r)},m.interrupt=function(e){return this.each(null==e?O:d3_selection_interruptNS(d3_transitionNamespace(e)))};var A,D,O=d3_selection_interruptNS(d3_transitionNamespace()),R=[],M=0;R.call=m.call,R.empty=m.empty,R.node=m.node,R.size=m.size,e.transition=function(t,n){return t&&t.transition?A?t.transition(n):t:e.selection().transition(t)},e.transition.prototype=R,R.select=function(e){var t,n,r,a=this.id,o=this.namespace,i=[];e=d3_selection_selector(e);for(var s=-1,l=this.length;++s<l;){i.push(t=[]);for(var u=this[s],c=-1,d=u.length;++c<d;)(r=u[c])&&(n=e.call(r,r.__data__,c,s))?("__data__"in r&&(n.__data__=r.__data__),d3_transitionNode(n,c,o,a,r[o][a]),t.push(n)):t.push(null)}return d3_transition(i,o,a)},R.selectAll=function(e){var t,n,r,a,o,i=this.id,s=this.namespace,l=[];e=d3_selection_selectorAll(e);for(var u=-1,c=this.length;++u<c;)for(var d=this[u],h=-1,f=d.length;++h<f;)if(r=d[h]){o=r[s][i],n=e.call(r,r.__data__,h,u),l.push(t=[]);for(var p=-1,g=n.length;++p<g;)(a=n[p])&&d3_transitionNode(a,p,s,i,o),t.push(a)}return d3_transition(l,s,i)},R.filter=function(e){var t,n,r,a=[];"function"!=typeof e&&(e=d3_selection_filter(e));for(var o=0,i=this.length;i>o;o++){a.push(t=[]);for(var n=this[o],s=0,l=n.length;l>s;s++)(r=n[s])&&e.call(r,r.__data__,s,o)&&t.push(r)}return d3_transition(a,this.namespace,this.id)},e.color=d3_color,d3_color.prototype.toString=function(){return this.rgb()+""},e.hsl=d3_hsl;var E=d3_hsl.prototype=new d3_color;E.brighter=function(e){return e=Math.pow(.7,arguments.length?e:1),new d3_hsl(this.h,this.s,this.l/e)},E.darker=function(e){return e=Math.pow(.7,arguments.length?e:1),new d3_hsl(this.h,this.s,e*this.l)},E.rgb=function(){return d3_hsl_rgb(this.h,this.s,this.l)};var P=Math.PI,L=2*P,z=P/2,j=P/180,W=180/P;e.hcl=d3_hcl;var U=d3_hcl.prototype=new d3_color;U.brighter=function(e){return new d3_hcl(this.h,this.c,Math.min(100,this.l+q*(arguments.length?e:1)))},U.darker=function(e){return new d3_hcl(this.h,this.c,Math.max(0,this.l-q*(arguments.length?e:1)))},U.rgb=function(){return d3_hcl_lab(this.h,this.c,this.l).rgb()},e.lab=d3_lab;var q=18,B=.95047,K=1,H=1.08883,V=d3_lab.prototype=new d3_color;V.brighter=function(e){return new d3_lab(Math.min(100,this.l+q*(arguments.length?e:1)),this.a,this.b)},V.darker=function(e){return new d3_lab(Math.max(0,this.l-q*(arguments.length?e:1)),this.a,this.b)},V.rgb=function(){return d3_lab_rgb(this.l,this.a,this.b)},e.rgb=d3_rgb;var Y=d3_rgb.prototype=new d3_color;Y.brighter=function(e){e=Math.pow(.7,arguments.length?e:1);var t=this.r,n=this.g,r=this.b,a=30;return t||n||r?(t&&a>t&&(t=a),n&&a>n&&(n=a),r&&a>r&&(r=a),new d3_rgb(Math.min(255,t/e),Math.min(255,n/e),Math.min(255,r/e))):new d3_rgb(a,a,a)},Y.darker=function(e){return e=Math.pow(.7,arguments.length?e:1),new d3_rgb(e*this.r,e*this.g,e*this.b)},Y.hsl=function(){return d3_rgb_hsl(this.r,this.g,this.b)},Y.toString=function(){return"#"+d3_rgb_hex(this.r)+d3_rgb_hex(this.g)+d3_rgb_hex(this.b)};var Z=e.map({aliceblue:15792383,antiquewhite:16444375,
aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});Z.forEach(function(e,t){Z.set(e,d3_rgbNumber(t))}),e.interpolateRgb=d3_interpolateRgb,e.interpolateObject=d3_interpolateObject,e.interpolateArray=d3_interpolateArray,e.interpolateNumber=d3_interpolateNumber,e.interpolateString=d3_interpolateString;var G=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,$=new RegExp(G.source,"g");e.interpolate=d3_interpolate,e.interpolators=[function(e,t){var n=typeof t;return("string"===n?Z.has(t)||/^(#|rgb\(|hsl\()/.test(t)?d3_interpolateRgb:d3_interpolateString:t instanceof d3_color?d3_interpolateRgb:Array.isArray(t)?d3_interpolateArray:"object"===n&&isNaN(t)?d3_interpolateObject:d3_interpolateNumber)(e,t)}],e.transform=function(t){var n=a.createElementNS(e.ns.prefix.svg,"g");return(e.transform=function(e){if(null!=e){n.setAttribute("transform",e);var t=n.transform.baseVal.consolidate()}return new d3_transform(t?t.matrix:X)})(t)},d3_transform.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var X={a:1,b:0,c:0,d:1,e:0,f:0};e.interpolateTransform=d3_interpolateTransform,R.tween=function(e,t){var n=this.id,r=this.namespace;return arguments.length<2?this.node()[r][n].tween.get(e):d3_selection_each(this,null==t?function(t){t[r][n].tween.remove(e)}:function(a){a[r][n].tween.set(e,t)})},R.attr=function(t,n){function attrNull(){this.removeAttribute(a)}function attrNullNS(){this.removeAttributeNS(a.space,a.local)}function attrTween(e){return null==e?attrNull:(e+="",function(){var t,n=this.getAttribute(a);return n!==e&&(t=r(n,e),function(e){this.setAttribute(a,t(e))})})}function attrTweenNS(e){return null==e?attrNullNS:(e+="",function(){var t,n=this.getAttributeNS(a.space,a.local);return n!==e&&(t=r(n,e),function(e){this.setAttributeNS(a.space,a.local,t(e))})})}if(arguments.length<2){for(n in t)this.attr(n,t[n]);return this}var r="transform"==t?d3_interpolateTransform:d3_interpolate,a=e.ns.qualify(t);return d3_transition_tween(this,"attr."+t,n,a.local?attrTweenNS:attrTween)},R.attrTween=function(t,n){function attrTween(e,t){var a=n.call(this,e,t,this.getAttribute(r));return a&&function(e){this.setAttribute(r,a(e))}}function attrTweenNS(e,t){var a=n.call(this,e,t,this.getAttributeNS(r.space,r.local));return a&&function(e){this.setAttributeNS(r.space,r.local,a(e))}}var r=e.ns.qualify(t);return this.tween("attr."+t,r.local?attrTweenNS:attrTween)},R.style=function(e,t,n){function styleNull(){this.style.removeProperty(e)}function styleString(t){return null==t?styleNull:(t+="",function(){var r,a=d3_window(this).getComputedStyle(this,null).getPropertyValue(e);return a!==t&&(r=d3_interpolate(a,t),function(t){this.style.setProperty(e,r(t),n)})})}var r=arguments.length;if(3>r){if("string"!=typeof e){2>r&&(t="");for(n in e)this.style(n,e[n],t);return this}n=""}return d3_transition_tween(this,"style."+e,t,styleString)},R.styleTween=function(e,t,n){function styleTween(r,a){var o=t.call(this,r,a,d3_window(this).getComputedStyle(this,null).getPropertyValue(e));return o&&function(t){this.style.setProperty(e,o(t),n)}}return arguments.length<3&&(n=""),this.tween("style."+e,styleTween)},R.text=function(e){return d3_transition_tween(this,"text",e,d3_transition_text)},R.remove=function(){var e=this.namespace;return this.each("end.transition",function(){var t;this[e].count<2&&(t=this.parentNode)&&t.removeChild(this)})};var J=function(){return d3_identity},Q=e.map({linear:J,poly:d3_ease_poly,quad:function(){return d3_ease_quad},cubic:function(){return d3_ease_cubic},sin:function(){return d3_ease_sin},exp:function(){return d3_ease_exp},circle:function(){return d3_ease_circle},elastic:d3_ease_elastic,back:d3_ease_back,bounce:function(){return d3_ease_bounce}}),ee=e.map({"in":d3_identity,out:d3_ease_reverse,"in-out":d3_ease_reflect,"out-in":function(e){return d3_ease_reflect(d3_ease_reverse(e))}});e.ease=function(e){var t=e.indexOf("-"),r=t>=0?e.slice(0,t):e,a=t>=0?e.slice(t+1):"in";return r=Q.get(r)||J,a=ee.get(a)||d3_identity,d3_ease_clamp(a(r.apply(null,n.call(arguments,1))))},R.ease=function(t){var n=this.id,r=this.namespace;return arguments.length<1?this.node()[r][n].ease:("function"!=typeof t&&(t=e.ease.apply(e,arguments)),d3_selection_each(this,function(e){e[r][n].ease=t}))},R.delay=function(e){var t=this.id,n=this.namespace;return arguments.length<1?this.node()[n][t].delay:d3_selection_each(this,"function"==typeof e?function(r,a,o){r[n][t].delay=+e.call(r,r.__data__,a,o)}:(e=+e,function(r){r[n][t].delay=e}))},R.duration=function(e){var t=this.id,n=this.namespace;return arguments.length<1?this.node()[n][t].duration:d3_selection_each(this,"function"==typeof e?function(r,a,o){r[n][t].duration=Math.max(1,e.call(r,r.__data__,a,o))}:(e=Math.max(1,e),function(r){r[n][t].duration=e}))},R.each=function(t,n){var r=this.id,a=this.namespace;if(arguments.length<2){var o=D,i=A;try{A=r,d3_selection_each(this,function(e,n,o){D=e[a][r],t.call(e,e.__data__,n,o)})}finally{D=o,A=i}}else d3_selection_each(this,function(o){var i=o[a][r];(i.event||(i.event=e.dispatch("start","end","interrupt"))).on(t,n)});return this},R.transition=function(){for(var e,t,n,r,a=this.id,o=++M,i=this.namespace,s=[],l=0,u=this.length;u>l;l++){s.push(e=[]);for(var t=this[l],c=0,d=t.length;d>c;c++)(n=t[c])&&(r=n[i][a],d3_transitionNode(n,c,i,o,{time:r.time,ease:r.ease,delay:r.delay+r.duration,duration:r.duration})),e.push(n)}return d3_transition(s,i,o)},e.mouse=function(e){return d3_mousePoint(e,d3_eventSource())};var te=this.navigator&&/WebKit/.test(this.navigator.userAgent)?-1:0,ne=Math.abs;e.range=function(e,t,n){if(arguments.length<3&&(n=1,arguments.length<2&&(t=e,e=0)),(t-e)/n===1/0)throw new Error("infinite range");var r,a=[],o=d3_range_integerScale(ne(n)),i=-1;if(e*=o,t*=o,n*=o,0>n)for(;(r=e+n*++i)>t;)a.push(r/o);else for(;(r=e+n*++i)<t;)a.push(r/o);return a},e.rebind=function(e,t){for(var n,r=1,a=arguments.length;++r<a;)e[n=arguments[r]]=d3_rebind(e,t,t[n]);return e},e.interpolateRound=d3_interpolateRound,e.round=function(e,t){return t?Math.round(e*(t=Math.pow(10,t)))/t:Math.round(e)};var re=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"].map(d3_formatPrefix);e.formatPrefix=function(t,n){var r=0;return t&&(0>t&&(t*=-1),n&&(t=e.round(t,d3_format_precision(t,n))),r=1+Math.floor(1e-12+Math.log(t)/Math.LN10),r=Math.max(-24,Math.min(24,3*Math.floor((r-1)/3)))),re[8+r/3]};var ae=/(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i,oe=e.map({b:function(e){return e.toString(2)},c:function(e){return String.fromCharCode(e)},o:function(e){return e.toString(8)},x:function(e){return e.toString(16)},X:function(e){return e.toString(16).toUpperCase()},g:function(e,t){return e.toPrecision(t)},e:function(e,t){return e.toExponential(t)},f:function(e,t){return e.toFixed(t)},r:function(t,n){return(t=e.round(t,d3_format_precision(t,n))).toFixed(Math.max(0,Math.min(20,d3_format_precision(t*(1+1e-15),n))))}}),ie=e.time={},se=Date;d3_date_utc.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){le.setUTCDate.apply(this._,arguments)},setDay:function(){le.setUTCDay.apply(this._,arguments)},setFullYear:function(){le.setUTCFullYear.apply(this._,arguments)},setHours:function(){le.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){le.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){le.setUTCMinutes.apply(this._,arguments)},setMonth:function(){le.setUTCMonth.apply(this._,arguments)},setSeconds:function(){le.setUTCSeconds.apply(this._,arguments)},setTime:function(){le.setTime.apply(this._,arguments)}};var le=Date.prototype;ie.year=d3_time_interval(function(e){return e=ie.day(e),e.setMonth(0,1),e},function(e,t){e.setFullYear(e.getFullYear()+t)},function(e){return e.getFullYear()}),ie.years=ie.year.range,ie.years.utc=ie.year.utc.range,ie.day=d3_time_interval(function(e){var t=new se(2e3,0);return t.setFullYear(e.getFullYear(),e.getMonth(),e.getDate()),t},function(e,t){e.setDate(e.getDate()+t)},function(e){return e.getDate()-1}),ie.days=ie.day.range,ie.days.utc=ie.day.utc.range,ie.dayOfYear=function(e){var t=ie.year(e);return Math.floor((e-t-6e4*(e.getTimezoneOffset()-t.getTimezoneOffset()))/864e5)},["sunday","monday","tuesday","wednesday","thursday","friday","saturday"].forEach(function(e,t){t=7-t;var n=ie[e]=d3_time_interval(function(e){return(e=ie.day(e)).setDate(e.getDate()-(e.getDay()+t)%7),e},function(e,t){e.setDate(e.getDate()+7*Math.floor(t))},function(e){var n=ie.year(e).getDay();return Math.floor((ie.dayOfYear(e)+(n+t)%7)/7)-(n!==t)});ie[e+"s"]=n.range,ie[e+"s"].utc=n.utc.range,ie[e+"OfYear"]=function(e){var n=ie.year(e).getDay();return Math.floor((ie.dayOfYear(e)+(n+t)%7)/7)}}),ie.week=ie.sunday,ie.weeks=ie.sunday.range,ie.weeks.utc=ie.sunday.utc.range,ie.weekOfYear=ie.sundayOfYear;var ue={"-":"",_:" ",0:"0"},ce=/^\s*\d+/,de=/^%/;e.locale=function(e){return{numberFormat:d3_locale_numberFormat(e),timeFormat:d3_locale_timeFormat(e)}};var he=e.locale({decimal:".",thousands:",",grouping:[3],currency:["$",""],dateTime:"%a %b %e %X %Y",date:"%m/%d/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});e.format=he.numberFormat;var fe={floor:d3_identity,ceil:d3_identity},pe=d3_bisector(d3_ascending);e.bisectLeft=pe.left,e.bisect=e.bisectRight=pe.right,e.bisector=function(e){return d3_bisector(1===e.length?function(t,n){return d3_ascending(e(t),n)}:e)},e.scale={},e.scale.linear=function(){return d3_scale_linear([0,1],[0,1],d3_interpolate,!1)};var ge,_e={s:1,g:1,p:1,r:1,e:1},me=0;e.touches=function(e,t){return arguments.length<2&&(t=d3_eventSource().touches),t?r(t).map(function(t){var n=d3_mousePoint(e,t);return n.identifier=t.identifier,n}):[]};var ve=Math.SQRT2,ye=2,be=4;e.interpolateZoom=function(e,t){function interpolate(e){var t=e*m;if(_){var o=d3_cosh(p),i=a/(ye*d)*(o*d3_tanh(ve*t+p)-d3_sinh(p));return[n+i*l,r+i*u,a*o/d3_cosh(ve*t+p)]}return[n+e*l,r+e*u,a*Math.exp(ve*t)]}var n=e[0],r=e[1],a=e[2],o=t[0],i=t[1],s=t[2],l=o-n,u=i-r,c=l*l+u*u,d=Math.sqrt(c),h=(s*s-a*a+be*c)/(2*a*ye*d),f=(s*s-a*a-be*c)/(2*s*ye*d),p=Math.log(Math.sqrt(h*h+1)-h),g=Math.log(Math.sqrt(f*f+1)-f),_=g-p,m=(_||Math.log(s/a))/ve;return interpolate.duration=1e3*m,interpolate},e.behavior={},e.behavior.zoom=function(){function zoom(e){e.on(_,mousedowned).on(we+".zoom",mousewheeled).on("dblclick.zoom",dblclicked).on(y,touchstarted)}function location(e){return[(e[0]-d.x)/d.k,(e[1]-d.y)/d.k]}function point(e){return[e[0]*d.k+d.x,e[1]*d.k+d.y]}function scaleTo(e){d.k=Math.max(f[0],Math.min(f[1],e))}function translateTo(e,t){t=point(t),d.x+=e[0]-t[0],d.y+=e[1]-t[1]}function zoomTo(t,r,a,o){t.__chart__={x:d.x,y:d.y,k:d.k},scaleTo(Math.pow(2,o)),translateTo(n=r,a),t=e.select(t),p>0&&(t=t.transition().duration(p)),t.call(zoom.event)}function rescale(){l&&l.domain(s.range().map(function(e){return(e-d.x)/d.k}).map(s.invert)),c&&c.domain(u.range().map(function(e){return(e-d.y)/d.k}).map(u.invert))}function zoomstarted(e){g++||e({type:"zoomstart"})}function zoomed(e){rescale(),e({type:"zoom",scale:d.k,translate:[d.x,d.y]})}function zoomended(e){--g||e({type:"zoomend"}),n=null}function mousedowned(){function moved(){a=1,translateTo(e.mouse(t),i),zoomed(r)}function ended(){o.on(m,null).on(v,null),s(a&&e.event.target===n),zoomended(r)}var t=this,n=e.event.target,r=b.of(t,arguments),a=0,o=e.select(d3_window(t)).on(m,moved).on(v,ended),i=location(e.mouse(t)),s=d3_event_dragSuppress(t);O.call(t),zoomstarted(r)}function touchstarted(){function relocate(){var r=e.touches(n);return t=d.k,r.forEach(function(e){e.identifier in a&&(a[e.identifier]=location(e))}),r}function started(){var t=e.event.target;e.select(t).on(l,moved).on(u,ended),c.push(t);for(var r=e.event.changedTouches,s=0,h=r.length;h>s;++s)a[r[s].identifier]=null;var f=relocate(),p=Date.now();if(1===f.length){if(500>p-i){var g=f[0];zoomTo(n,g,a[g.identifier],Math.floor(Math.log(d.k)/Math.LN2)+1),d3_eventPreventDefault()}i=p}else if(f.length>1){var g=f[0],_=f[1],m=g[0]-_[0],v=g[1]-_[1];o=m*m+v*v}}function moved(){var s,l,u,c,d=e.touches(n);O.call(n);for(var h=0,f=d.length;f>h;++h,c=null)if(u=d[h],c=a[u.identifier]){if(l)break;s=u,l=c}if(c){var p=(p=u[0]-s[0])*p+(p=u[1]-s[1])*p,g=o&&Math.sqrt(p/o);s=[(s[0]+u[0])/2,(s[1]+u[1])/2],l=[(l[0]+c[0])/2,(l[1]+c[1])/2],scaleTo(g*t)}i=null,translateTo(s,l),zoomed(r)}function ended(){if(e.event.touches.length){for(var t=e.event.changedTouches,n=0,o=t.length;o>n;++n)delete a[t[n].identifier];for(var i in a)return void relocate()}e.selectAll(c).on(s,null),h.on(_,mousedowned).on(y,touchstarted),f(),zoomended(r)}var t,n=this,r=b.of(n,arguments),a={},o=0,s=".zoom-"+e.event.changedTouches[0].identifier,l="touchmove"+s,u="touchend"+s,c=[],h=e.select(n),f=d3_event_dragSuppress(n);started(),zoomstarted(r),h.on(_,null).on(y,started)}function mousewheeled(){var a=b.of(this,arguments);o?clearTimeout(o):(t=location(n=r||e.mouse(this)),O.call(this),zoomstarted(a)),o=setTimeout(function(){o=null,zoomended(a)},50),d3_eventPreventDefault(),scaleTo(Math.pow(2,.002*xe())*d.k),translateTo(n,t),zoomed(a)}function dblclicked(){var t=e.mouse(this),n=Math.log(d.k)/Math.LN2;zoomTo(this,t,location(t),e.event.shiftKey?Math.ceil(n)-1:Math.floor(n)+1)}var t,n,r,o,i,s,l,u,c,d={x:0,y:0,k:1},h=[960,500],f=Te,p=250,g=0,_="mousedown.zoom",m="mousemove.zoom",v="mouseup.zoom",y="touchstart.zoom",b=d3_eventDispatch(zoom,"zoomstart","zoom","zoomend");return we||(we="onwheel"in a?(xe=function(){return-e.event.deltaY*(e.event.deltaMode?120:1)},"wheel"):"onmousewheel"in a?(xe=function(){return e.event.wheelDelta},"mousewheel"):(xe=function(){return-e.event.detail},"MozMousePixelScroll")),zoom.event=function(t){t.each(function(){var t=b.of(this,arguments),r=d;A?e.select(this).transition().each("start.zoom",function(){d=this.__chart__||{x:0,y:0,k:1},zoomstarted(t)}).tween("zoom:zoom",function(){var a=h[0],o=h[1],i=n?n[0]:a/2,s=n?n[1]:o/2,l=e.interpolateZoom([(i-d.x)/d.k,(s-d.y)/d.k,a/d.k],[(i-r.x)/r.k,(s-r.y)/r.k,a/r.k]);return function(e){var n=l(e),r=a/n[2];this.__chart__=d={x:i-n[0]*r,y:s-n[1]*r,k:r},zoomed(t)}}).each("interrupt.zoom",function(){zoomended(t)}).each("end.zoom",function(){zoomended(t)}):(this.__chart__=d,zoomstarted(t),zoomed(t),zoomended(t))})},zoom.translate=function(e){return arguments.length?(d={x:+e[0],y:+e[1],k:d.k},rescale(),zoom):[d.x,d.y]},zoom.scale=function(e){return arguments.length?(d={x:d.x,y:d.y,k:+e},rescale(),zoom):d.k},zoom.scaleExtent=function(e){return arguments.length?(f=null==e?Te:[+e[0],+e[1]],zoom):f},zoom.center=function(e){return arguments.length?(r=e&&[+e[0],+e[1]],zoom):r},zoom.size=function(e){return arguments.length?(h=e&&[+e[0],+e[1]],zoom):h},zoom.duration=function(e){return arguments.length?(p=+e,zoom):p},zoom.x=function(e){return arguments.length?(l=e,s=e.copy(),d={x:0,y:0,k:1},zoom):l},zoom.y=function(e){return arguments.length?(c=e,u=e.copy(),d={x:0,y:0,k:1},zoom):c},e.rebind(zoom,b,"on")};var xe,we,Te=[0,1/0];e.touch=function(e,t,n){if(arguments.length<3&&(n=t,t=d3_eventSource().changedTouches),t)for(var r,a=0,o=t.length;o>a;++a)if((r=t[a]).identifier===n)return d3_mousePoint(e,r)},e.behavior.drag=function(){function drag(){this.on("mousedown.drag",r).on("touchstart.drag",a)}function dragstart(r,a,o,i,s){return function(){function moved(){var e,t,n=a(d,p);n&&(e=n[0]-v[0],t=n[1]-v[1],f|=e|t,v=n,h({type:"drag",x:n[0]+l[0],y:n[1]+l[1],dx:e,dy:t}))}function ended(){a(d,p)&&(_.on(i+g,null).on(s+g,null),m(f&&e.event.target===c),h({type:"dragend"}))}var l,u=this,c=e.event.target,d=u.parentNode,h=t.of(u,arguments),f=0,p=r(),g=".drag"+(null==p?"":"-"+p),_=e.select(o(c)).on(i+g,moved).on(s+g,ended),m=d3_event_dragSuppress(c),v=a(d,p);n?(l=n.apply(u,arguments),l=[l.x-v[0],l.y-v[1]]):l=[0,0],h({type:"dragstart"})}}var t=d3_eventDispatch(drag,"drag","dragstart","dragend"),n=null,r=dragstart(d3_noop,e.mouse,d3_window,"mousemove","mouseup"),a=dragstart(d3_behavior_dragTouchId,e.touch,d3_identity,"touchmove","touchend");return drag.origin=function(e){return arguments.length?(n=e,drag):n},e.rebind(drag,t,"on")},e.layout={},e.merge=function(e){for(var t,n,r,a=e.length,o=-1,i=0;++o<a;)i+=e[o].length;for(n=new Array(i);--a>=0;)for(r=e[a],t=r.length;--t>=0;)n[--i]=r[t];return n},e.layout.hierarchy=function(){function hierarchy(r){var a,o=[r],i=[];for(r.depth=0;null!=(a=o.pop());)if(i.push(a),(l=t.call(hierarchy,a,a.depth))&&(s=l.length)){for(var s,l,u;--s>=0;)o.push(u=l[s]),u.parent=a,u.depth=a.depth+1;n&&(a.value=0),a.children=l}else n&&(a.value=+n.call(hierarchy,a,a.depth)||0),delete a.children;return d3_layout_hierarchyVisitAfter(r,function(t){var r,a;e&&(r=t.children)&&r.sort(e),n&&(a=t.parent)&&(a.value+=t.value)}),i}var e=d3_layout_hierarchySort,t=d3_layout_hierarchyChildren,n=d3_layout_hierarchyValue;return hierarchy.sort=function(t){return arguments.length?(e=t,hierarchy):e},hierarchy.children=function(e){return arguments.length?(t=e,hierarchy):t},hierarchy.value=function(e){return arguments.length?(n=e,hierarchy):n},hierarchy.revalue=function(e){return n&&(d3_layout_hierarchyVisitBefore(e,function(e){e.children&&(e.value=0)}),d3_layout_hierarchyVisitAfter(e,function(e){var t;e.children||(e.value=+n.call(hierarchy,e,e.depth)||0),(t=e.parent)&&(t.value+=e.value)})),e},hierarchy},e.layout.tree=function(){function tree(e,o){var i=t.call(this,e,o),s=i[0],l=wrapTree(s);if(d3_layout_hierarchyVisitAfter(l,firstWalk),l.parent.m=-l.z,d3_layout_hierarchyVisitBefore(l,secondWalk),a)d3_layout_hierarchyVisitBefore(s,sizeNode);else{var u=s,c=s,d=s;d3_layout_hierarchyVisitBefore(s,function(e){e.x<u.x&&(u=e),e.x>c.x&&(c=e),e.depth>d.depth&&(d=e)});var h=n(u,c)/2-u.x,f=r[0]/(c.x+n(c,u)/2+h),p=r[1]/(d.depth||1);d3_layout_hierarchyVisitBefore(s,function(e){e.x=(e.x+h)*f,e.y=e.depth*p})}return i}function wrapTree(e){for(var t,n={A:null,children:[e]},r=[n];null!=(t=r.pop());)for(var a,o=t.children,i=0,s=o.length;s>i;++i)r.push((o[i]=a={_:o[i],parent:t,children:(a=o[i].children)&&a.slice()||[],A:null,a:null,z:0,m:0,c:0,s:0,t:null,i:i}).a=a);return n.children[0]}function firstWalk(e){var t=e.children,r=e.parent.children,a=e.i?r[e.i-1]:null;if(t.length){d3_layout_treeShift(e);var o=(t[0].z+t[t.length-1].z)/2;a?(e.z=a.z+n(e._,a._),e.m=e.z-o):e.z=o}else a&&(e.z=a.z+n(e._,a._));e.parent.A=apportion(e,a,e.parent.A||r[0])}function secondWalk(e){e._.x=e.z+e.parent.m,e.m+=e.parent.m}function apportion(e,t,r){if(t){for(var a,o=e,i=e,s=t,l=o.parent.children[0],u=o.m,c=i.m,d=s.m,h=l.m;s=d3_layout_treeRight(s),o=d3_layout_treeLeft(o),s&&o;)l=d3_layout_treeLeft(l),i=d3_layout_treeRight(i),i.a=e,a=s.z+d-o.z-u+n(s._,o._),a>0&&(d3_layout_treeMove(d3_layout_treeAncestor(s,e,r),e,a),u+=a,c+=a),d+=s.m,u+=o.m,h+=l.m,c+=i.m;s&&!d3_layout_treeRight(i)&&(i.t=s,i.m+=d-c),o&&!d3_layout_treeLeft(l)&&(l.t=o,l.m+=u-h,r=e)}return r}function sizeNode(e){e.x*=r[0],e.y=e.depth*r[1]}var t=e.layout.hierarchy().sort(null).value(null),n=d3_layout_treeSeparation,r=[1,1],a=null;return tree.separation=function(e){return arguments.length?(n=e,tree):n},tree.size=function(e){return arguments.length?(a=null==(r=e)?sizeNode:null,tree):a?null:r},tree.nodeSize=function(e){return arguments.length?(a=null==(r=e)?null:sizeNode,tree):a?r:null},d3_layout_hierarchyRebind(tree,t)},e.functor=d3_functor,e.svg={},e.svg.diagonal=function(){function diagonal(r,a){var o=e.call(this,r,a),i=t.call(this,r,a),s=(o.y+i.y)/2,l=[o,{x:o.x,y:s},{x:i.x,y:s},i];return l=l.map(n),"M"+l[0]+"C"+l[1]+" "+l[2]+" "+l[3]}var e=d3_source,t=d3_target,n=d3_svg_diagonalProjection;return diagonal.source=function(t){return arguments.length?(e=d3_functor(t),diagonal):e},diagonal.target=function(e){return arguments.length?(t=d3_functor(e),diagonal):t},diagonal.projection=function(e){return arguments.length?(n=e,diagonal):n},diagonal},"function"==typeof define&&define.amd?define(e):"object"==typeof t&&t.exports&&(t.exports=e),this.d3=e}()},{}],15:[function(e,t,n){function loadATypeKit(e,t){var n=d3.select("head"),r=!0,a=n.append("script").attr({type:"text/javascript",src:e}),o=a.node();o.async=!0,o.onload=function loadTypeKit(){function typekitDone(){r&&(console.log("needToRunDone is true."),r=!1,clearTimeout(i),t())}try{console.log("Typekit is loading."),Typekit.load({active:typekitDone,inactive:typekitDone})}catch(e){}};var i=setTimeout(function timeIsUp(){r?(console.log("Moving on."),r=!1,t()):console.log("Typekit already loaded.")},1e4)}t.exports=loadATypeKit},{}],16:[function(e,t,n){function createNewDocForm(e){function init(n){e=e?e:{};var o=r(),i=o.setUpOuterContainer("form.css","form",e);return i?(t=s.select(".form"),void a("//use.typekit.net/med0yzx.js",n)):void n()}function load(){render([{title:"New Sprigot document",fields:[{id:"name",name:"Name",type:"text"},{id:"author",name:"Author",type:"text"},{id:"admin",name:"Admin",type:"text"},{id:"format",name:"Format",type:"select",options:["sprigot","bloge"]}],submit:{action:function submitNewDocument(e){var t={id:e.name,rootSprig:i.randomId(8),authors:[e.author],admins:[e.author],format:e.format},n=(new Date).toJSON(),r={id:t.rootSprig,doc:t.id,title:e.name,body:"Hello. Type some stuff here.",children:[],created:n,modified:n};o.createNewDoc(t,r,function done(e,n){e?console.log("Error while saving doc:",e):(console.log("Saved doc:",n),u.direct("#/"+t.id+"/"+r.id+"?forceRebuild=true"))})},name:"Make it!"}}]),setTimeout(function doneOnNextTick(){e.loadDone()},0)}function render(e){var n=t.selectAll(".sprig").data(e,l()),r=n.enter().append("div").classed("sprig",!0).classed("textpane",!0);r.append("div").classed("title",!0);var a=r.append("div").classed("sprigbody",!0);n.select(".title").text(function getTitle(e){return e.title});var o=n.exit();o.remove(),a.each(setUpFields),a.append("button").classed("submit-button",!0).text(function getName(e){return e.submit.name}).on("click",function onSubmit(e){var t=getFormValues(this.parentElement,e.fields);e.submit.action(t)})}function setUpFields(e){var t=s.select(this).selectAll(".field-group").data(e.fields),n=t.enter().append("div").classed("field-group",!0);n.append("label").attr({id:function getId(e){return e.id+"_label"},"for":function getFor(e){return e.id}}).text(function getName(e){return e.name}),n.append("input").attr("id",function getId(e){return e.id}),t.exit().remove()}function getFormValues(e,t){function getFieldValueFromForm(e){n[e.id]=r.select("#"+e.id).node().value}var n={},r=s.select(e);return t.forEach(getFieldValueFromForm),n}var t;return{init:init,load:load,newDocFormSel:t,controllerType:"form"}}var r=e("./sprigotbasemixin"),a=e("./load_a_typekit"),o=e("./legacy-store"),i=e("idmaker"),s=e("./lib/d3-small"),l=e("accessor"),u=e("./direct");t.exports=createNewDocForm},{"./direct":6,"./legacy-store":13,"./lib/d3-small":14,"./load_a_typekit":15,"./sprigotbasemixin":28,accessor:17,idmaker:19}],17:[function(e,t,n){function accessor(e){var t="id";return e&&"string"==typeof e&&(t=e),function accessProperty(e){return e[t]}}"object"==typeof t&&"object"==typeof t.exports&&(t.exports=accessor)},{}],18:[function(e,t,n){function exportMethods(e){var t;return t=Array.isArray(e)?e:Array.prototype.slice.call(arguments),t.reduce(addFnToExports,{})}function addFnToExports(e,t){return e[t.name]=t,e}t.exports=exportMethods},{}],19:[function(e,t,n){function createIdmaker(){function pickFromArrayAtRandom(e){return e[~~(Math.random()*e.length)]}function randomId(t){for(var n="",r=0;t>r;++r)n+=pickFromArrayAtRandom(e);return n}var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split("");return{randomId:randomId}}"object"==typeof t&&"object"==typeof t.exports&&(t.exports=createIdmaker())},{}],20:[function(e,t,n){(function(e){(function(){function baseCompareAscending(e,t){if(e!==t){var n=e===e,r=t===t;if(e>t||!n||"undefined"==typeof e&&r)return 1;if(t>e||!r||"undefined"==typeof t&&n)return-1}return 0}function baseFindIndex(e,t,n){for(var r=e.length,a=n?r:-1;n?a--:++a<r;)if(t(e[a],a,e))return a;return-1}function baseIndexOf(e,t,n){if(t!==t)return indexOfNaN(e,n);for(var r=n-1,a=e.length;++r<a;)if(e[r]===t)return r;return-1}function baseIsFunction(e){return"function"==typeof e||!1}function baseToString(e){return"string"==typeof e?e:null==e?"":e+""}function charAtCallback(e){return e.charCodeAt(0)}function charsLeftIndex(e,t){for(var n=-1,r=e.length;++n<r&&t.indexOf(e.charAt(n))>-1;);return n}function charsRightIndex(e,t){for(var n=e.length;n--&&t.indexOf(e.charAt(n))>-1;);return n}function compareAscending(e,t){return baseCompareAscending(e.criteria,t.criteria)||e.index-t.index}function compareMultiple(e,t,n){for(var r=-1,a=e.criteria,o=t.criteria,i=a.length,s=n.length;++r<i;){var l=baseCompareAscending(a[r],o[r]);if(l)return r>=s?l:l*(n[r]?1:-1)}return e.index-t.index}function deburrLetter(e){return ye[e]}function escapeHtmlChar(e){return be[e]}function escapeStringChar(e){return"\\"+Te[e]}function indexOfNaN(e,t,n){for(var r=e.length,a=t+(n?0:-1);n?a--:++a<r;){var o=e[a];if(o!==o)return a}return-1}function isObjectLike(e){return!!e&&"object"==typeof e}function isSpace(e){return 160>=e&&e>=9&&13>=e||32==e||160==e||5760==e||6158==e||e>=8192&&(8202>=e||8232==e||8233==e||8239==e||8287==e||12288==e||65279==e)}function replaceHolders(e,t){for(var n=-1,r=e.length,a=-1,o=[];++n<r;)e[n]===t&&(e[n]=w,o[++a]=n);return o}function sortedUniq(e,t){for(var n,r=-1,a=e.length,o=-1,i=[];++r<a;){var s=e[r],l=t?t(s,r,e):s;r&&n===l||(n=l,i[++o]=s)}return i}function trimmedLeftIndex(e){for(var t=-1,n=e.length;++t<n&&isSpace(e.charCodeAt(t)););return t}function trimmedRightIndex(e){for(var t=e.length;t--&&isSpace(e.charCodeAt(t)););return t}function unescapeHtmlChar(e){return xe[e]}function runInContext(e){function lodash(e){if(isObjectLike(e)&&!ln(e)&&!(e instanceof LazyWrapper)){if(e instanceof LodashWrapper)return e;if(Oe.call(e,"__chain__")&&Oe.call(e,"__wrapped__"))return wrapperClone(e)}return new LodashWrapper(e)}function baseLodash(){}function LodashWrapper(e,t,n){this.__wrapped__=e,this.__actions__=n||[],this.__chain__=!!t}function LazyWrapper(e){this.__wrapped__=e,this.__actions__=null,this.__dir__=1,this.__dropCount__=0,this.__filtered__=!1,this.__iteratees__=null,this.__takeCount__=lt,this.__views__=null}function lazyClone(){var e=this.__actions__,t=this.__iteratees__,n=this.__views__,r=new LazyWrapper(this.__wrapped__);return r.__actions__=e?arrayCopy(e):null,r.__dir__=this.__dir__,r.__filtered__=this.__filtered__,r.__iteratees__=t?arrayCopy(t):null,r.__takeCount__=this.__takeCount__,r.__views__=n?arrayCopy(n):null,r}function lazyReverse(){if(this.__filtered__){var e=new LazyWrapper(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e}function lazyValue(){var e=this.__wrapped__.value();if(!ln(e))return baseWrapperValue(e,this.__actions__);var t=this.__dir__,n=0>t,r=getView(0,e.length,this.__views__),a=r.start,o=r.end,i=o-a,s=n?o:a-1,l=nt(i,this.__takeCount__),u=this.__iteratees__,c=u?u.length:0,d=0,h=[];e:for(;i--&&l>d;){s+=t;for(var f=-1,p=e[s];++f<c;){var g=u[f],_=g.iteratee,m=g.type;if(m==v){if(g.done&&(n?s>g.index:s<g.index)&&(g.count=0,g.done=!1),g.index=s,!g.done){var x=g.limit;if(!(g.done=x>-1?g.count++>=x:!_(p)))continue e}}else{var w=_(p);if(m==b)p=w;else if(!w){if(m==y)continue e;break e}}}h[d++]=p}return h}function MapCache(){this.__data__={}}function mapDelete(e){return this.has(e)&&delete this.__data__[e]}function mapGet(e){return"__proto__"==e?r:this.__data__[e]}function mapHas(e){return"__proto__"!=e&&Oe.call(this.__data__,e)}function mapSet(e,t){return"__proto__"!=e&&(this.__data__[e]=t),this}function SetCache(e){var t=e?e.length:0;for(this.data={hash:Je(null),set:new He};t--;)this.push(e[t])}function cacheIndexOf(e,t){var n=e.data,r="string"==typeof t||isObject(t)?n.set.has(t):n.hash[t];return r?0:-1}function cachePush(e){var t=this.data;"string"==typeof e||isObject(e)?t.set.add(e):t.hash[e]=!0}function arrayCopy(e,n){var r=-1,a=e.length;for(n||(n=t(a));++r<a;)n[r]=e[r];return n}function arrayEach(e,t){for(var n=-1,r=e.length;++n<r&&t(e[n],n,e)!==!1;);return e}function arrayEachRight(e,t){for(var n=e.length;n--&&t(e[n],n,e)!==!1;);return e}function arrayEvery(e,t){for(var n=-1,r=e.length;++n<r;)if(!t(e[n],n,e))return!1;return!0}function arrayFilter(e,t){for(var n=-1,r=e.length,a=-1,o=[];++n<r;){var i=e[n];t(i,n,e)&&(o[++a]=i)}return o}function arrayMap(e,n){for(var r=-1,a=e.length,o=t(a);++r<a;)o[r]=n(e[r],r,e);return o}function arrayMax(e){for(var t=-1,n=e.length,r=st;++t<n;){var a=e[t];a>r&&(r=a)}return r}function arrayMin(e){for(var t=-1,n=e.length,r=lt;++t<n;){var a=e[t];r>a&&(r=a)}return r}function arrayReduce(e,t,n,r){var a=-1,o=e.length;for(r&&o&&(n=e[++a]);++a<o;)n=t(n,e[a],a,e);return n;

}function arrayReduceRight(e,t,n,r){var a=e.length;for(r&&a&&(n=e[--a]);a--;)n=t(n,e[a],a,e);return n}function arraySome(e,t){for(var n=-1,r=e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}function arraySum(e){for(var t=e.length,n=0;t--;)n+=+e[t]||0;return n}function assignDefaults(e,t){return"undefined"==typeof e?t:e}function assignOwnDefaults(e,t,n,r){return"undefined"!=typeof e&&Oe.call(r,n)?e:t}function baseAssign(e,t,n){var r=bn(t);if(!n)return baseCopy(t,e,r);for(var a=-1,o=r.length;++a<o;){var i=r[a],s=e[i],l=n(s,t[i],i,e,t);(l===l?l===s:s!==s)&&("undefined"!=typeof s||i in e)||(e[i]=l)}return e}function baseAt(e,n){for(var a=-1,o=e.length,i=isLength(o),s=n.length,l=t(s);++a<s;){var u=n[a];i?(u=parseFloat(u),l[a]=isIndex(u,o)?e[u]:r):l[a]=e[u]}return l}function baseCopy(e,t,n){n||(n=t,t={});for(var r=-1,a=n.length;++r<a;){var o=n[r];t[o]=e[o]}return t}function baseCallback(e,t,n){var r=typeof e;return"function"==r?"undefined"==typeof t?e:bindCallback(e,t,n):null==e?identity:"object"==r?baseMatches(e):"undefined"==typeof t?baseProperty(e+""):baseMatchesProperty(e+"",t)}function baseClone(e,t,n,r,a,o,i){var s;if(n&&(s=a?n(e,r,a):n(e)),"undefined"!=typeof s)return s;if(!isObject(e))return e;var l=ln(e);if(l){if(s=initCloneArray(e),!t)return arrayCopy(e,s)}else{var u=Me.call(e),c=u==I;if(u!=D&&u!=T&&(!c||a))return me[u]?initCloneByTag(e,u,t):a?e:{};if(s=initCloneObject(c?{}:e),!t)return baseCopy(e,s,bn(e))}o||(o=[]),i||(i=[]);for(var d=o.length;d--;)if(o[d]==e)return i[d];return o.push(e),i.push(s),(l?arrayEach:baseForOwn)(e,function(r,a){s[a]=baseClone(r,t,n,a,e,o,i)}),s}function baseDelay(e,t,n){if("function"!=typeof e)throw new Te(x);return Ve(function(){e.apply(r,n)},t)}function baseDifference(e,t){var n=e?e.length:0,r=[];if(!n)return r;var a=-1,o=getIndexOf(),i=o==baseIndexOf,s=i&&t.length>=200?Tt(t):null,l=t.length;s&&(o=cacheIndexOf,i=!1,t=s);e:for(;++a<n;){var u=e[a];if(i&&u===u){for(var c=l;c--;)if(t[c]===u)continue e;r.push(u)}else o(t,u,0)<0&&r.push(u)}return r}function baseEvery(e,t){var n=!0;return vt(e,function(e,r,a){return n=!!t(e,r,a)}),n}function baseFill(e,t,n,r){var a=e.length;for(n=null==n?0:+n||0,0>n&&(n=-n>a?0:a+n),r="undefined"==typeof r||r>a?a:+r||0,0>r&&(r+=a),a=n>r?0:r>>>0,n>>>=0;a>n;)e[n++]=t;return e}function baseFilter(e,t){var n=[];return vt(e,function(e,r,a){t(e,r,a)&&n.push(e)}),n}function baseFind(e,t,n,r){var a;return n(e,function(e,n,o){return t(e,n,o)?(a=r?n:e,!1):void 0}),a}function baseFlatten(e,t,n){for(var r=-1,a=e.length,o=-1,i=[];++r<a;){var s=e[r];if(isObjectLike(s)&&isLength(s.length)&&(ln(s)||isArguments(s))){t&&(s=baseFlatten(s,t,n));var l=-1,u=s.length;for(i.length+=u;++l<u;)i[++o]=s[l]}else n||(i[++o]=s)}return i}function baseForIn(e,t){return bt(e,t,keysIn)}function baseForOwn(e,t){return bt(e,t,bn)}function baseForOwnRight(e,t){return xt(e,t,bn)}function baseFunctions(e,t){for(var n=-1,r=t.length,a=-1,o=[];++n<r;){var i=t[n];cn(e[i])&&(o[++a]=i)}return o}function baseIsEqual(e,t,n,r,a,o){if(e===t)return 0!==e||1/e==1/t;var i=typeof e,s=typeof t;return"function"!=i&&"object"!=i&&"function"!=s&&"object"!=s||null==e||null==t?e!==e&&t!==t:baseIsEqualDeep(e,t,baseIsEqual,n,r,a,o)}function baseIsEqualDeep(e,t,n,r,a,o,i){var s=ln(e),l=ln(t),u=S,c=S;s||(u=Me.call(e),u==T?u=D:u!=D&&(s=isTypedArray(e))),l||(c=Me.call(t),c==T?c=D:c!=D&&(l=isTypedArray(t)));var d=u==D||a&&u==I,h=c==D||a&&c==I,f=u==c;if(f&&!s&&!d)return equalByTag(e,t,u);if(a){if(!(f||d&&h))return!1}else{var p=d&&Oe.call(e,"__wrapped__"),g=h&&Oe.call(t,"__wrapped__");if(p||g)return n(p?e.value():e,g?t.value():t,r,a,o,i);if(!f)return!1}o||(o=[]),i||(i=[]);for(var _=o.length;_--;)if(o[_]==e)return i[_]==t;o.push(e),i.push(t);var m=(s?equalArrays:equalObjects)(e,t,n,r,a,o,i);return o.pop(),i.pop(),m}function baseIsMatch(e,t,n,a,o){for(var i=-1,s=t.length,l=!o;++i<s;)if(l&&a[i]?n[i]!==e[t[i]]:!(t[i]in e))return!1;for(i=-1;++i<s;){var u=t[i],c=e[u],d=n[i];if(l&&a[i])var h="undefined"!=typeof c||u in e;else h=o?o(c,d,u):r,"undefined"==typeof h&&(h=baseIsEqual(d,c,o,!0));if(!h)return!1}return!0}function baseMap(e,t){var n=[];return vt(e,function(e,r,a){n.push(t(e,r,a))}),n}function baseMatches(e){var n=bn(e),r=n.length;if(!r)return constant(!0);if(1==r){var a=n[0],o=e[a];if(isStrictComparable(o))return function(e){return null!=e&&e[a]===o&&("undefined"!=typeof o||a in toObject(e))}}for(var i=t(r),s=t(r);r--;)o=e[n[r]],i[r]=o,s[r]=isStrictComparable(o);return function(e){return null!=e&&baseIsMatch(toObject(e),n,i,s)}}function baseMatchesProperty(e,t){return isStrictComparable(t)?function(n){return null!=n&&n[e]===t&&("undefined"!=typeof t||e in toObject(n))}:function(n){return null!=n&&baseIsEqual(t,n[e],null,!0)}}function baseMerge(e,t,n,a,o){if(!isObject(e))return e;var i=isLength(t.length)&&(ln(t)||isTypedArray(t));return(i?arrayEach:baseForOwn)(t,function(t,s,l){if(isObjectLike(t))return a||(a=[]),o||(o=[]),baseMergeDeep(e,l,s,baseMerge,n,a,o);var u=e[s],c=n?n(u,t,s,e,l):r,d="undefined"==typeof c;d&&(c=t),!i&&"undefined"==typeof c||!d&&(c===c?c===u:u!==u)||(e[s]=c)}),e}function baseMergeDeep(e,t,n,a,o,i,s){for(var l=i.length,u=t[n];l--;)if(i[l]==u)return void(e[n]=s[l]);var c=e[n],d=o?o(c,u,n,e,t):r,h="undefined"==typeof d;h&&(d=u,isLength(u.length)&&(ln(u)||isTypedArray(u))?d=ln(c)?c:c&&c.length?arrayCopy(c):[]:dn(u)||isArguments(u)?d=isArguments(c)?toPlainObject(c):dn(c)?c:{}:h=!1),i.push(u),s.push(d),h?e[n]=a(d,u,o,i,s):(d===d?d!==c:c===c)&&(e[n]=d)}function baseProperty(e){return function(t){return null==t?r:t[e]}}function baseRandom(e,t){return e+Ue(it()*(t-e+1))}function baseReduce(e,t,n,r,a){return a(e,function(e,a,o){n=r?(r=!1,e):t(n,e,a,o)}),n}function baseSlice(e,n,r){var a=-1,o=e.length;n=null==n?0:+n||0,0>n&&(n=-n>o?0:o+n),r="undefined"==typeof r||r>o?o:+r||0,0>r&&(r+=o),o=n>r?0:r-n>>>0,n>>>=0;for(var i=t(o);++a<o;)i[a]=e[a+n];return i}function baseSome(e,t){var n;return vt(e,function(e,r,a){return n=t(e,r,a),!n}),!!n}function baseSortBy(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}function baseSortByOrder(e,n,a){var o=-1,i=e.length,s=isLength(i)?t(i):[];return vt(e,function(e){for(var a=n.length,i=t(a);a--;)i[a]=null==e?r:e[n[a]];s[++o]={criteria:i,index:o,value:e}}),baseSortBy(s,function(e,t){return compareMultiple(e,t,a)})}function baseSum(e,t){var n=0;return vt(e,function(e,r,a){n+=+t(e,r,a)||0}),n}function baseUniq(e,t){var n=-1,r=getIndexOf(),a=e.length,o=r==baseIndexOf,i=o&&a>=200,s=i?Tt():null,l=[];s?(r=cacheIndexOf,o=!1):(i=!1,s=t?[]:l);e:for(;++n<a;){var u=e[n],c=t?t(u,n,e):u;if(o&&u===u){for(var d=s.length;d--;)if(s[d]===c)continue e;t&&s.push(c),l.push(u)}else r(s,c,0)<0&&((t||i)&&s.push(c),l.push(u))}return l}function baseValues(e,n){for(var r=-1,a=n.length,o=t(a);++r<a;)o[r]=e[n[r]];return o}function baseWhile(e,t,n,r){for(var a=e.length,o=r?a:-1;(r?o--:++o<a)&&t(e[o],o,e););return n?baseSlice(e,r?0:o,r?o+1:a):baseSlice(e,r?o+1:0,r?a:o)}function baseWrapperValue(e,t){var n=e;n instanceof LazyWrapper&&(n=n.value());for(var r=-1,a=t.length;++r<a;){var o=[n],i=t[r];Be.apply(o,i.args),n=i.func.apply(i.thisArg,o)}return n}function binaryIndex(e,t,n){var r=0,a=e?e.length:r;if("number"==typeof t&&t===t&&dt>=a){for(;a>r;){var o=r+a>>>1,i=e[o];(n?t>=i:t>i)?r=o+1:a=o}return a}return binaryIndexBy(e,t,identity,n)}function binaryIndexBy(e,t,n,r){t=n(t);for(var a=0,o=e?e.length:0,i=t!==t,s="undefined"==typeof t;o>a;){var l=Ue((a+o)/2),u=n(e[l]),c=u===u;if(i)var d=c||r;else d=s?c&&(r||"undefined"!=typeof u):r?t>=u:t>u;d?a=l+1:o=l}return nt(o,ct)}function bindCallback(e,t,n){if("function"!=typeof e)return identity;if("undefined"==typeof t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 3:return function(n,r,a){return e.call(t,n,r,a)};case 4:return function(n,r,a,o){return e.call(t,n,r,a,o)};case 5:return function(n,r,a,o,i){return e.call(t,n,r,a,o,i)}}return function(){return e.apply(t,arguments)}}function bufferClone(e){return ze.call(e,0)}function composeArgs(e,n,r){for(var a=r.length,o=-1,i=tt(e.length-a,0),s=-1,l=n.length,u=t(i+l);++s<l;)u[s]=n[s];for(;++o<a;)u[r[o]]=e[o];for(;i--;)u[s++]=e[o++];return u}function composeArgsRight(e,n,r){for(var a=-1,o=r.length,i=-1,s=tt(e.length-o,0),l=-1,u=n.length,c=t(s+u);++i<s;)c[i]=e[i];for(var d=i;++l<u;)c[d+l]=n[l];for(;++a<o;)c[d+r[a]]=e[i++];return c}function createAggregator(e,t){return function(n,r,a){var o=t?t():{};if(r=getCallback(r,a,3),ln(n))for(var i=-1,s=n.length;++i<s;){var l=n[i];e(o,l,r(l,i,n),n)}else vt(n,function(t,n,a){e(o,t,r(t,n,a),a)});return o}}function createAssigner(e){return function(){var t=arguments,n=t.length,r=t[0];if(2>n||null==r)return r;var a=t[n-2],o=t[n-1],i=t[3];n>3&&"function"==typeof a?(a=bindCallback(a,o,5),n-=2):(a=n>2&&"function"==typeof o?o:null,n-=a?1:0),i&&isIterateeCall(t[1],t[2],i)&&(a=3==n?null:a,n=2);for(var s=0;++s<n;){var l=t[s];l&&e(r,l,a)}return r}}function createBaseEach(e,t){return function(n,r){var a=n?n.length:0;if(!isLength(a))return e(n,r);for(var o=t?a:-1,i=toObject(n);(t?o--:++o<a)&&r(i[o],o,i)!==!1;);return n}}function createBaseFor(e){return function(t,n,r){for(var a=toObject(t),o=r(t),i=o.length,s=e?i:-1;e?s--:++s<i;){var l=o[s];if(n(a[l],l,a)===!1)break}return t}}function createBindWrapper(e,t){function wrapper(){var r=this&&this!==Ae&&this instanceof wrapper?n:e;return r.apply(t,arguments)}var n=createCtorWrapper(e);return wrapper}function createCompounder(e){return function(t){for(var n=-1,r=words(deburr(t)),a=r.length,o="";++n<a;)o=e(o,r[n],n);return o}}function createCtorWrapper(e){return function(){var t=mt(e.prototype),n=e.apply(t,arguments);return isObject(n)?n:t}}function createCurry(e){function curryFunc(t,n,r){r&&isIterateeCall(t,n,r)&&(n=null);var a=createWrapper(t,e,null,null,null,null,null,n);return a.placeholder=curryFunc.placeholder,a}return curryFunc}function createExtremum(e,t){return function(n,r,a){a&&isIterateeCall(n,r,a)&&(r=null);var o=getCallback(),i=null==r;if(o===baseCallback&&i||(i=!1,r=o(r,a,3)),i){var s=ln(n);if(s||!isString(n))return e(s?n:toIterable(n));r=charAtCallback}return extremumBy(n,r,t)}}function createFind(e,t){return function(n,a,o){if(a=getCallback(a,o,3),ln(n)){var i=baseFindIndex(n,a,t);return i>-1?n[i]:r}return baseFind(n,a,e)}}function createFindIndex(e){return function(t,n,r){return t&&t.length?(n=getCallback(n,r,3),baseFindIndex(t,n,e)):-1}}function createFindKey(e){return function(t,n,r){return n=getCallback(n,r,3),baseFind(t,n,e,!0)}}function createFlow(e){return function(){var n=arguments.length;if(!n)return function(){return arguments[0]};for(var r,a=e?n:-1,o=0,i=t(n);e?a--:++a<n;){var s=i[o++]=arguments[a];if("function"!=typeof s)throw new Te(x);var l=r?"":Ct(s);r="wrapper"==l?new LodashWrapper([]):r}for(a=r?-1:n;++a<n;){s=i[a],l=Ct(s);var u="wrapper"==l?St(s):null;r=u&&isLaziable(u[0])?r[Ct(u[0])].apply(r,u[3]):1==s.length&&isLaziable(s)?r[l]():r.thru(s)}return function(){var e=arguments;if(r&&1==e.length&&ln(e[0]))return r.plant(e[0]).value();for(var t=0,a=i[t].apply(this,e);++t<n;)a=i[t].call(this,a);return a}}}function createForEach(e,t){return function(n,r,a){return"function"==typeof r&&"undefined"==typeof a&&ln(n)?e(n,r):t(n,bindCallback(r,a,3))}}function createForIn(e){return function(t,n,r){return("function"!=typeof n||"undefined"!=typeof r)&&(n=bindCallback(n,r,3)),e(t,n,keysIn)}}function createForOwn(e){return function(t,n,r){return("function"!=typeof n||"undefined"!=typeof r)&&(n=bindCallback(n,r,3)),e(t,n)}}function createPadDir(e){return function(t,n,r){return t=baseToString(t),t&&(e?t:"")+createPadding(t,n,r)+(e?"":t)}}function createPartial(e){var t=restParam(function(n,r){var a=replaceHolders(r,t.placeholder);return createWrapper(n,e,null,r,a)});return t}function createReduce(e,t){return function(n,r,a,o){var i=arguments.length<3;return"function"==typeof r&&"undefined"==typeof o&&ln(n)?e(n,r,a,i):baseReduce(n,getCallback(r,o,4),a,i,t)}}function createHybridWrapper(e,n,a,f,p,g,_,m,v,y){function wrapper(){for(var s=arguments.length,l=s,u=t(s);l--;)u[l]=arguments[l];if(f&&(u=composeArgs(u,f,p)),g&&(u=composeArgsRight(u,g,_)),T||C){var h=wrapper.placeholder,I=replaceHolders(u,h);if(s-=I.length,y>s){var F=m?arrayCopy(m):null,A=tt(y-s,0),D=T?I:null,O=T?null:I,R=T?u:null,M=T?null:u;n|=T?c:d,n&=~(T?d:c),S||(n&=~(o|i));var E=[e,n,a,R,D,M,O,F,v,A],P=createHybridWrapper.apply(r,E);return isLaziable(e)&&kt(P,E),P.placeholder=h,P}}var L=x?a:this;w&&(e=L[N]),m&&(u=reorder(u,m)),b&&v<u.length&&(u.length=v);var z=this&&this!==Ae&&this instanceof wrapper?k||createCtorWrapper(e):e;return z.apply(L,u)}var b=n&h,x=n&o,w=n&i,T=n&l,S=n&s,C=n&u,k=!w&&createCtorWrapper(e),N=e;return wrapper}function createPadding(e,t,n){var r=e.length;if(t=+t,r>=t||!Qe(t))return"";var a=t-r;return n=null==n?" ":n+"",repeat(n,je(a/n.length)).slice(0,a)}function createPartialWrapper(e,n,r,a){function wrapper(){for(var n=-1,o=arguments.length,l=-1,u=a.length,c=t(o+u);++l<u;)c[l]=a[l];for(;o--;)c[l++]=arguments[++n];var d=this&&this!==Ae&&this instanceof wrapper?s:e;return d.apply(i?r:this,c)}var i=n&o,s=createCtorWrapper(e);return wrapper}function createSortedIndex(e){return function(t,n,r,a){var o=getCallback(r);return o===baseCallback&&null==r?binaryIndex(t,n,e):binaryIndexBy(t,n,o(r,a,1),e)}}function createWrapper(e,t,n,a,s,l,u,h){var f=t&i;if(!f&&"function"!=typeof e)throw new Te(x);var p=a?a.length:0;if(p||(t&=~(c|d),a=s=null),p-=s?s.length:0,t&d){var g=a,_=s;a=s=null}var m=f?null:St(e),v=[e,t,n,a,s,g,_,l,u,h];if(m&&(mergeData(v,m),t=v[1],h=v[9]),v[9]=null==h?f?0:e.length:tt(h-p,0)||0,t==o)var y=createBindWrapper(v[0],v[2]);else y=t!=c&&t!=(o|c)||v[4].length?createHybridWrapper.apply(r,v):createPartialWrapper.apply(r,v);var b=m?wt:kt;return b(y,v)}function equalArrays(e,t,n,a,o,i,s){var l=-1,u=e.length,c=t.length,d=!0;if(u!=c&&!(o&&c>u))return!1;for(;d&&++l<u;){var h=e[l],f=t[l];if(d=r,a&&(d=o?a(f,h,l):a(h,f,l)),"undefined"==typeof d)if(o)for(var p=c;p--&&(f=t[p],!(d=h&&h===f||n(h,f,a,o,i,s))););else d=h&&h===f||n(h,f,a,o,i,s)}return!!d}function equalByTag(e,t,n){switch(n){case C:case k:return+e==+t;case N:return e.name==t.name&&e.message==t.message;case A:return e!=+e?t!=+t:0==e?1/e==1/t:e==+t;case O:case M:return e==t+""}return!1}function equalObjects(e,t,n,a,o,i,s){var l=bn(e),u=l.length,c=bn(t),d=c.length;if(u!=d&&!o)return!1;for(var h=o,f=-1;++f<u;){var p=l[f],g=o?p in t:Oe.call(t,p);if(g){var _=e[p],m=t[p];g=r,a&&(g=o?a(m,_,p):a(_,m,p)),"undefined"==typeof g&&(g=_&&_===m||n(_,m,a,o,i,s))}if(!g)return!1;h||(h="constructor"==p)}if(!h){var v=e.constructor,y=t.constructor;if(v!=y&&"constructor"in e&&"constructor"in t&&!("function"==typeof v&&v instanceof v&&"function"==typeof y&&y instanceof y))return!1}return!0}function extremumBy(e,t,n){var r=n?lt:st,a=r,o=a;return vt(e,function(e,i,s){var l=t(e,i,s);((n?a>l:l>a)||l===r&&l===o)&&(a=l,o=e)}),o}function getCallback(e,t,n){var r=lodash.callback||callback;return r=r===callback?baseCallback:r,n?r(e,t,n):r}function getIndexOf(e,t,n){var r=lodash.indexOf||indexOf;return r=r===indexOf?baseIndexOf:r,e?r(e,t,n):r}function getView(e,t,n){for(var r=-1,a=n?n.length:0;++r<a;){var o=n[r],i=o.size;switch(o.type){case"drop":e+=i;break;case"dropRight":t-=i;break;case"take":t=nt(t,e+i);break;case"takeRight":e=tt(e,t-i)}}return{start:e,end:t}}function initCloneArray(e){var t=e.length,n=new e.constructor(t);return t&&"string"==typeof e[0]&&Oe.call(e,"index")&&(n.index=e.index,n.input=e.input),n}function initCloneObject(e){var t=e.constructor;return"function"==typeof t&&t instanceof t||(t=be),new t}function initCloneByTag(e,t,n){var r=e.constructor;switch(t){case P:return bufferClone(e);case C:case k:return new r(+e);case L:case z:case j:case W:case U:case q:case B:case K:case H:var a=e.buffer;return new r(n?bufferClone(a):a,e.byteOffset,e.length);case A:case M:return new r(e);case O:var o=new r(e.source,ae.exec(e));o.lastIndex=e.lastIndex}return o}function isIndex(e,t){return e=+e,t=null==t?ft:t,e>-1&&e%1==0&&t>e}function isIterateeCall(e,t,n){if(!isObject(n))return!1;var r=typeof t;if("number"==r)var a=n.length,o=isLength(a)&&isIndex(t,a);else o="string"==r&&t in n;if(o){var i=n[t];return e===e?e===i:i!==i}return!1}function isLaziable(e){var t=Ct(e);return!!t&&e===lodash[t]&&t in LazyWrapper.prototype}function isLength(e){return"number"==typeof e&&e>-1&&e%1==0&&ft>=e}function isStrictComparable(e){return e===e&&(0===e?1/e>0:!isObject(e))}function mergeData(e,t){var n=e[1],r=t[1],a=n|r,i=h>a,u=r==h&&n==l||r==h&&n==f&&e[7].length<=t[8]||r==(h|f)&&n==l;if(!i&&!u)return e;r&o&&(e[2]=t[2],a|=n&o?0:s);var c=t[3];if(c){var d=e[3];e[3]=d?composeArgs(d,c,t[4]):arrayCopy(c),e[4]=d?replaceHolders(e[3],w):arrayCopy(t[4])}return c=t[5],c&&(d=e[5],e[5]=d?composeArgsRight(d,c,t[6]):arrayCopy(c),e[6]=d?replaceHolders(e[5],w):arrayCopy(t[6])),c=t[7],c&&(e[7]=arrayCopy(c)),r&h&&(e[8]=null==e[8]?t[8]:nt(e[8],t[8])),null==e[9]&&(e[9]=t[9]),e[0]=t[0],e[1]=a,e}function pickByArray(e,t){e=toObject(e);for(var n=-1,r=t.length,a={};++n<r;){var o=t[n];o in e&&(a[o]=e[o])}return a}function pickByCallback(e,t){var n={};return baseForIn(e,function(e,r,a){t(e,r,a)&&(n[r]=e)}),n}function reorder(e,t){for(var n=e.length,a=nt(t.length,n),o=arrayCopy(e);a--;){var i=t[a];e[a]=isIndex(i,n)?o[i]:r}return e}function shimIsPlainObject(e){{var t;lodash.support}if(!isObjectLike(e)||Me.call(e)!=D||!Oe.call(e,"constructor")&&(t=e.constructor,"function"==typeof t&&!(t instanceof t)))return!1;var n;return baseForIn(e,function(e,t){n=t}),"undefined"==typeof n||Oe.call(e,n)}function shimKeys(e){for(var t=keysIn(e),n=t.length,r=n&&e.length,a=lodash.support,o=r&&isLength(r)&&(ln(e)||a.nonEnumArgs&&isArguments(e)),i=-1,s=[];++i<n;){var l=t[i];(o&&isIndex(l,r)||Oe.call(e,l))&&s.push(l)}return s}function toIterable(e){return null==e?[]:isLength(e.length)?isObject(e)?e:be(e):values(e)}function toObject(e){return isObject(e)?e:be(e)}function wrapperClone(e){return e instanceof LazyWrapper?e.clone():new LodashWrapper(e.__wrapped__,e.__chain__,arrayCopy(e.__actions__))}function chunk(e,n,r){n=(r?isIterateeCall(e,n,r):null==n)?1:tt(+n||1,1);for(var a=0,o=e?e.length:0,i=-1,s=t(je(o/n));o>a;)s[++i]=baseSlice(e,a,a+=n);return s}function compact(e){for(var t=-1,n=e?e.length:0,r=-1,a=[];++t<n;){var o=e[t];o&&(a[++r]=o)}return a}function drop(e,t,n){var r=e?e.length:0;return r?((n?isIterateeCall(e,t,n):null==t)&&(t=1),baseSlice(e,0>t?0:t)):[]}function dropRight(e,t,n){var r=e?e.length:0;return r?((n?isIterateeCall(e,t,n):null==t)&&(t=1),t=r-(+t||0),baseSlice(e,0,0>t?0:t)):[]}function dropRightWhile(e,t,n){return e&&e.length?baseWhile(e,getCallback(t,n,3),!0,!0):[]}function dropWhile(e,t,n){return e&&e.length?baseWhile(e,getCallback(t,n,3),!0):[]}function fill(e,t,n,r){var a=e?e.length:0;return a?(n&&"number"!=typeof n&&isIterateeCall(e,t,n)&&(n=0,r=a),baseFill(e,t,n,r)):[]}function first(e){return e?e[0]:r}function flatten(e,t,n){var r=e?e.length:0;return n&&isIterateeCall(e,t,n)&&(t=!1),r?baseFlatten(e,t):[]}function flattenDeep(e){var t=e?e.length:0;return t?baseFlatten(e,!0):[]}function indexOf(e,t,n){var r=e?e.length:0;if(!r)return-1;if("number"==typeof n)n=0>n?tt(r+n,0):n;else if(n){var a=binaryIndex(e,t),o=e[a];return(t===t?t===o:o!==o)?a:-1}return baseIndexOf(e,t,n||0)}function initial(e){return dropRight(e,1)}function intersection(){for(var e=[],t=-1,n=arguments.length,r=[],a=getIndexOf(),o=a==baseIndexOf;++t<n;){var i=arguments[t];(ln(i)||isArguments(i))&&(e.push(i),r.push(o&&i.length>=120?Tt(t&&i):null))}n=e.length;var s=e[0],l=-1,u=s?s.length:0,c=[],d=r[0];e:for(;++l<u;)if(i=s[l],(d?cacheIndexOf(d,i):a(c,i,0))<0){for(t=n;--t;){var h=r[t];if((h?cacheIndexOf(h,i):a(e[t],i,0))<0)continue e}d&&d.push(i),c.push(i)}return c}function last(e){var t=e?e.length:0;return t?e[t-1]:r}function lastIndexOf(e,t,n){var r=e?e.length:0;if(!r)return-1;var a=r;if("number"==typeof n)a=(0>n?tt(r+n,0):nt(n||0,r-1))+1;else if(n){a=binaryIndex(e,t,!0)-1;var o=e[a];return(t===t?t===o:o!==o)?a:-1}if(t!==t)return indexOfNaN(e,a,!0);for(;a--;)if(e[a]===t)return a;return-1}function pull(){var e=arguments,t=e[0];if(!t||!t.length)return t;for(var n=0,r=getIndexOf(),a=e.length;++n<a;)for(var o=0,i=e[n];(o=r(t,i,o))>-1;)Ye.call(t,o,1);return t}function remove(e,t,n){var r=-1,a=e?e.length:0,o=[];for(t=getCallback(t,n,3);++r<a;){var i=e[r];t(i,r,e)&&(o.push(i),Ye.call(e,r--,1),a--)}return o}function rest(e){return drop(e,1)}function slice(e,t,n){var r=e?e.length:0;return r?(n&&"number"!=typeof n&&isIterateeCall(e,t,n)&&(t=0,n=r),baseSlice(e,t,n)):[]}function take(e,t,n){var r=e?e.length:0;return r?((n?isIterateeCall(e,t,n):null==t)&&(t=1),baseSlice(e,0,0>t?0:t)):[]}function takeRight(e,t,n){var r=e?e.length:0;return r?((n?isIterateeCall(e,t,n):null==t)&&(t=1),t=r-(+t||0),baseSlice(e,0>t?0:t)):[]}function takeRightWhile(e,t,n){return e&&e.length?baseWhile(e,getCallback(t,n,3),!1,!0):[]}function takeWhile(e,t,n){return e&&e.length?baseWhile(e,getCallback(t,n,3)):[]}function uniq(e,t,n,r){var a=e?e.length:0;if(!a)return[];null!=t&&"boolean"!=typeof t&&(r=n,n=isIterateeCall(e,t,r)?null:t,t=!1);var o=getCallback();return(o!==baseCallback||null!=n)&&(n=o(n,r,3)),t&&getIndexOf()==baseIndexOf?sortedUniq(e,n):baseUniq(e,n)}function unzip(e){for(var n=-1,r=(e&&e.length&&arrayMax(arrayMap(e,Fe)))>>>0,a=t(r);++n<r;)a[n]=arrayMap(e,baseProperty(n));return a}function xor(){for(var e=-1,t=arguments.length;++e<t;){var n=arguments[e];if(ln(n)||isArguments(n))var r=r?baseDifference(r,n).concat(baseDifference(n,r)):n}return r?baseUniq(r):[]}function zipObject(e,t){var n=-1,r=e?e.length:0,a={};for(!r||t||ln(e[0])||(t=[]);++n<r;){var o=e[n];t?a[o]=t[n]:o&&(a[o[0]]=o[1])}return a}function chain(e){var t=lodash(e);return t.__chain__=!0,t}function tap(e,t,n){return t.call(n,e),e}function thru(e,t,n){return t.call(n,e)}function wrapperChain(){return chain(this)}function wrapperCommit(){return new LodashWrapper(this.value(),this.__chain__)}function wrapperPlant(e){for(var t,n=this;n instanceof baseLodash;){var r=wrapperClone(n);t?a.__wrapped__=r:t=r;var a=r;n=n.__wrapped__}return a.__wrapped__=e,t}function wrapperReverse(){var e=this.__wrapped__;return e instanceof LazyWrapper?(this.__actions__.length&&(e=new LazyWrapper(this)),new LodashWrapper(e.reverse(),this.__chain__)):this.thru(function(e){return e.reverse()})}function wrapperToString(){return this.value()+""}function wrapperValue(){return baseWrapperValue(this.__wrapped__,this.__actions__)}function every(e,t,n){var r=ln(e)?arrayEvery:baseEvery;return n&&isIterateeCall(e,t,n)&&(t=null),("function"!=typeof t||"undefined"!=typeof n)&&(t=getCallback(t,n,3)),r(e,t)}function filter(e,t,n){var r=ln(e)?arrayFilter:baseFilter;return t=getCallback(t,n,3),r(e,t)}function findWhere(e,t){return zt(e,baseMatches(t))}function includes(e,t,n,r){var a=e?e.length:0;return isLength(a)||(e=values(e),a=e.length),a?(n="number"!=typeof n||r&&isIterateeCall(t,n,r)?0:0>n?tt(a+n,0):n||0,"string"==typeof e||!ln(e)&&isString(e)?a>n&&e.indexOf(t,n)>-1:getIndexOf(e,t,n)>-1):!1}function map(e,t,n){var r=ln(e)?arrayMap:baseMap;return t=getCallback(t,n,3),r(e,t)}function pluck(e,t){return map(e,baseProperty(t))}function reject(e,t,n){var r=ln(e)?arrayFilter:baseFilter;return t=getCallback(t,n,3),r(e,function(e,n,r){return!t(e,n,r)})}function sample(e,t,n){if(n?isIterateeCall(e,t,n):null==t){e=toIterable(e);var a=e.length;return a>0?e[baseRandom(0,a-1)]:r}var o=shuffle(e);return o.length=nt(0>t?0:+t||0,o.length),o}function shuffle(e){e=toIterable(e);for(var n=-1,r=e.length,a=t(r);++n<r;){var o=baseRandom(0,n);n!=o&&(a[n]=a[o]),a[o]=e[n]}return a}function size(e){var t=e?e.length:0;return isLength(t)?t:bn(e).length}function some(e,t,n){var r=ln(e)?arraySome:baseSome;return n&&isIterateeCall(e,t,n)&&(t=null),("function"!=typeof t||"undefined"!=typeof n)&&(t=getCallback(t,n,3)),r(e,t)}function sortBy(e,n,r){if(null==e)return[];var a=-1,o=e.length,i=isLength(o)?t(o):[];return r&&isIterateeCall(e,n,r)&&(n=null),n=getCallback(n,r,3),vt(e,function(e,t,r){i[++a]={criteria:n(e,t,r),index:a,value:e}}),baseSortBy(i,compareAscending)}function sortByAll(){var e=arguments,n=e[0],r=e[3],a=0,o=e.length-1;if(null==n)return[];for(var i=t(o);o>a;)i[a]=e[++a];return r&&isIterateeCall(e[1],e[2],r)&&(i=e[1]),baseSortByOrder(n,baseFlatten(i),[])}function sortByOrder(e,t,n,r){return null==e?[]:(r&&isIterateeCall(t,n,r)&&(n=null),ln(t)||(t=null==t?[]:[t]),ln(n)||(n=null==n?[]:[n]),baseSortByOrder(e,t,n))}function where(e,t){return filter(e,baseMatches(t))}function after(e,t){if("function"!=typeof t){if("function"!=typeof e)throw new Te(x);var n=e;e=t,t=n}return e=Qe(e=+e)?e:0,function(){return--e<1?t.apply(this,arguments):void 0}}function ary(e,t,n){return n&&isIterateeCall(e,t,n)&&(t=null),t=e&&null==t?e.length:tt(+t||0,0),createWrapper(e,h,null,null,null,null,t)}function before(e,t){var n;if("function"!=typeof t){if("function"!=typeof e)throw new Te(x);var r=e;e=t,t=r}return function(){return--e>0?n=t.apply(this,arguments):t=null,n}}function debounce(e,t,n){function cancel(){u&&We(u),o&&We(o),o=u=c=r}function delayed(){var n=t-(Zt()-s);if(0>=n||n>t){o&&We(o);var h=c;o=u=c=r,h&&(d=Zt(),i=e.apply(l,a),u||o||(a=l=null))}else u=Ve(delayed,n)}function maxDelayed(){u&&We(u),o=u=c=r,(f||h!==t)&&(d=Zt(),i=e.apply(l,a),u||o||(a=l=null))}function debounced(){if(a=arguments,s=Zt(),l=this,c=f&&(u||!p),h===!1)var n=p&&!u;else{o||p||(d=s);var r=h-(s-d),g=0>=r||r>h;g?(o&&(o=We(o)),d=s,i=e.apply(l,a)):o||(o=Ve(maxDelayed,r))}return g&&u?u=We(u):u||t===h||(u=Ve(delayed,t)),n&&(g=!0,i=e.apply(l,a)),!g||u||o||(a=l=null),i}var a,o,i,s,l,u,c,d=0,h=!1,f=!0;if("function"!=typeof e)throw new Te(x);if(t=0>t?0:+t||0,n===!0){var p=!0;f=!1}else isObject(n)&&(p=n.leading,h="maxWait"in n&&tt(+n.maxWait||0,t),f="trailing"in n?n.trailing:f);return debounced.cancel=cancel,debounced}function memoize(e,t){if("function"!=typeof e||t&&"function"!=typeof t)throw new Te(x);var n=function(){var r=arguments,a=n.cache,o=t?t.apply(this,r):r[0];if(a.has(o))return a.get(o);var i=e.apply(this,r);return a.set(o,i),i};return n.cache=new memoize.Cache,n}function negate(e){if("function"!=typeof e)throw new Te(x);return function(){return!e.apply(this,arguments)}}function once(e){return before(e,2)}function restParam(e,n){if("function"!=typeof e)throw new Te(x);return n=tt("undefined"==typeof n?e.length-1:+n||0,0),function(){for(var r=arguments,a=-1,o=tt(r.length-n,0),i=t(o);++a<o;)i[a]=r[n+a];switch(n){case 0:return e.call(this,i);case 1:return e.call(this,r[0],i);case 2:return e.call(this,r[0],r[1],i)}var s=t(n+1);for(a=-1;++a<n;)s[a]=r[a];return s[n]=i,e.apply(this,s)}}function spread(e){if("function"!=typeof e)throw new Te(x);return function(t){return e.apply(this,t)}}function throttle(e,t,n){var r=!0,a=!0;if("function"!=typeof e)throw new Te(x);return n===!1?r=!1:isObject(n)&&(r="leading"in n?!!n.leading:r,a="trailing"in n?!!n.trailing:a),ve.leading=r,ve.maxWait=+t,ve.trailing=a,debounce(e,t,ve)}function wrap(e,t){return t=null==t?identity:t,createWrapper(t,c,null,[e],[])}function clone(e,t,n,r){return t&&"boolean"!=typeof t&&isIterateeCall(e,t,n)?t=!1:"function"==typeof t&&(r=n,n=t,t=!1),n="function"==typeof n&&bindCallback(n,r,1),baseClone(e,t,n)}function cloneDeep(e,t,n){return t="function"==typeof t&&bindCallback(t,n,1),baseClone(e,!0,t)}function isArguments(e){var t=isObjectLike(e)?e.length:r;return isLength(t)&&Me.call(e)==T}function isBoolean(e){return e===!0||e===!1||isObjectLike(e)&&Me.call(e)==C}function isDate(e){return isObjectLike(e)&&Me.call(e)==k}function isElement(e){return!!e&&1===e.nodeType&&isObjectLike(e)&&Me.call(e).indexOf("Element")>-1}function isEmpty(e){if(null==e)return!0;var t=e.length;return isLength(t)&&(ln(e)||isString(e)||isArguments(e)||isObjectLike(e)&&cn(e.splice))?!t:!bn(e).length}function isEqual(e,t,n,a){if(n="function"==typeof n&&bindCallback(n,a,3),!n&&isStrictComparable(e)&&isStrictComparable(t))return e===t;var o=n?n(e,t):r;return"undefined"==typeof o?baseIsEqual(e,t,n):!!o}function isError(e){return isObjectLike(e)&&"string"==typeof e.message&&Me.call(e)==N}function isObject(e){var t=typeof e;return"function"==t||!!e&&"object"==t}function isMatch(e,n,r,a){var o=bn(n),i=o.length;if(!i)return!0;if(null==e)return!1;if(r="function"==typeof r&&bindCallback(r,a,3),!r&&1==i){var s=o[0],l=n[s];if(isStrictComparable(l))return l===e[s]&&("undefined"!=typeof l||s in toObject(e))}for(var u=t(i),c=t(i);i--;)l=u[i]=n[o[i]],c[i]=isStrictComparable(l);return baseIsMatch(toObject(e),o,u,c,r)}function isNaN(e){return isNumber(e)&&e!=+e}function isNative(e){return null==e?!1:Me.call(e)==I?Pe.test(Ie.call(e)):isObjectLike(e)&&ie.test(e)}function isNull(e){return null===e}function isNumber(e){return"number"==typeof e||isObjectLike(e)&&Me.call(e)==A}function isRegExp(e){return isObjectLike(e)&&Me.call(e)==O||!1}function isString(e){return"string"==typeof e||isObjectLike(e)&&Me.call(e)==M}function isTypedArray(e){return isObjectLike(e)&&isLength(e.length)&&!!_e[Me.call(e)]}function isUndefined(e){return"undefined"==typeof e}function toArray(e){var t=e?e.length:0;return isLength(t)?t?arrayCopy(e):[]:values(e)}function toPlainObject(e){return baseCopy(e,keysIn(e))}function create(e,t,n){var r=mt(e);return n&&isIterateeCall(e,t,n)&&(t=null),t?baseCopy(t,r,bn(t)):r}function functions(e){return baseFunctions(e,keysIn(e))}function has(e,t){return e?Oe.call(e,t):!1}function invert(e,t,n){n&&isIterateeCall(e,t,n)&&(t=null);for(var r=-1,a=bn(e),o=a.length,i={};++r<o;){var s=a[r],l=e[s];t?Oe.call(i,l)?i[l].push(s):i[l]=[s]:i[l]=s}return i}function keysIn(e){if(null==e)return[];isObject(e)||(e=be(e));var n=e.length;n=n&&isLength(n)&&(ln(e)||_t.nonEnumArgs&&isArguments(e))&&n||0;for(var r=e.constructor,a=-1,o="function"==typeof r&&r.prototype===e,i=t(n),s=n>0;++a<n;)i[a]=a+"";for(var l in e)s&&isIndex(l,n)||"constructor"==l&&(o||!Oe.call(e,l))||i.push(l);return i}function mapValues(e,t,n){var r={};return t=getCallback(t,n,3),baseForOwn(e,function(e,n,a){r[n]=t(e,n,a)}),r}function pairs(e){for(var n=-1,r=bn(e),a=r.length,o=t(a);++n<a;){var i=r[n];o[n]=[i,e[i]]}return o}function result(e,t,n){var a=null==e?r:e[t];return"undefined"==typeof a&&(a=n),cn(a)?a.call(e):a}function transform(e,t,n,r){var a=ln(e)||isTypedArray(e);if(t=getCallback(t,r,4),null==n)if(a||isObject(e)){var o=e.constructor;n=a?ln(e)?new o:[]:mt(cn(o)&&o.prototype)}else n={};return(a?arrayEach:baseForOwn)(e,function(e,r,a){return t(n,e,r,a)}),n}function values(e){return baseValues(e,bn(e))}function valuesIn(e){return baseValues(e,keysIn(e))}function inRange(e,t,n){return t=+t||0,"undefined"==typeof n?(n=t,t=0):n=+n||0,e>=t&&n>e}function random(e,t,n){n&&isIterateeCall(e,t,n)&&(t=n=null);var r=null==e,a=null==t;if(null==n&&(a&&"boolean"==typeof e?(n=e,e=1):"boolean"==typeof t&&(n=t,a=!0)),r&&a&&(t=1,a=!1),e=+e||0,a?(t=e,e=0):t=+t||0,n||e%1||t%1){var o=it();return nt(e+o*(t-e+parseFloat("1e-"+((o+"").length-1))),t)}return baseRandom(e,t)}function capitalize(e){return e=baseToString(e),e&&e.charAt(0).toUpperCase()+e.slice(1)}function deburr(e){return e=baseToString(e),e&&e.replace(se,deburrLetter).replace(ne,"")}function endsWith(e,t,n){e=baseToString(e),t+="";var r=e.length;return n="undefined"==typeof n?r:nt(0>n?0:+n||0,r),n-=t.length,n>=0&&e.indexOf(t,n)==n}function escape(e){return e=baseToString(e),e&&J.test(e)?e.replace($,escapeHtmlChar):e}function escapeRegExp(e){return e=baseToString(e),e&&ce.test(e)?e.replace(ue,"\\$&"):e}function pad(e,t,n){e=baseToString(e),t=+t;var r=e.length;if(r>=t||!Qe(t))return e;var a=(t-r)/2,o=Ue(a),i=je(a);return n=createPadding("",i,n),n.slice(0,o)+e+n}function parseInt(e,t,n){return n&&isIterateeCall(e,t,n)&&(t=0),ot(e,t)}function repeat(e,t){var n="";if(e=baseToString(e),t=+t,1>t||!e||!Qe(t))return n;do t%2&&(n+=e),t=Ue(t/2),e+=e;while(t);return n}function startsWith(e,t,n){return e=baseToString(e),n=null==n?0:nt(0>n?0:+n||0,e.length),e.lastIndexOf(t,n)==n}function template(e,t,n){var a=lodash.templateSettings;n&&isIterateeCall(e,t,n)&&(t=n=null),e=baseToString(e),t=baseAssign(baseAssign({},n||t),a,assignOwnDefaults);

var o,i,s=baseAssign(baseAssign({},t.imports),a.imports,assignOwnDefaults),l=bn(s),u=baseValues(s,l),c=0,d=t.interpolate||le,h="__p += '",f=xe((t.escape||le).source+"|"+d.source+"|"+(d===te?re:le).source+"|"+(t.evaluate||le).source+"|$","g"),p="//# sourceURL="+("sourceURL"in t?t.sourceURL:"lodash.templateSources["+ ++ge+"]")+"\n";e.replace(f,function(t,n,r,a,s,l){return r||(r=a),h+=e.slice(c,l).replace(de,escapeStringChar),n&&(o=!0,h+="' +\n__e("+n+") +\n'"),s&&(i=!0,h+="';\n"+s+";\n__p += '"),r&&(h+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),c=l+t.length,t}),h+="';\n";var g=t.variable;g||(h="with (obj) {\n"+h+"\n}\n"),h=(i?h.replace(V,""):h).replace(Y,"$1").replace(Z,"$1;"),h="function("+(g||"obj")+") {\n"+(g?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(o?", __e = _.escape":"")+(i?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+h+"return __p\n}";var _=An(function(){return R(l,p+"return "+h).apply(r,u)});if(_.source=h,isError(_))throw _;return _}function trim(e,t,n){var r=e;return(e=baseToString(e))?(n?isIterateeCall(r,t,n):null==t)?e.slice(trimmedLeftIndex(e),trimmedRightIndex(e)+1):(t+="",e.slice(charsLeftIndex(e,t),charsRightIndex(e,t)+1)):e}function trimLeft(e,t,n){var r=e;return e=baseToString(e),e?e.slice((n?isIterateeCall(r,t,n):null==t)?trimmedLeftIndex(e):charsLeftIndex(e,t+"")):e}function trimRight(e,t,n){var r=e;return e=baseToString(e),e?(n?isIterateeCall(r,t,n):null==t)?e.slice(0,trimmedRightIndex(e)+1):e.slice(0,charsRightIndex(e,t+"")+1):e}function trunc(e,t,n){n&&isIterateeCall(e,t,n)&&(t=null);var r=p,a=g;if(null!=t)if(isObject(t)){var o="separator"in t?t.separator:o;r="length"in t?+t.length||0:r,a="omission"in t?baseToString(t.omission):a}else r=+t||0;if(e=baseToString(e),r>=e.length)return e;var i=r-a.length;if(1>i)return a;var s=e.slice(0,i);if(null==o)return s+a;if(isRegExp(o)){if(e.slice(i).search(o)){var l,u,c=e.slice(0,i);for(o.global||(o=xe(o.source,(ae.exec(o)||"")+"g")),o.lastIndex=0;l=o.exec(c);)u=l.index;s=s.slice(0,null==u?i:u)}}else if(e.indexOf(o,i)!=i){var d=s.lastIndexOf(o);d>-1&&(s=s.slice(0,d))}return s+a}function unescape(e){return e=baseToString(e),e&&X.test(e)?e.replace(G,unescapeHtmlChar):e}function words(e,t,n){return n&&isIterateeCall(e,t,n)&&(t=null),e=baseToString(e),e.match(t||he)||[]}function callback(e,t,n){return n&&isIterateeCall(e,t,n)&&(t=null),isObjectLike(e)?matches(e):baseCallback(e,t)}function constant(e){return function(){return e}}function identity(e){return e}function matches(e){return baseMatches(baseClone(e,!0))}function matchesProperty(e,t){return baseMatchesProperty(e+"",baseClone(t,!0))}function mixin(e,t,n){if(null==n){var r=isObject(t),a=r&&bn(t),o=a&&a.length&&baseFunctions(t,a);(o?o.length:r)||(o=!1,n=t,t=e,e=this)}o||(o=baseFunctions(t,bn(t)));var i=!0,s=-1,l=cn(e),u=o.length;n===!1?i=!1:isObject(n)&&"chain"in n&&(i=n.chain);for(;++s<u;){var c=o[s],d=t[c];e[c]=d,l&&(e.prototype[c]=function(t){return function(){var n=this.__chain__;if(i||n){var r=e(this.__wrapped__),a=r.__actions__=arrayCopy(this.__actions__);return a.push({func:t,args:arguments,thisArg:e}),r.__chain__=n,r}var o=[this.value()];return Be.apply(o,arguments),t.apply(e,o)}}(d))}return e}function noConflict(){return e._=Ee,this}function noop(){}function property(e){return baseProperty(e+"")}function propertyOf(e){return function(t){return null==e?r:e[t]}}function range(e,n,r){r&&isIterateeCall(e,n,r)&&(n=r=null),e=+e||0,r=null==r?1:+r||0,null==n?(n=e,e=0):n=+n||0;for(var a=-1,o=tt(je((n-e)/(r||1)),0),i=t(o);++a<o;)i[a]=e,e+=r;return i}function times(e,n,r){if(e=+e,1>e||!Qe(e))return[];var a=-1,o=t(nt(e,ut));for(n=bindCallback(n,r,1);++a<e;)ut>a?o[a]=n(a):n(a);return o}function uniqueId(e){var t=++Re;return baseToString(e)+t}function add(e,t){return e+t}function sum(e,t,n){n&&isIterateeCall(e,t,n)&&(t=null);var r=getCallback(),a=null==t;return r===baseCallback&&a||(a=!1,t=r(t,n,3)),a?arraySum(ln(e)?e:toIterable(e)):baseSum(e,t)}e=e?De.defaults(Ae.Object(),e,De.pick(Ae,pe)):Ae;var t=e.Array,n=e.Date,F=e.Error,R=e.Function,E=e.Math,ye=e.Number,be=e.Object,xe=e.RegExp,we=e.String,Te=e.TypeError,Se=t.prototype,Ce=be.prototype,ke=we.prototype,Ne=(Ne=e.window)&&Ne.document,Ie=R.prototype.toString,Fe=baseProperty("length"),Oe=Ce.hasOwnProperty,Re=0,Me=Ce.toString,Ee=e._,Pe=xe("^"+escapeRegExp(Me).replace(/toString|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Le=isNative(Le=e.ArrayBuffer)&&Le,ze=isNative(ze=Le&&new Le(0).slice)&&ze,je=E.ceil,We=e.clearTimeout,Ue=E.floor,qe=isNative(qe=be.getPrototypeOf)&&qe,Be=Se.push,Ke=Ce.propertyIsEnumerable,He=isNative(He=e.Set)&&He,Ve=e.setTimeout,Ye=Se.splice,Ze=isNative(Ze=e.Uint8Array)&&Ze,Ge=isNative(Ge=e.WeakMap)&&Ge,$e=function(){try{var t=isNative(t=e.Float64Array)&&t,n=new t(new Le(10),0,1)&&t}catch(r){}return n}(),Xe=isNative(Xe=t.isArray)&&Xe,Je=isNative(Je=be.create)&&Je,Qe=e.isFinite,et=isNative(et=be.keys)&&et,tt=E.max,nt=E.min,rt=isNative(rt=n.now)&&rt,at=isNative(at=ye.isFinite)&&at,ot=e.parseInt,it=E.random,st=ye.NEGATIVE_INFINITY,lt=ye.POSITIVE_INFINITY,ut=E.pow(2,32)-1,ct=ut-1,dt=ut>>>1,ht=$e?$e.BYTES_PER_ELEMENT:0,ft=E.pow(2,53)-1,pt=Ge&&new Ge,gt={},_t=lodash.support={};!function(e){_t.funcDecomp=/\bthis\b/.test(function(){return this}),_t.funcNames="string"==typeof R.name;try{_t.dom=11===Ne.createDocumentFragment().nodeType}catch(t){_t.dom=!1}try{_t.nonEnumArgs=!Ke.call(arguments,1)}catch(t){_t.nonEnumArgs=!0}}(0,0),lodash.templateSettings={escape:Q,evaluate:ee,interpolate:te,variable:"",imports:{_:lodash}};var mt=function(){function Object(){}return function(t){if(isObject(t)){Object.prototype=t;var n=new Object;Object.prototype=null}return n||e.Object()}}(),vt=createBaseEach(baseForOwn),yt=createBaseEach(baseForOwnRight,!0),bt=createBaseFor(),xt=createBaseFor(!0),wt=pt?function(e,t){return pt.set(e,t),e}:identity;ze||(bufferClone=Le&&Ze?function(e){var t=e.byteLength,n=$e?Ue(t/ht):0,r=n*ht,a=new Le(t);if(n){var o=new $e(a,0,n);o.set(new $e(e,0,n))}return t!=r&&(o=new Ze(a,r),o.set(new Ze(e,r))),a}:constant(null));var Tt=Je&&He?function(e){return new SetCache(e)}:constant(null),St=pt?function(e){return pt.get(e)}:noop,Ct=function(){return _t.funcNames?"constant"==constant.name?baseProperty("name"):function(e){for(var t=e.name,n=gt[t],r=n?n.length:0;r--;){var a=n[r],o=a.func;if(null==o||o==e)return a.name}return t}:constant("")}(),kt=function(){var e=0,t=0;return function(n,r){var a=Zt(),o=m-(a-t);if(t=a,o>0){if(++e>=_)return n}else e=0;return wt(n,r)}}(),Nt=restParam(function(e,t){return ln(e)||isArguments(e)?baseDifference(e,baseFlatten(t,!1,!0)):[]}),It=createFindIndex(),Ft=createFindIndex(!0),At=restParam(function(e,t){e||(e=[]),t=baseFlatten(t);var n=t.length,r=baseAt(e,t);for(t.sort(baseCompareAscending);n--;){var a=parseFloat(t[n]);if(a!=o&&isIndex(a)){var o=a;Ye.call(e,a,1)}}return r}),Dt=createSortedIndex(),Ot=createSortedIndex(!0),Rt=restParam(function(e){return baseUniq(baseFlatten(e,!1,!0))}),Mt=restParam(function(e,t){return ln(e)||isArguments(e)?baseDifference(e,t):[]}),Et=restParam(unzip),Pt=restParam(function(e,t){var n=e?e.length:0;return isLength(n)&&(e=toIterable(e)),baseAt(e,baseFlatten(t))}),Lt=createAggregator(function(e,t,n){Oe.call(e,n)?++e[n]:e[n]=1}),zt=createFind(vt),jt=createFind(yt,!0),Wt=createForEach(arrayEach,vt),Ut=createForEach(arrayEachRight,yt),qt=createAggregator(function(e,t,n){Oe.call(e,n)?e[n].push(t):e[n]=[t]}),Bt=createAggregator(function(e,t,n){e[n]=t}),Kt=restParam(function(e,n,a){var o=-1,i="function"==typeof n,s=e?e.length:0,l=isLength(s)?t(s):[];return vt(e,function(e){var t=i?n:null!=e&&e[n];l[++o]=t?t.apply(e,a):r}),l}),Ht=createAggregator(function(e,t,n){e[n?0:1].push(t)},function(){return[[],[]]}),Vt=createReduce(arrayReduce,vt),Yt=createReduce(arrayReduceRight,yt),Zt=rt||function(){return(new n).getTime()},Gt=restParam(function(e,t,n){var r=o;if(n.length){var a=replaceHolders(n,Gt.placeholder);r|=c}return createWrapper(e,r,t,n,a)}),$t=restParam(function(e,t){t=t.length?baseFlatten(t):functions(e);for(var n=-1,r=t.length;++n<r;){var a=t[n];e[a]=createWrapper(e[a],o,e)}return e}),Xt=restParam(function(e,t,n){var r=o|i;if(n.length){var a=replaceHolders(n,Xt.placeholder);r|=c}return createWrapper(t,r,e,n,a)}),Jt=createCurry(l),Qt=createCurry(u),en=restParam(function(e,t){return baseDelay(e,1,t)}),tn=restParam(function(e,t,n){return baseDelay(e,t,n)}),nn=createFlow(),rn=createFlow(!0),an=createPartial(c),on=createPartial(d),sn=restParam(function(e,t){return createWrapper(e,f,null,null,null,baseFlatten(t))}),ln=Xe||function(e){return isObjectLike(e)&&isLength(e.length)&&Me.call(e)==S};_t.dom||(isElement=function(e){return!!e&&1===e.nodeType&&isObjectLike(e)&&!dn(e)});var un=at||function(e){return"number"==typeof e&&Qe(e)},cn=baseIsFunction(/x/)||Ze&&!baseIsFunction(Ze)?function(e){return Me.call(e)==I}:baseIsFunction,dn=qe?function(e){if(!e||Me.call(e)!=D)return!1;var t=e.valueOf,n=isNative(t)&&(n=qe(t))&&qe(n);return n?e==n||qe(e)==n:shimIsPlainObject(e)}:shimIsPlainObject,hn=createAssigner(baseAssign),fn=restParam(function(e){var t=e[0];return null==t?t:(e.push(assignDefaults),hn.apply(r,e))}),pn=createFindKey(baseForOwn),gn=createFindKey(baseForOwnRight),_n=createForIn(bt),mn=createForIn(xt),vn=createForOwn(baseForOwn),yn=createForOwn(baseForOwnRight),bn=et?function(e){if(e)var t=e.constructor,n=e.length;return"function"==typeof t&&t.prototype===e||"function"!=typeof e&&n&&isLength(n)?shimKeys(e):isObject(e)?et(e):[]}:shimKeys,xn=createAssigner(baseMerge),wn=restParam(function(e,t){if(null==e)return{};if("function"!=typeof t[0]){var t=arrayMap(baseFlatten(t),we);return pickByArray(e,baseDifference(keysIn(e),t))}var n=bindCallback(t[0],t[1],3);return pickByCallback(e,function(e,t,r){return!n(e,t,r)})}),Tn=restParam(function(e,t){return null==e?{}:"function"==typeof t[0]?pickByCallback(e,bindCallback(t[0],t[1],3)):pickByArray(e,baseFlatten(t))}),Sn=createCompounder(function(e,t,n){return t=t.toLowerCase(),e+(n?t.charAt(0).toUpperCase()+t.slice(1):t)}),Cn=createCompounder(function(e,t,n){return e+(n?"-":"")+t.toLowerCase()}),kn=createPadDir(),Nn=createPadDir(!0);8!=ot(fe+"08")&&(parseInt=function(e,t,n){return(n?isIterateeCall(e,t,n):null==t)?t=0:t&&(t=+t),e=trim(e),ot(e,t||(oe.test(e)?16:10))});var In=createCompounder(function(e,t,n){return e+(n?"_":"")+t.toLowerCase()}),Fn=createCompounder(function(e,t,n){return e+(n?" ":"")+(t.charAt(0).toUpperCase()+t.slice(1))}),An=restParam(function(e,t){try{return e.apply(r,t)}catch(n){return isError(n)?n:new F(n)}}),Dn=createExtremum(arrayMax),On=createExtremum(arrayMin,!0);return lodash.prototype=baseLodash.prototype,LodashWrapper.prototype=mt(baseLodash.prototype),LodashWrapper.prototype.constructor=LodashWrapper,LazyWrapper.prototype=mt(baseLodash.prototype),LazyWrapper.prototype.constructor=LazyWrapper,MapCache.prototype["delete"]=mapDelete,MapCache.prototype.get=mapGet,MapCache.prototype.has=mapHas,MapCache.prototype.set=mapSet,SetCache.prototype.push=cachePush,memoize.Cache=MapCache,lodash.after=after,lodash.ary=ary,lodash.assign=hn,lodash.at=Pt,lodash.before=before,lodash.bind=Gt,lodash.bindAll=$t,lodash.bindKey=Xt,lodash.callback=callback,lodash.chain=chain,lodash.chunk=chunk,lodash.compact=compact,lodash.constant=constant,lodash.countBy=Lt,lodash.create=create,lodash.curry=Jt,lodash.curryRight=Qt,lodash.debounce=debounce,lodash.defaults=fn,lodash.defer=en,lodash.delay=tn,lodash.difference=Nt,lodash.drop=drop,lodash.dropRight=dropRight,lodash.dropRightWhile=dropRightWhile,lodash.dropWhile=dropWhile,lodash.fill=fill,lodash.filter=filter,lodash.flatten=flatten,lodash.flattenDeep=flattenDeep,lodash.flow=nn,lodash.flowRight=rn,lodash.forEach=Wt,lodash.forEachRight=Ut,lodash.forIn=_n,lodash.forInRight=mn,lodash.forOwn=vn,lodash.forOwnRight=yn,lodash.functions=functions,lodash.groupBy=qt,lodash.indexBy=Bt,lodash.initial=initial,lodash.intersection=intersection,lodash.invert=invert,lodash.invoke=Kt,lodash.keys=bn,lodash.keysIn=keysIn,lodash.map=map,lodash.mapValues=mapValues,lodash.matches=matches,lodash.matchesProperty=matchesProperty,lodash.memoize=memoize,lodash.merge=xn,lodash.mixin=mixin,lodash.negate=negate,lodash.omit=wn,lodash.once=once,lodash.pairs=pairs,lodash.partial=an,lodash.partialRight=on,lodash.partition=Ht,lodash.pick=Tn,lodash.pluck=pluck,lodash.property=property,lodash.propertyOf=propertyOf,lodash.pull=pull,lodash.pullAt=At,lodash.range=range,lodash.rearg=sn,lodash.reject=reject,lodash.remove=remove,lodash.rest=rest,lodash.restParam=restParam,lodash.shuffle=shuffle,lodash.slice=slice,lodash.sortBy=sortBy,lodash.sortByAll=sortByAll,lodash.sortByOrder=sortByOrder,lodash.spread=spread,lodash.take=take,lodash.takeRight=takeRight,lodash.takeRightWhile=takeRightWhile,lodash.takeWhile=takeWhile,lodash.tap=tap,lodash.throttle=throttle,lodash.thru=thru,lodash.times=times,lodash.toArray=toArray,lodash.toPlainObject=toPlainObject,lodash.transform=transform,lodash.union=Rt,lodash.uniq=uniq,lodash.unzip=unzip,lodash.values=values,lodash.valuesIn=valuesIn,lodash.where=where,lodash.without=Mt,lodash.wrap=wrap,lodash.xor=xor,lodash.zip=Et,lodash.zipObject=zipObject,lodash.backflow=rn,lodash.collect=map,lodash.compose=rn,lodash.each=Wt,lodash.eachRight=Ut,lodash.extend=hn,lodash.iteratee=callback,lodash.methods=functions,lodash.object=zipObject,lodash.select=filter,lodash.tail=rest,lodash.unique=uniq,mixin(lodash,lodash),lodash.add=add,lodash.attempt=An,lodash.camelCase=Sn,lodash.capitalize=capitalize,lodash.clone=clone,lodash.cloneDeep=cloneDeep,lodash.deburr=deburr,lodash.endsWith=endsWith,lodash.escape=escape,lodash.escapeRegExp=escapeRegExp,lodash.every=every,lodash.find=zt,lodash.findIndex=It,lodash.findKey=pn,lodash.findLast=jt,lodash.findLastIndex=Ft,lodash.findLastKey=gn,lodash.findWhere=findWhere,lodash.first=first,lodash.has=has,lodash.identity=identity,lodash.includes=includes,lodash.indexOf=indexOf,lodash.inRange=inRange,lodash.isArguments=isArguments,lodash.isArray=ln,lodash.isBoolean=isBoolean,lodash.isDate=isDate,lodash.isElement=isElement,lodash.isEmpty=isEmpty,lodash.isEqual=isEqual,lodash.isError=isError,lodash.isFinite=un,lodash.isFunction=cn,lodash.isMatch=isMatch,lodash.isNaN=isNaN,lodash.isNative=isNative,lodash.isNull=isNull,lodash.isNumber=isNumber,lodash.isObject=isObject,lodash.isPlainObject=dn,lodash.isRegExp=isRegExp,lodash.isString=isString,lodash.isTypedArray=isTypedArray,lodash.isUndefined=isUndefined,lodash.kebabCase=Cn,lodash.last=last,lodash.lastIndexOf=lastIndexOf,lodash.max=Dn,lodash.min=On,lodash.noConflict=noConflict,lodash.noop=noop,lodash.now=Zt,lodash.pad=pad,lodash.padLeft=kn,lodash.padRight=Nn,lodash.parseInt=parseInt,lodash.random=random,lodash.reduce=Vt,lodash.reduceRight=Yt,lodash.repeat=repeat,lodash.result=result,lodash.runInContext=runInContext,lodash.size=size,lodash.snakeCase=In,lodash.some=some,lodash.sortedIndex=Dt,lodash.sortedLastIndex=Ot,lodash.startCase=Fn,lodash.startsWith=startsWith,lodash.sum=sum,lodash.template=template,lodash.trim=trim,lodash.trimLeft=trimLeft,lodash.trimRight=trimRight,lodash.trunc=trunc,lodash.unescape=unescape,lodash.uniqueId=uniqueId,lodash.words=words,lodash.all=every,lodash.any=some,lodash.contains=includes,lodash.detect=zt,lodash.foldl=Vt,lodash.foldr=Yt,lodash.head=first,lodash.include=includes,lodash.inject=Vt,mixin(lodash,function(){var e={};return baseForOwn(lodash,function(t,n){lodash.prototype[n]||(e[n]=t)}),e}(),!1),lodash.sample=sample,lodash.prototype.sample=function(e){return this.__chain__||null!=e?this.thru(function(t){return sample(t,e)}):sample(this.value())},lodash.VERSION=a,arrayEach(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){lodash[e].placeholder=lodash}),arrayEach(["dropWhile","filter","map","takeWhile"],function(e,t){var n=t!=b,r=t==v;LazyWrapper.prototype[e]=function(e,a){var o=this.__filtered__,i=o&&r?new LazyWrapper(this):this.clone(),s=i.__iteratees__||(i.__iteratees__=[]);return s.push({done:!1,count:0,index:0,iteratee:getCallback(e,a,1),limit:-1,type:t}),i.__filtered__=o||n,i}}),arrayEach(["drop","take"],function(e,t){var n=e+"While";LazyWrapper.prototype[e]=function(n){var r=this.__filtered__,a=r&&!t?this.dropWhile():this.clone();if(n=null==n?1:tt(Ue(n)||0,0),r)t?a.__takeCount__=nt(a.__takeCount__,n):last(a.__iteratees__).limit=n;else{var o=a.__views__||(a.__views__=[]);o.push({size:n,type:e+(a.__dir__<0?"Right":"")})}return a},LazyWrapper.prototype[e+"Right"]=function(t){return this.reverse()[e](t).reverse()},LazyWrapper.prototype[e+"RightWhile"]=function(e,t){return this.reverse()[n](e,t).reverse()}}),arrayEach(["first","last"],function(e,t){var n="take"+(t?"Right":"");LazyWrapper.prototype[e]=function(){return this[n](1).value()[0]}}),arrayEach(["initial","rest"],function(e,t){var n="drop"+(t?"":"Right");LazyWrapper.prototype[e]=function(){return this[n](1)}}),arrayEach(["pluck","where"],function(e,t){var n=t?"filter":"map",r=t?baseMatches:baseProperty;LazyWrapper.prototype[e]=function(e){return this[n](r(e))}}),LazyWrapper.prototype.compact=function(){return this.filter(identity)},LazyWrapper.prototype.reject=function(e,t){return e=getCallback(e,t,1),this.filter(function(t){return!e(t)})},LazyWrapper.prototype.slice=function(e,t){e=null==e?0:+e||0;var n=0>e?this.takeRight(-e):this.drop(e);return"undefined"!=typeof t&&(t=+t||0,n=0>t?n.dropRight(-t):n.take(t-e)),n},LazyWrapper.prototype.toArray=function(){return this.drop(0)},baseForOwn(LazyWrapper.prototype,function(e,t){var n=lodash[t];if(n){var r=/^(?:filter|map|reject)|While$/.test(t),a=/^(?:first|last)$/.test(t);lodash.prototype[t]=function(){var t=arguments,o=(t.length,this.__chain__),i=this.__wrapped__,s=!!this.__actions__.length,l=i instanceof LazyWrapper,u=t[0],c=l||ln(i);c&&r&&"function"==typeof u&&1!=u.length&&(l=c=!1);var d=l&&!s;if(a&&!o)return d?e.call(i):n.call(lodash,this.value());var h=function(e){var r=[e];return Be.apply(r,t),n.apply(lodash,r)};if(c){var f=d?i:new LazyWrapper(this),p=e.apply(f,t);if(!a&&(s||p.__actions__)){var g=p.__actions__||(p.__actions__=[]);g.push({func:thru,args:[h],thisArg:lodash})}return new LodashWrapper(p,o)}return this.thru(h)}}}),arrayEach(["concat","join","pop","push","replace","shift","sort","splice","split","unshift"],function(e){var t=(/^(?:replace|split)$/.test(e)?ke:Se)[e],n=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",r=/^(?:join|pop|replace|shift)$/.test(e);lodash.prototype[e]=function(){var e=arguments;return r&&!this.__chain__?t.apply(this.value(),e):this[n](function(n){return t.apply(n,e)})}}),baseForOwn(LazyWrapper.prototype,function(e,t){var n=lodash[t];if(n){var r=n.name,a=gt[r]||(gt[r]=[]);a.push({name:t,func:n})}}),gt[createHybridWrapper(null,i).name]=[{name:"wrapper",func:null}],LazyWrapper.prototype.clone=lazyClone,LazyWrapper.prototype.reverse=lazyReverse,LazyWrapper.prototype.value=lazyValue,lodash.prototype.chain=wrapperChain,lodash.prototype.commit=wrapperCommit,lodash.prototype.plant=wrapperPlant,lodash.prototype.reverse=wrapperReverse,lodash.prototype.toString=wrapperToString,lodash.prototype.run=lodash.prototype.toJSON=lodash.prototype.valueOf=lodash.prototype.value=wrapperValue,lodash.prototype.collect=lodash.prototype.map,lodash.prototype.head=lodash.prototype.first,lodash.prototype.select=lodash.prototype.filter,lodash.prototype.tail=lodash.prototype.rest,lodash}var r,a="3.6.0",o=1,i=2,s=4,l=8,u=16,c=32,d=64,h=128,f=256,p=30,g="...",_=150,m=16,v=0,y=1,b=2,x="Expected a function",w="__lodash_placeholder__",T="[object Arguments]",S="[object Array]",C="[object Boolean]",k="[object Date]",N="[object Error]",I="[object Function]",F="[object Map]",A="[object Number]",D="[object Object]",O="[object RegExp]",R="[object Set]",M="[object String]",E="[object WeakMap]",P="[object ArrayBuffer]",L="[object Float32Array]",z="[object Float64Array]",j="[object Int8Array]",W="[object Int16Array]",U="[object Int32Array]",q="[object Uint8Array]",B="[object Uint8ClampedArray]",K="[object Uint16Array]",H="[object Uint32Array]",V=/\b__p \+= '';/g,Y=/\b(__p \+=) '' \+/g,Z=/(__e\(.*?\)|\b__t\)) \+\n'';/g,G=/&(?:amp|lt|gt|quot|#39|#96);/g,$=/[&<>"'`]/g,X=RegExp(G.source),J=RegExp($.source),Q=/<%-([\s\S]+?)%>/g,ee=/<%([\s\S]+?)%>/g,te=/<%=([\s\S]+?)%>/g,ne=/[\u0300-\u036f\ufe20-\ufe23]/g,re=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,ae=/\w*$/,oe=/^0[xX]/,ie=/^\[object .+?Constructor\]$/,se=/[\xc0-\xd6\xd8-\xde\xdf-\xf6\xf8-\xff]/g,le=/($^)/,ue=/[.*+?^${}()|[\]\/\\]/g,ce=RegExp(ue.source),de=/['\n\r\u2028\u2029\\]/g,he=function(){var e="[A-Z\\xc0-\\xd6\\xd8-\\xde]",t="[a-z\\xdf-\\xf6\\xf8-\\xff]+";return RegExp(e+"+(?="+e+t+")|"+e+"?"+t+"|"+e+"+|[0-9]+","g")}(),fe=" 	\f \ufeff\n\r\u2028\u2029 ᠎             　",pe=["Array","ArrayBuffer","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Math","Number","Object","RegExp","Set","String","_","clearTimeout","document","isFinite","parseInt","setTimeout","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","window"],ge=-1,_e={};_e[L]=_e[z]=_e[j]=_e[W]=_e[U]=_e[q]=_e[B]=_e[K]=_e[H]=!0,_e[T]=_e[S]=_e[P]=_e[C]=_e[k]=_e[N]=_e[I]=_e[F]=_e[A]=_e[D]=_e[O]=_e[R]=_e[M]=_e[E]=!1;var me={};me[T]=me[S]=me[P]=me[C]=me[k]=me[L]=me[z]=me[j]=me[W]=me[U]=me[A]=me[D]=me[O]=me[M]=me[q]=me[B]=me[K]=me[H]=!0,me[N]=me[I]=me[F]=me[R]=me[E]=!1;var ve={leading:!1,maxWait:0,trailing:!1},ye={"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss"},be={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","`":"&#96;"},xe={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'","&#96;":"`"},we={"function":!0,object:!0},Te={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Se=we[typeof n]&&n&&!n.nodeType&&n,Ce=we[typeof t]&&t&&!t.nodeType&&t,ke=Se&&Ce&&"object"==typeof e&&e,Ne=we[typeof self]&&self&&self.Object&&self,Ie=we[typeof window]&&window&&window.Object&&window,Fe=Ce&&Ce.exports===Se&&Se,Ae=ke||Ie!==(this&&this.window)&&Ie||Ne||this,De=runInContext();"function"==typeof define&&"object"==typeof define.amd&&define.amd?(Ae._=De,define(function(){return De})):Se&&Ce?Fe?(Ce.exports=De)._=De:Se._=De:Ae._=De}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],21:[function(e,t,n){function createStrokeRouter(e,t){function getKeyId(e,t){var n=e;return t&&(n=t.reduce(addModifierMask,e)),n}function listModifiersInEvent(e){var t=[];return e.metaKey&&t.push("meta"),e.ctrlKey&&t.push("ctrl"),e.shiftKey&&t.push("shift"),e.altKey&&t.push("alt"),t}function addModifierMask(e,t){var n=e;switch(t){case"meta":n+=1e3;break;case"ctrl":n+=1e4;break;case"shift":n+=1e5;break;case"alt":n+=1e6}return n}function init(){this.sourceSelection.on("keyup",this.onKeyUp.bind(this)),this.sourceSelection.on("keydown",this.onKeyDown.bind(this))}t||r||(t=d3.event);var n={sourceSelection:e,keyUpRespondersForKeyIds:{},keyDownRespondersForKeyIds:{},enable:!0,stopPropIfResponderFound:!0,absorbAllKeyUpEvents:!1,absorbAllKeyDownEvents:!1};return n.keyCodesForNames={backspace:8,tab:9,enter:13,escape:27,space:32,pageUp:33,pageDown:34,end:35,home:36,leftArrow:37,upArrow:38,rightArrow:39,downArrow:40,insert:45,"delete":46,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,semicolon:186,equal:187,comma:188,dash:189,period:190,forwardSlash:191,graveAccent:192,openBracket:219,backslash:220,closeBracket:221,singleQuote:222},n.routeKeyUp=function routeKeyUp(e,t,n){var r=getKeyId(this.keyCodesForNames[e],t);this.keyUpRespondersForKeyIds[r]=n},n.routeKeyDown=function routeKeyDown(e,t,n){var r=getKeyId(this.keyCodesForNames[e],t);this.keyDownRespondersForKeyIds[r]=n},n.unrouteKeyUp=function unrouteKeyUp(e,t){var n=getKeyId(this.keyCodesForNames[e],t);delete this.keyUpRespondersForKeyIds[n]},n.unrouteKeyDown=function unrouteKeyDown(e,t){var n=getKeyId(this.keyCodesForNames[e],t);delete this.keyDownRespondersForKeyIds[n]},n.onKeyUp=function onKeyUp(){if(this.enable){this.absorbAllKeyUpEvents&&d3.event.stopPropagation();var e=getKeyId(d3.event.which,listModifiersInEvent(d3.event));e in this.keyUpRespondersForKeyIds&&(this.stopPropIfResponderFound&&d3.event.stopPropagation(),this.keyUpRespondersForKeyIds[e]())}},n.onKeyDown=function onKeyDown(){if(this.enable){this.absorbAllKeyDownEvents&&d3.event.stopPropagation();var e=getKeyId(d3.event.which,listModifiersInEvent(d3.event));e in this.keyDownRespondersForKeyIds&&(this.stopPropIfResponderFound&&d3.event.stopPropagation(),this.keyDownRespondersForKeyIds[e]())}},init.bind(n)(),n}var r="object"==typeof t&&"object"==typeof t.exports;r&&(t.exports=createStrokeRouter)},{}],22:[function(e,t,n){function OKCancelDialog(e,t,n,r,a){this.parentSelector=e,this.text=t,this.okText=n,this.respondToOK=r,this.cleanUpFunction=a}OKCancelDialog.prototype.show=function show(){var e=d3.select(this.parentSelector).append("div").attr("id","OKCancelDialog").classed("notification",!0);e.append("p").attr("id","dialogText").text(this.text),e.append("button").attr("id","OKButton").text(this.okText?this.okText:"OK").on("click",this.respondToOKClick.bind(this)),e.append("button").attr("id","CancelButton").text("Cancel").on("click",this.respondToCancelClick.bind(this))},OKCancelDialog.prototype.respondToOKClick=function respondToOKClick(){this.respondToOK(),this.cleanUpFunction&&this.cleanUpFunction(),d3.select(this.parentSelector).select("#OKCancelDialog").remove()},OKCancelDialog.prototype.respondToCancelClick=function respondToCancelClick(){this.cleanUpFunction&&this.cleanUpFunction(),d3.select(this.parentSelector).select("#OKCancelDialog").remove()},t.exports=OKCancelDialog},{}],23:[function(e,t,n){function createPaneShiftControl(e){function render(){var e=t.append("svg").classed({arrowboard:!0,"against-left":0>o,"against-right":o>0});n=e.append("polygon").attr({id:"expanderArrow",points:"0,0 16,12 0,24",transform:transformForDirection(o)}).classed({arrow:!0,"on-dark":a}),r&&e.on("click",r)}function transformForDirection(e){var t="translate(27, 12) scale(1, 1)";return 1>e&&(t="translate(18, 12) scale(-1, 1)"),t}var t,n,r,a,o=1;return e&&(t=e.parent,r=e.onClick,o=e.expandDirection,a=e.onDarkBackground),{render:render}}t.exports=createPaneShiftControl},{}],24:[function(e,t,n){function createPaneShifter(e){function toggle(){syncToState(getNextState(o))}function syncToState(e){setState(e),updateOtherShiftersToState(s[o]);var t="half-expanded"!==o;u.classed({"extra-wide":t,"shift-left":t&&0>i,"shift-right":t&&i>0})}function getNextState(e){var t=e,n=a();return"collapsed"===e?t=n?"fully-expanded":"half-expanded":"half-expanded"==o&&(t="fully-expanded"),t}function setState(e){function toggleStateClass(e){t.classed(e,e===o)}o=e,l.forEach(toggleStateClass)}function updateOtherShiftersToState(e){function updateOtherShifter(t){t&&t!==n&&t.setState(e)}r.selectAll(".pane").each(updateOtherShifter)}var t,n={toggle:toggle,setState:setState,syncToState:syncToState},o="half-expanded",i=1,s={"fully-expanded":"collapsed","half-expanded":"half-expanded",collapsed:"fully-expanded"},l=["fully-expanded","half-expanded","collapsed"];e&&(t=e.pane,o=e.state,i=e.expandDirection),t.datum(n);var u=r.select(t.node().parentNode);return syncToState(o),n}var r=e("./lib/d3-small"),a=e("./is-mobile");t.exports=createPaneShifter},{"./is-mobile":12,"./lib/d3-small":14}],25:[function(e,t,n){function renderAdminPanel(e){function addEmphasizeCheckbox(){var e=h.append("li");return e.append("label").text("Emphasize").classed("editcontrol",!0),f=e.append("input").attr({type:"checkbox",id:"emphasize"}).classed("editcontrol",!0),f.on("change",o),f}function respondToFocusChange(e){var t=e.detail.focusNode,n=r.select("#tags-field").node();f.node().checked=t.emphasize,n.value=t.tags?t.tags.join(" "):"",r.select("#formats-field").node().value=t.formats?t.formats.join(" "):""}var t,n,o,i,s,l,u,c,d;if(e&&(t=e.root,e.responders&&(o=e.responders.respondToEmphasisCheckChange,i=e.responders.respondToAddChildSprigCmd,s=e.responders.respondToNewSprigotCmd,l=e.responders.respondToDeleteSprigCmd,u=e.responders.respondToMoveChildLeftCmd,c=e.responders.respondToMoveChildRightCmd,d=e.responders.respondToTagsChange,respondToFormatsChange=e.responders.respondToFormatsChange)),!t)throw new Error("No root passed to renderAdminPanel.");var h=t.select("#admin-control-root");h.empty()&&(h=t.append("ul").attr("id","admin-control-root"));var n=a({root:h,baseElementType:"li",baseClass:"admin-control"});n.render([{id:"newsprigbutton",elementType:"button",text:"+",onClick:i},{id:"deletesprigbutton",elementType:"button",text:"-",onClick:l},{id:"move-left-button",elementType:"button",text:"Move left",onClick:u},{id:"move-right-button",elementType:"button",text:"Move right",onClick:c},{id:"newsprigotbutton",elementType:"button",text:"New Document",onClick:s},{id:"tags-label",elementType:"label",text:"Tags"},{id:"tags-field",elementType:"input",attributes:{value:"tags go here"},onKeyUp:eatEvent,onKeyDown:eatEvent,onFocusLoss:d},{id:"format-label",elementType:"label",text:"Formats"},{id:"formats-field",elementType:"input",attributes:{value:""},onKeyUp:eatEvent,onKeyDown:eatEvent,onFocusLoss:respondToFormatsChange}]);var f=addEmphasizeCheckbox();document.addEventListener("node-focus-change",respondToFocusChange)}function eatEvent(){r.event.stopPropagation()}var r=e("./lib/d3-small"),a=(e("./okcanceldialog"),e("./control-renderer"));t.exports=renderAdminPanel},{"./control-renderer":4,"./lib/d3-small":14,"./okcanceldialog":22}],26:[function(e,t,n){function createSpriglog(e){function init(n){var o=r(),i=o.setUpOuterContainer(e.doc.style?e.doc.style+".css":"bloge.css","bloge",e);return i?(t=d3.select(".bloge"),void a("//use.typekit.net/uoo5gyw.js",n)):void setTimeout(n,0)}function load(){var t=e.doc.id;o.init(null,t),i(t).getSprigTree(t,e.format,renderTree)}function renderTree(t,n){if(t)e.loadDone(t,null);else if(n){d3.select("title").text("Sprigot - "+n.title);var r=s.sanitizeTreeForD3(n);r.depth=0;var a=d3.select(".bloge").append("ul").classed("sprig",!0);renderTreeToRoot.bind(a.node())(r),o.syncURLToSprigId(e.doc.rootSprig),e.loadDone()}else e.loadDone(new Error("Sprig tree not found."))}function renderTreeToRoot(e){var t=d3.select(this);t.attr("id",e.id),t.classed("level-"+e.depth,!0);var n=e.tags&&-1!==e.tags.indexOf("click-to-display"),r=t.append("li").classed("title",!0).text(e.title);if(t.append("li").classed({sprigbody:!0,hidden:n}).html(e.body),n&&(t.classed("click-to-display",!0),r.on("click",displayBodyAndImmediateChildren)),e.children){setDepthOnChildren(e);var a=t.selectAll("ul.sprig").data(e.children,l()),o=a.enter().append("li").classed("hidden",n),i=o.append("ul").classed("sprig",!0);i.each(renderTreeToRoot)}}function displayBodyAndImmediateChildren(e){d3.event.stopPropagation();var t=d3.select(this.parentNode).select(".sprigbody");d3.selectAll("#"+e.id+" > :not(.title)").classed("displaying-hidden",!t.classed("displaying-hidden"))}function setDepthOnChildren(e){function setDepth(t){t.depth=e.depth+1}isNaN(e.depth)||e.children.forEach(setDepth)}e=e?e:{};var t=null;return{init:init,load:load}}var r=e("./sprigotbasemixin"),a=e("./load_a_typekit"),o=e("./historian"),i=e("./get-store"),s=e("./d3sprigbridge"),l=e("accessor");t.exports=createSpriglog},{"./d3sprigbridge":5,"./get-store":7,"./historian":9,"./load_a_typekit":15,"./sprigotbasemixin":28,accessor:17}],27:[function(e,t,n){
function createSprigot(e){function init(a){var c=r(),d=c.setUpOuterContainer("sprig.css","sprigot",e);if(!d)return void a();var p=[.5,1];g()&&(p=[.25,1]),n=h(p),t=l();var _=f.select(".sprigot");t.init(_,n,u,s,i,this),s.init(_,t,u,this),initDocEventResponders(),tagElementsWithCSSHackClasses(),o("//use.typekit.net/uoo5gyw.js",a)}function load(){function loadTree(n,r){if(n&&e.loadDone(n,null),r){r=d.sanitizeTreeForD3(r),f.select("title").text("Sprigot - "+r.title);var a=e.initialTargetSprigId,o=function matchAny(){return!0};a&&(o=function isTarget(e){return a===e.id}),t.loadNodeTreeToGraph(r,o,function onGraphLoaded(){"findunread"===a&&respondToFindUnreadCmd(),e.loadDone()}.bind(this))}else e.loadDone("Sprig tree not found.")}var n=getRootIdFromOpts(e);i.init(t.treeNav,n),p.getSprigTree(n,e.format,loadTree.bind(this))}function initDocEventResponders(){var e=f.select(document);s.editAvailable&&e.on("click",s.endEditing.bind(s)),_=a(e),_.stopPropIfResponderFound=!1,_.routeKeyUp("escape",null,function stopEditing(){s.contentZone.classed("editing")&&s.changeEditMode(!1)}),_.routeKeyUp("e",null,function startEditing(){"block"===s.contentZone.style("display")&&s.changeEditMode(!0)}),_.routeKeyUp("downArrow",null,t.treeNav.respondToDownArrow.bind(t.treeNav)),_.routeKeyUp("upArrow",null,t.treeNav.respondToUpArrow.bind(t.treeNav)),_.routeKeyUp("leftArrow",null,t.treeNav.respondToLeftArrow.bind(t.treeNav)),_.routeKeyUp("rightArrow",null,t.treeNav.respondToRightArrow.bind(t.treeNav)),_.routeKeyUp("equal",["shift"],respondToAddChildSprigCmd.bind(this)),_.routeKeyUp("u",null,respondToFindUnreadCmd.bind(this))}function respondToAddChildSprigCmd(){f.event.stopPropagation(),s.contentZone.classed("editing")&&s.changeEditMode(!1);var n=(getRootIdFromOpts(e),(new Date).toJSON()),r={id:s.makeId(8),title:"New Sprig",body:"",created:n,modified:n},a=t.focusNode.children;a||(a=t.focusNode._children),a||(a=[]),a.push(r),t.focusNode.children=a,s.changeEditMode(!0),p.saveChildAndParentSprig(r,d.serializeTreedNode(t.focusNode)),u.update(t.nodeRoot,t.treeRenderer.treeNodeAnimationDuration),setTimeout(function afterUpdate(){t.focusOnSprig(r.id),s.showTextpaneForTreeNode(r)}.bind(this),t.treeRenderer.treeNodeAnimationDuration+100)}function respondToDeleteSprigCmd(){f.event.stopPropagation(),s.contentZone.classed("editing")&&s.changeEditMode(!1,!0);var n=t.focusNode.parent,r=n.children.indexOf(t.focusNode);n.children.splice(r,1);var a=getRootIdFromOpts(e),o={id:t.focusNode.id,doc:a};p.deleteChildAndSaveParentSprig(o,d.serializeTreedNode(n));var i=t.treeNav;u.update(t.nodeRoot,t.treeRenderer.treeNodeAnimationDuration),setTimeout(function clickOnParentOfDeletedNode(){i.chooseTreeNode(n,f.select("#"+n.id).node())},t.treeRenderer.treeNodeAnimationDuration+500)}function respondToNewSprigotCmd(){var e={id:c.randomId(8),rootSprig:c.randomId(8),authors:["deathmtn"],admins:["deathmtn"]},t={id:e.rootSprig,doc:e.id,title:"Root",body:"Hello. Type some stuff here.",children:[]};p.createNewDoc(e,t)}function respondToFindUnreadCmd(){var e=d.mapPathInD3Tree(t.nodeIsUnvisited.bind(t),t.treeNav.sprigTree,100);if(e.length>0){(e.length>1||e[0].id!==t.focusNode.id)&&t.treeNav.followPathToSprig(e);var n=e[e.length-1];i.syncURLToSprigId(n.id),s.syncTextpaneWithTreeNode(n)}else s.disableFindUnreadLink()}function respondToMoveChildLeftCmd(){moveFocusNodeInDirection(-1)}function respondToMoveChildRightCmd(){moveFocusNodeInDirection(1)}function moveFocusNodeInDirection(e){t.swapNodeWithSibling(t.focusNode,e),u.update(t.nodeRoot,t.treeRenderer.treeNodeAnimationDuration)}function tagElementsWithCSSHackClasses(){g()&&!navigator.userAgent.match(/(iPad|iPhone);.*CPU.*OS 7_\d/i)&&(f.select(".sprigot").classed("is-not-ios-seven",!0),f.select("#graphPane").classed("is-not-ios-seven",!0),f.select("#nongraphPane").classed("is-not-ios-seven",!0))}var t=null,n=null,_=null;return{init:init,load:load,initDocEventResponders:initDocEventResponders,respondToAddChildSprigCmd:respondToAddChildSprigCmd,respondToDeleteSprigCmd:respondToDeleteSprigCmd,respondToNewSprigotCmd:respondToNewSprigotCmd,respondToFindUnreadCmd:respondToFindUnreadCmd,respondToMoveChildLeftCmd:respondToMoveChildLeftCmd,respondToMoveChildRightCmd:respondToMoveChildRightCmd,moveFocusNodeInDirection:moveFocusNodeInDirection,tagElementsWithCSSHackClasses:tagElementsWithCSSHackClasses,opts:e}}function getRootIdFromOpts(e){return e.doc.id?e.doc.id:e.rootId}var r=e("./sprigotbasemixin"),a=e("strokerouter"),o=e("./load_a_typekit"),i=e("./historian"),s=e("./textstuff"),l=e("./graph"),u=e("./treerenderer"),c=e("idmaker"),d=e("./d3sprigbridge"),h=e("./camera"),f=e("./lib/d3-small"),p=e("./legacy-store"),g=e("./is-mobile");t.exports=createSprigot},{"./camera":2,"./d3sprigbridge":5,"./graph":8,"./historian":9,"./is-mobile":12,"./legacy-store":13,"./lib/d3-small":14,"./load_a_typekit":15,"./sprigotbasemixin":28,"./textstuff":31,"./treerenderer":33,idmaker:19,strokerouter:21}],28:[function(e,t,n){function createSprigotBaseMixin(){var e={};return e.setUpOuterContainer=function setUpOuterContainer(e,t,n){var r=!1,a=d3.select(".outer-container");(n.forceRebuild||!a.empty())&&(n.forceRebuild||!a.classed(t))&&(a.remove(),a=d3.select(".outer-container"));var o=d3.select("head"),i=o.select("link[rel=stylesheet]");return i.empty()&&(i=o.append("link"),i.attr({rel:"stylesheet",type:"text/css",href:e})),i.attr("href")!==e&&i.attr("href",e),a.empty()&&(a=d3.select("body").append("section").classed("outer-container",!0).classed(t,!0),r=!0),r},e}t.exports=createSprigotBaseMixin},{}],29:[function(e,t,n){t.exports={defaultDoc:"About"}},{}],30:[function(e,t,n){},{}],31:[function(e,t,n){var r=e("idmaker"),a=e("./lib/d3-small"),o=e("strokerouter"),i=e("./render-admin-panel"),s=e("./get-store"),l=e("./pane-shift-control"),u=e("./pane-shifter"),c=e("./is-mobile"),d={graph:null,treeRenderer:null,store:null,sprigot:null,contentZoneStrokeRouter:null,pane:null,textpane:null,textcontent:null,titleField:null,contentZone:null,findUnreadLink:null,showGraphLink:null,downLink:null,editAvailable:!1};d.init=function init(e,t,n,r){this.graph=t,this.treeRenderer=n,this.sprigot=r,this.pane=e.append("div").classed("pane",!0).attr("id","nongraphPane"),this.pane.append("div").attr("id","questionDialog"),this.textpane=this.pane.append("div").attr("id","textpane").classed("textpane",!0),this.contentZone=this.textpane.append("div").classed("contentZone",!0).style("display","none"),this.titleField=this.contentZone.append("span").classed("sprigTitleField",!0).style("display","none"),this.textcontent=this.contentZone.append("div").classed("textcontent",!0).attr("tabindex",0),this.editAvailable&&i({root:this.textpane,responders:{respondToEmphasisCheckChange:this.respondToEmphasisCheckChange.bind(this),respondToTagsChange:this.respondToTagsChange.bind(this),respondToFormatsChange:this.respondToFormatsChange.bind(this),respondToAddChildSprigCmd:r.respondToAddChildSprigCmd.bind(r),respondToNewSprigotCmd:r.respondToNewSprigotCmd.bind(r),respondToDeleteSprigCmd:r.respondToDeleteSprigCmd.bind(r),respondToMoveChildLeftCmd:r.respondToMoveChildLeftCmd.bind(r),respondToMoveChildRightCmd:r.respondToMoveChildRightCmd.bind(r)}}),this.initFindUnreadLink(),a.selectAll("#textpane .contentZone,.editcontrol").style("display","none"),this.editAvailable&&(this.textcontent.on("click",this.startEditing.bind(this)),this.titleField.on("click",this.startEditing.bind(this)),this.contentZoneStrokeRouter=o(this.contentZone),this.contentZoneStrokeRouter.routeKeyDown("enter",["meta"],this.endEditing.bind(this)),this.contentZoneStrokeRouter.absorbAllKeyUpEvents=!0),this.paneShifter=u({state:c()?"collapsed":"half-expanded",pane:this.pane,expandDirection:-1}),this.paneShiftControl=l({parent:this.pane,onClick:this.paneShifter.toggle,expandDirection:-1}),this.paneShiftControl.render()},d.initFindUnreadLink=function initFindUnreadLink(){this.findUnreadLink=this.pane.append("a").attr("id","findunreadlink").classed("control-link",!0).classed("findunread-link",!0).text("Find Unread").style("display","none").on("click",this.sprigot.respondToFindUnreadCmd.bind(this.sprigot))},d.syncTextpaneWithTreeNode=function syncTextpaneWithTreeNode(e,t){if(this.textcontent.datum(e),this.titleField.datum(e),this.textcontent.html(e.body),this.titleField.html(e.title),this.editAvailable){var n={detail:{focusNode:e}};document.dispatchEvent(new CustomEvent("node-focus-change",n))}this.uncollapseTextpane(t)},d.showTextpaneForTreeNode=function showTextpaneForTreeNode(e){this.syncTextpaneWithTreeNode(e),a.selectAll("#textpane .contentZone,.editcontrol").style("display","block"),this.contentZone.style("display","block"),this.uncollapseTextpane()},d.fadeInTextPane=function fadeInTextPane(e){if("none"===this.contentZone.style("display")){var t=a.selectAll("#textpane .contentZone,.editcontrol");this.textpane.style("opacity",0),t.style("opacity",0),this.contentZone.style("opacity",0),t.style("display","block").transition().duration(e).style("opacity",1),this.contentZone.style("display","block").transition().duration(e).style("opacity",1),this.textpane.transition().duration(e).style("opacity",1)}},d.fadeInControlLinks=function fadeInControlLinks(e){var t=a.selectAll("#nongraphPane .control-link");t.style("opacity",0),t.style("display","block").transition().duration(e).style("opacity",1)},d.initialShow=function initialShow(e){var t=0;c()&&(t=1500),setTimeout(function doIt(){this.syncTextpaneWithTreeNode(e,t),this.fadeInTextPane(750),this.fadeInControlLinks(800)}.bind(this),725)},d.uncollapseTextpane=function uncollapseTextpane(e){function expandTextPane(){this.paneShifter.syncToState(n)}var t=this.pane.classed("collapsed"),n="half-expanded";t&&(c()?(e||(e=1500),n="fully-expanded",setTimeout(expandTextPane.bind(this),e)):(isNaN(e)&&(e=0),setTimeout(expandTextPane.bind(this),e)))},d.showTitle=function showTitle(){this.titleField.text(this.titleField.datum().title),this.titleField.style("display","block")},d.disableFindUnreadLink=function disableFindUnreadLink(){this.findUnreadLink.text("You've read all the sprigs!"),this.findUnreadLink.transition().duration(700).style("opacity",.3).style("cursor","default").attr("href",null),this.findUnreadLink.transition().delay(3e3).duration(2e3).style("opacity",0)},d.makeId=function makeId(e){return"s"+r.randomId(e)},d.changeEditMode=function changeEditMode(e,t){if(this.editAvailable)if(this.textcontent.attr("contenteditable",e),this.titleField.attr("contenteditable",e),this.contentZone.classed("editing",e),e)this.showTitle(),this.textcontent.node().focus();else{this.titleField.style("display","none");var n=this.textcontent.datum();n.body=this.textcontent.html();var r=this.titleField.text(),o=r!==n.title;n.title=r,o&&a.select("#"+n.id+" text").text(n.title);var i={detail:{focusNode:n}};if(document.dispatchEvent(new CustomEvent("node-focus-change",i)),this.textcontent.datum(n),this.titleField.datum(n),!t){var l=this.sprigot.opts.doc.id;s(l).saveSprigFromTreeNode(this.textcontent.datum(),l)}}},d.endEditing=function endEditing(){this.contentZone.classed("editing")&&this.changeEditMode(!1)},d.respondToEmphasisCheckChange=function respondToEmphasisCheckChange(){this.graph.focusNode&&(this.graph.focusNode.emphasize=a.event.srcElement.checked,this.treeRenderer.update(this.graph.nodeRoot),this.saveSprigFromFocusNode())},d.respondToTagsChange=function respondToTagsChange(){this.graph.focusNode&&(this.graph.focusNode.tags=a.event.srcElement.value.split(" "),this.saveSprigFromFocusNode())},d.respondToFormatsChange=function respondToFormatsChange(){this.graph.focusNode&&(this.graph.focusNode.formats=a.event.srcElement.value.split(" "),this.saveSprigFromFocusNode())},d.saveSprigFromFocusNode=function saveSprigFromFocusNode(){var e=this.sprigot.opts.doc.id;s(e).saveSprigFromTreeNode(this.graph.focusNode,e)},d.startEditing=function startEditing(){a.event.stopPropagation(),this.contentZone.classed("editing")||this.changeEditMode(!0)},t.exports=d},{"./get-store":7,"./is-mobile":12,"./lib/d3-small":14,"./pane-shift-control":23,"./pane-shifter":24,"./render-admin-panel":25,idmaker:19,strokerouter:21}],32:[function(e,t,n){function createTreeNav(){var e={sprigTree:null,graphCamera:null,treeRenderer:null,graph:null,textStuff:null};return e.init=function init(e,t,n,r,a){this.sprigTree=e,this.graphCamera=t,this.treeRenderer=n,this.graph=r,this.textStuff=a},e.chooseTreeNode=function chooseTreeNode(e,t,n){this.expandChildren(e),this.graph.focusOnTreeNode(e,t,n),this.textStuff.showTextpaneForTreeNode(e)},e.toggleChildren=function toggleChildren(e){e.children?(e._children=e.children,e.children=null):this.expandChildren(e)},e.expandChildren=function expandChildren(e){e._children&&(e.children=e._children,e._children=null)},e.collapseRecursively=function collapseRecursively(t){t.children&&(t._children=t.children,t._children.forEach(e.collapseRecursively),t.children=null)},e.nodeIsExpanded=function nodeIsExpanded(e){return e.children&&!e._children},e.followBranchOfNode=function followBranchOfNode(e){var t=null;if("object"==typeof e.children)for(var n=e.children.length-1;n>=0&&(t=e.children[n],"boolean"!=typeof t.emphasized||!t.emphasized);--n);if(t){var r=d3.select("#"+t.id).node();this.chooseTreeNode(t,r)}},e.followParentOfNode=function followParentOfNode(e,t){if("object"==typeof e.parent){var n=d3.select("#"+e.parent.id);this.chooseTreeNode(e.parent,n.node()),this.graphCamera.panToElement(n,t)}},e.moveToSiblingNode=function moveToSiblingNode(e,t,n){if("object"==typeof e.parent&&"object"==typeof e.parent.children){var r=e.parent.children.indexOf(e),a=r+t;if(a>-1&&a<e.parent.children.length){var o=e.parent.children[a],i=d3.select("#"+o.id).node();o._children&&this.expandChildren(o),this.graph.focusOnTreeNode(o,i,n),this.textStuff.showTextpaneForTreeNode(o)}}},e.goToSprigId=function goToSprigId(e,t){var n=r.mapPathToSprigId(e,this.sprigTree,100);if(n.length>0){var a=n[n.length-1];this.graph.focusNode&&a.id===this.graph.focusNode.id||this.followPathToSprig(n,t,function done(){this.textStuff.showTextpaneForTreeNode(a)}.bind(this))}},e.followPathToSprig=function followPathToSprig(e,t,n){if(!t)var t=this.treeRenderer.treeNodeAnimationDuration-200;e.forEach(function expandSprig(e){this.expandChildren(e)}.bind(this)),this.treeRenderer.update(this.sprigTree,0),this.graph.focusOnSprig(e[e.length-1].id,t,n)},e.respondToDownArrow=function respondToDownArrow(){d3.event.stopPropagation(),this.nodeIsExpanded(this.graph.focusNode)?this.followBranchOfNode(this.graph.focusNode):this.chooseTreeNode(this.graph.focusNode,d3.select("#"+this.graph.focusNode.id).node())},e.respondToUpArrow=function respondToUpArrow(){d3.event.stopPropagation(),this.followParentOfNode(this.graph.focusNode)},e.respondToLeftArrow=function respondToLeftArrow(){d3.event.stopPropagation(),this.moveToSiblingNode(this.graph.focusNode,-1)},e.respondToRightArrow=function respondToRightArrow(){d3.event.stopPropagation(),this.moveToSiblingNode(this.graph.focusNode,1)},e}var r=e("./d3sprigbridge");t.exports=createTreeNav},{"./d3sprigbridge":5}],33:[function(e,t,n){function translateTransform(e,t){return"translate("+e+", "+t+")"}function wrap(e,t,n){e.each(function(e){for(var a,o=r.select(this),i=t(e).split(/\s+/).reverse(),s=[],l=1.1,u=o.attr("y"),c=parseFloat(o.attr("dy")),d=o.text(null).append("tspan").attr("x",0).attr("y",u).attr("dy",c+"em"),h=[d];a=i.pop();)s.push(a),d.text(s.join(" ")),d.node().getComputedTextLength()>n&&(s.pop(),d.text(s.join(" ")),s=[a],d=o.append("tspan").attr("x",0).attr("y",u).text(a),h.push(d));for(var f=0;f<h.length;++f){var p=h[f];p.attr("dy",c-(h.length-f-1)*l+"em")}})}var r=e("./lib/d3-small"),a={treeLayout:null,diagonalProjection:null,sprigTree:null,graphSVGGroup:null,graph:null,treeNodeAnimationDuration:750,maxLabelWidth:140};a.init=function init(e,t){this.treeLayout=r.layout.tree(),this.treeLayout.nodeSize([160,160]),this.sprigTree=e,this.diagonalProjection=r.svg.diagonal().projection(function(e){return[e.y,e.x]}),this.graph=t,this.graphSVGGroup=t.svgRoot},a.update=function update(e,t){t||(t=this.treeNodeAnimationDuration);var n=this.treeLayout.nodes(this.sprigTree).reverse();n.forEach(function swapXAndY(e){var t=e.x,n=e.x0;e.x=e.y,e.x0=e.y0,e.y=t,e.y0=n});var r=this.treeLayout.links(n);n.forEach(function(e){e.x=180*e.depth});var o=this.graphSVGGroup.selectAll("g.node").data(n,function(e){return e.id||(e.id=++i)}),s=o.enter().append("g").attr("class","node").attr("transform",function(){return"translate("+e.y0+","+e.x0+")"}).attr("id",function(e){return e.id}).on("click",a.respondToNodeClick).on("dblclick",this.onNodeDoubleClick.bind(this));this.graph.documentIsEditable()&&this.addDragToNodeSelection(s),s.append("circle").attr("r",1e-6).style("fill",function(e){return e._children?"lightsteelblue":"#fff"}).style("fill-opacity",.7).style("stroke","rgba(0, 64, 192, 0.7)"),s.append("text").attr("x",function(e){return e.children||e._children?"0.3em":"-0.3em"}).attr("y","-1em").attr("dy",".35em").attr("text-anchor","middle").text(function(e){return e.title}).style("fill-opacity",1e-6);var l=o.transition().duration(t).attr("transform",function(e){return"translate("+e.y+","+e.x+")"});l.select("circle").attr("r",8).style("fill",function(e){var t="lightsteelblue";return this.graph.nodeHasFocus(e)?t="#e0362f":"boolean"==typeof e.emphasize&&e.emphasize&&(t="#08a"),t}.bind(this)).style("fill-opacity",function(e){var t=.7;return this.graph.nodeHasFocus(e)&&(t=1),t}.bind(this)).style("stroke-width",function(e){return e._children&&e._children.length>0?"32px":0}),l.select("text").style("fill-opacity",function(e){return this.graph.nodeHasFocus(e)?1:.85}.bind(this)).call(wrap,function getTitle(e){return e.title},this.maxLabelWidth);var u=o.exit().transition().duration(t).attr("transform",function(){return"translate("+e.y+","+e.x+")"}).remove();u.select("circle").attr("r",1e-6),u.select("text").style("fill-opacity",1e-6);var c=this.graphSVGGroup.selectAll("path.link").data(r,function(e){return e.target.id});c.enter().insert("path","g").attr("class","link").attr("d",function(){var t={x:e.x0,y:e.y0};return this.diagonalProjection({source:t,target:t})}.bind(this)),c.attr("d",this.diagonalProjection).attr("stroke-width",function getLinkWidth(e){return this.graph.nodeWasVisited(e.target)?3:1.5}.bind(this)),c.exit().transition().duration(t).attr("d",function getLinkData(){var t={x:e.x,y:e.y};return this.diagonalProjection({source:t,target:t})}.bind(this)).remove(),n.forEach(function(e){e.x0=e.x,e.y0=e.y})},a.respondToNodeClick=function respondToNodeClick(e){a.graph.treeNav.chooseTreeNode(e,this)},a.onNodeDoubleClick=function onNodeDoubleClick(e){this.graph.treeNav.toggleChildren(e),this.update(e)},a.addDragToNodeSelection=function addDragToNodeSelection(e){var t=r.behavior.drag();t.on("dragstart",function stopOtherDraggers(e){r.event.sourceEvent.stopPropagation(),e.x0=e.x,e.y0=e.y}),t.on("drag",function adjustPosition(e){r.event.sourceEvent.stopPropagation(),this.setAttribute("transform",translateTransform(r.event.x,r.event.y)),e.x=r.event.y,e.y=r.event.x}),t.on("dragend",function reportDrag(e){r.event.sourceEvent.stopPropagation(),a.graph.nodeWasDragged(e,this)}),e.call(t)},t.exports=a},{"./lib/d3-small":14}]},{},[10]);